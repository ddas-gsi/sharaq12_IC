#include <iostream>
#include <iomanip>
#include <typeinfo>
#include <fstream>
#include <stdio.h>

#define HEIGHT_V 58
#define HEIGHT_H 94
#define WIDTH 4

#include "TFile.h"
#include "TChain.h"
#include "TTree.h"
#include "TClonesArray.h"
#include "TGraph.h"
#include "TMultiGraph.h"
#include "TH2.h"
#include "TH1F.h"
#include "TH2F.h"

#include "TTimingChargeData.h"
#include "TTimingChargePositionData.h"
#include "TCatPulseShape.h"
#include "ICharge.h"
#include "TTwoSidedPlasticData.h"
#include "TPPACData.h"
#include "TTrack.h"
#include "TSRPPACPlaneData.h"
#include "TTimeDifference.h"
#include "TChargeData.h"
#include "TTinaData2.h"
#include "TAffineConverter.h"
#include "TFixedNumberParameter.h"
#include "TConverterBase.h"
#include "TPPACParameter.h"
#include "TMonotoneTableConverter.h"

using namespace art;
using namespace std;

// ==================================================================================
vector<double> scalingFactor2024 = {0.328100808214003, 0.354331023347641, 0.353376871615164, 0.341221667306953,
									0.299871820818998, 0.2978110984671, 0.356931018451723, 0.329294421869228,
									0.355599840573934, 0.351940599678406, 0.391313865417451, 0.408803019640458,
									0.359500216808261, 0.409018301309844, 0.352190096273146, 0.357800432006759,
									0.363726148939098, 0.352455737113362, 0.357382175563994, 0.354226230906535,
									0.349125630797702, 0.345915579668321, 0.354422202790317, 0.35380711856152,
									0.346675482839218, 0.352375450812634, 0.357493196633124, 0.353796092051126,
									0.352195387547155, 0.353249222664682};

vector<double> slowBeamScalingFactor2024v2 = {1.24356918787034, 1.19642915750435, 1.18418962285133, 1.17846597626726,
											  1.06987163297353, 1.04709269095848, 1.11999037978005, 1.18380290005004,
											  1.09117010023674, 1.04917247243532, 1.12979603829485, 0.96579216547196,
											  1.17231337956594, 0.980110832763987, 0.99499625733323, 0.920454212978164,
											  0.876854381481155, 0.911032622619079, 0.877540683403249, 0.947080149187554,
											  0.989079619782111, 1.08265621886245, 1, 1, 1, 1, 1, 1, 1, 1};
// ==================================================================================

// Define the constants

double c = 300000000;	// velocity in m/s
double amu_E = 931.494; // in MeV/u

// Distance
double distance_F3_FE9 = 68.54307; // distance in meter
// double distance_FE9_FE12 = 14.87168; // distance in meter
// double distance_FE9_FE12 = 14.68793; // distance in meter   // Updated distance (2023.05.01)
// double distance_FE12_S1 = 9.163;	 // distance in meter    // Updated distance (2023.05.01) >> FE12-S0 = 1.350m , S0-S1 = 7.813m
double distance_FE9_FE12 = 14.87168; // distance in meter   // Carlos used this distance
double distance_FE12_S1 = 9.4892;	 // distance in meter   // Carlos used this distance
// ==================================================================================

double calculateBeamEnergy(double TOF, double pathLength)
{
	/*
	Returns kinetic Energy in MeV/u for every event from the TOF information
	*/
	double kineticE;
	if (TOF > 0)
	{
		double velocity = (pathLength / TOF) * pow(10, 9);
		double beta = velocity / c;
		double gamma = 1 / sqrt(1 - pow(beta, 2));
		double totalE = gamma * amu_E;
		kineticE = totalE - amu_E;
	}
	else if (TOF <= 0)
	{
		kineticE = 0;
	}
	return kineticE;
}

double calculateBeta(double TOF, double pathLength)
{
	/*
	Returns beta for every event from the TOF information
	*/
	double beta;
	if (TOF > 0)
	{
		double velocity = (pathLength / TOF) * pow(10, 9);
		beta = velocity / c;
	}
	else if (TOF <= 0)
	{
		beta = 0;
	}
	return beta;
}

// This is an analyzer of the SHARAQ12 experiment.
void sharaq12(int a = 0, int b = 100000, int frun = 1, int lrun = 2)
// void sharaq12(int a = 440574, int b = 440577,int frun = 65, int lrun = 66)
{

	/***************************
		  Input Rootfiles
	  ***************************/

	// This is for reading other RUNs.
	// TFile *file = new TFile("/u/ddas/software/work/artemis-oedo/output/phys24/all24physics1053.root");
	TFile *file = new TFile("/u/ddas/software/work/artemis-oedo/output/phys24/all24physics1056.root");
	TTree *tree = (TTree *)file->Get("tree");

	// // List of rootfiles with physics runs.
	// string RUN_list[53] = {"1007", "1008", "1009", "1010", "1011", "1012", "1013", "1014", "1015", "1016", "1017", "1018", "1019", "1020", "1021", "1022", "1023", "1024",
	// 					   "1025", "1026", "1027", "1035", "1036", "1037", "1039", "1040", "1041", "1042", "1043", "1045", "1046", "1047", "1048", "1049", "1050", "1051",
	// 					   "1052", "1053", "1054", "1055", "1056", "1057", "1058", "1059", "1062", "1063", "1064", "1065", "1066", "1067", "1068", "1069", "1070"};

	// // We concatenate the trees from the physics runs.
	// TChain *tree = new TChain("tree");
	// for (int fn = frun; fn < lrun; fn++)
	// {
	// 	string rfile = "/home/carlos/data/SH12_2/physics/allphysics" + RUN_list[fn] + ".root";
	// 	tree->Add(rfile.c_str());
	// }

	// cout << endl;
	// cout << "Branches" << endl;
	// cout << endl;
	/***************************
			   Branches
	 ***************************/

	// Declaration of TClonesArray pointers for accessing each Root branch required in this analysis.
	TClonesArray *array_coin_f3 = new TClonesArray("TTimingChargeData");   // Trigger on F3 Diamond, it was connected from RUN 1081 onwards.
	TClonesArray *array_coin_f3ds = new TClonesArray("TTimingChargeData"); // Trigger on downscaled F3 Diamond.
	TClonesArray *array_coin_s0 = new TClonesArray("TTimingChargeData");   // Trigger on S0.
	TClonesArray *array_coin_s1 = new TClonesArray("TTimingChargeData");   // Trigger on S1.
	TClonesArray *array_coin_fe12 = new TClonesArray("TTimingChargeData"); // Trigger on FE12.

	TClonesArray *array_F3_t = new TClonesArray("TTimingChargePositionData");		// Time measured by the diamond at F3.
	TClonesArray *array_FE91_t = new TClonesArray("TTimingChargePositionData");		// Time measured by the first PPAC of FE9.
	TClonesArray *array_FE92_t = new TClonesArray("TTimingChargePositionData");		// Time measured by the second PPAC at FE9.
	TClonesArray *array_FE91_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the first PPAC at FE9
	TClonesArray *array_FE92_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the second PPAC at FE9.
	TClonesArray *array_FE91_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the first PPAC at FE9.
	TClonesArray *array_FE92_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the second PPAC at FE9.

	TClonesArray *array_FE121_t = new TClonesArray("TTimingChargePositionData");	 // Time measured by the first PPAC at FE12.
	TClonesArray *array_FE122_t = new TClonesArray("TTimingChargePositionData");	 // Time measured by the second PPAC at FE12.
	TClonesArray *array_FE121_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the first PPAC at FE12.
	TClonesArray *array_FE122_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the second PPAC at FE12.
	TClonesArray *array_FE121_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the first PPAC at FE12.
	TClonesArray *array_FE122_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the second PPAC at FE12.

	TClonesArray *array_S11_t = new TClonesArray("TTimingChargePositionData");	   // Time measured by the first PPAC at S1.
	TClonesArray *array_S12_t = new TClonesArray("TTimingChargePositionData");	   // Time measured by the second PPAC at S1.
	TClonesArray *array_S11_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the first PPAC at S1.
	TClonesArray *array_S12_x_cal = new TClonesArray("TTimingChargePositionData"); // Horizontal position measured by the second PPAC at S1.
	TClonesArray *array_S11_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the first PPAC at S1.
	TClonesArray *array_S12_y_cal = new TClonesArray("TTimingChargePositionData"); // Vertical position measured by the second PPAC at S1.

	// TClonesArray *array_IC_RAW = new TClonesArray("TCatPulseShape"); // Charge provided by the Ionization Chamber at S1.
	TClonesArray *array_IC_RAW_Charge = new TClonesArray("TCatPulseShape"); // RAW Charge provided by the Ionization Chamber at S1.
	TClonesArray *array_IC_RAW_Energy = new TClonesArray("TCatPulseShape"); // Energy provided by the Ionization Chamber at S1.

	// TClonesArray *array_TINA2_t_raw = new TClonesArray("TTimingChargePositionData"); // Raw time measured by TiNA2.
	// TClonesArray *array_TTT_back = new TClonesArray("TCatPulseShape");				 // Energy and ID measured by the TTT back strips.
	// TClonesArray *array_TTT_front = new TClonesArray("TCatPulseShape");				 // Energy and ID measured by the TTT front strips.
	// TClonesArray *array_CsI = new TClonesArray("TCatPulseShape");					 // Energy and ID measured by the CsI crystals.
	// TClonesArray *array_YY1 = new TClonesArray("TCatPulseShape");					 // Energy and ID measured by the YY1 strips.
	// // TClonesArray *array_YY1 = new TClonesArray("TTinaData2"); //Energy and ID measured by the YY1 strips.

	// Declaration of the pointers used for accesing the elements inside each of the TClonesArray above.
	TTimingChargeData *p_coin_f3 = new TTimingChargeData();
	TTimingChargeData *p_coin_f3ds = new TTimingChargeData();
	TTimingChargeData *p_coin_s0 = new TTimingChargeData();
	TTimingChargeData *p_coin_s1 = new TTimingChargeData();
	TTimingChargeData *p_coin_fe12 = new TTimingChargeData();

	TTimingChargePositionData *p_F3_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE91_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE92_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE91_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE92_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE91_y_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE92_y_cal = new TTimingChargePositionData();

	TTimingChargePositionData *p_FE121_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE122_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE121_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE122_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE121_y_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_FE122_y_cal = new TTimingChargePositionData();

	TTimingChargePositionData *p_S11_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_S12_t = new TTimingChargePositionData();
	TTimingChargePositionData *p_S11_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_S12_x_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_S11_y_cal = new TTimingChargePositionData();
	TTimingChargePositionData *p_S12_y_cal = new TTimingChargePositionData();

	TCatPulseShape *p_IC_RAW = new TCatPulseShape();
	TCatPulseShape *p_IC = new TCatPulseShape();

	// TTimingChargePositionData *p_TINA2_t_raw = new TTimingChargePositionData();
	// TCatPulseShape *p_TTT_front = new TCatPulseShape();
	// TCatPulseShape *p_TTT_back = new TCatPulseShape();
	// TCatPulseShape *p_CsI = new TCatPulseShape();
	// TCatPulseShape *p_YY1 = new TCatPulseShape();
	// // TTinaData2 *p_YY1 = new TTinaData2();

	// For optimizing the running time of this analyzer, we only read the branches required for the present analysis.
	tree->SetBranchStatus("*", 0);

	tree->SetBranchStatus("coin_f3", 1);
	tree->SetBranchStatus("coin_f3ds", 1);
	tree->SetBranchStatus("coin_s0", 1);
	tree->SetBranchStatus("coin_s1", 1);
	tree->SetBranchStatus("coin_fe12", 1);

	tree->SetBranchStatus("diapad", 1);
	tree->SetBranchStatus("sr91_a_cal", 1);
	tree->SetBranchStatus("sr92_a_cal", 1);
	tree->SetBranchStatus("sr91_x_cal", 1);
	tree->SetBranchStatus("sr92_x_cal", 1);
	tree->SetBranchStatus("sr91_y_cal", 1);
	tree->SetBranchStatus("sr92_y_cal", 1);

	tree->SetBranchStatus("src1_a_cal", 1);
	tree->SetBranchStatus("src2_a_cal", 1);
	tree->SetBranchStatus("src1_x_cal", 1);
	tree->SetBranchStatus("src2_x_cal", 1);
	tree->SetBranchStatus("src1_y_cal", 1);
	tree->SetBranchStatus("src2_y_cal", 1);

	// tree->SetBranchStatus("sr11_a_cal",1); //The time information from this anode is not available for the SHARAQ12 experiment.
	tree->SetBranchStatus("sr12_a_cal", 1);
	tree->SetBranchStatus("sr11_x_cal", 1);
	tree->SetBranchStatus("sr12_x_cal", 1);
	tree->SetBranchStatus("sr11_y_cal", 1);
	tree->SetBranchStatus("sr12_y_cal", 1);

	tree->SetBranchStatus("icraw", 1);
	tree->SetBranchStatus("ic", 1);

	// tree->SetBranchStatus("tinatraw", 1);
	// tree->SetBranchStatus("ttt_front_hit", 1);
	// tree->SetBranchStatus("ttt_back_hit", 1);
	// tree->SetBranchStatus("csi", 1);
	// tree->SetBranchStatus("yy1f", 1); // Not in use yet.
	// // tree->SetBranchStatus("tina2",1);

	// The TClonesArray pointers previously declared are pointed to the corresponding branches in the unpacked data.
	tree->SetBranchAddress("coin_f3", &array_coin_f3);
	tree->SetBranchAddress("coin_f3ds", &array_coin_f3ds);
	tree->SetBranchAddress("coin_s0", &array_coin_s0);
	tree->SetBranchAddress("coin_s1", &array_coin_s1);
	tree->SetBranchAddress("coin_fe12", &array_coin_fe12);

	tree->SetBranchAddress("diapad", &array_F3_t);
	tree->SetBranchAddress("sr91_a_cal", &array_FE91_t);
	tree->SetBranchAddress("sr92_a_cal", &array_FE92_t);
	tree->SetBranchAddress("sr91_x_cal", &array_FE91_x_cal);
	tree->SetBranchAddress("sr92_x_cal", &array_FE92_x_cal);
	tree->SetBranchAddress("sr91_y_cal", &array_FE91_y_cal);
	tree->SetBranchAddress("sr92_y_cal", &array_FE92_y_cal);

	tree->SetBranchAddress("src1_a_cal", &array_FE121_t);
	tree->SetBranchAddress("src2_a_cal", &array_FE122_t);
	tree->SetBranchAddress("src1_x_cal", &array_FE121_x_cal);
	tree->SetBranchAddress("src2_x_cal", &array_FE122_x_cal);
	tree->SetBranchAddress("src1_y_cal", &array_FE121_y_cal);
	tree->SetBranchAddress("src2_y_cal", &array_FE122_y_cal);

	tree->SetBranchAddress("sr11_a_cal", &array_S11_t);
	tree->SetBranchAddress("sr12_a_cal", &array_S12_t);
	tree->SetBranchAddress("sr11_x_cal", &array_S11_x_cal);
	tree->SetBranchAddress("sr12_x_cal", &array_S12_x_cal);
	tree->SetBranchAddress("sr11_y_cal", &array_S11_y_cal);
	tree->SetBranchAddress("sr12_y_cal", &array_S12_y_cal);

	// tree->SetBranchAddress("icraw", &array_IC_RAW);
	tree->SetBranchAddress("icraw", &array_IC_RAW_Charge);
	tree->SetBranchAddress("ic", &array_IC_RAW_Energy);

	// tree->SetBranchAddress("tinatraw", &array_TINA2_t_raw);
	// tree->SetBranchAddress("ttt_front_hit", &array_TTT_front);
	// tree->SetBranchAddress("ttt_back_hit", &array_TTT_back);
	// tree->SetBranchAddress("csi", &array_CsI);
	// tree->SetBranchAddress("yy1f", &array_YY1); // Not in use yet.
	// // tree->SetBranchAddress("tina2", &array_YY1);

	// All pointers are emptied before starting with the analysis.
	array_coin_f3->Clear();
	array_coin_f3ds->Clear();
	array_coin_s0->Clear();
	array_coin_s1->Clear();
	array_coin_fe12->Clear();

	array_F3_t->Clear();
	array_FE91_t->Clear();
	array_FE92_t->Clear();
	array_FE91_x_cal->Clear();
	array_FE92_x_cal->Clear();
	array_FE91_y_cal->Clear();
	array_FE92_y_cal->Clear();

	array_FE121_t->Clear();
	array_FE122_t->Clear();
	array_FE121_x_cal->Clear();
	array_FE122_x_cal->Clear();
	array_FE121_y_cal->Clear();
	array_FE122_y_cal->Clear();

	array_S11_t->Clear();
	array_S12_t->Clear();
	array_S11_x_cal->Clear();
	array_S12_x_cal->Clear();
	array_S11_y_cal->Clear();
	array_S12_y_cal->Clear();

	// array_IC_RAW->Clear();
	array_IC_RAW_Charge->Clear();
	array_IC_RAW_Energy->Clear();

	// array_TINA2_t_raw->Clear();
	// array_TTT_front->Clear();
	// array_TTT_back->Clear();
	// array_CsI->Clear();
	// array_YY1->Clear();

	p_coin_f3->Clear("");
	p_coin_f3ds->Clear("");
	p_coin_s0->Clear("");
	p_coin_s1->Clear("");
	p_coin_fe12->Clear("");

	p_F3_t->Clear("");
	p_FE91_t->Clear("");
	p_FE92_t->Clear("");
	p_FE91_x_cal->Clear("");
	p_FE92_x_cal->Clear("");
	p_FE91_y_cal->Clear("");
	p_FE92_y_cal->Clear("");

	p_FE121_t->Clear("");
	p_FE122_t->Clear("");
	p_FE121_x_cal->Clear("");
	p_FE122_x_cal->Clear("");
	p_FE121_y_cal->Clear("");
	p_FE122_y_cal->Clear("");

	p_S11_t->Clear("");
	p_S12_t->Clear("");
	p_S11_x_cal->Clear("");
	p_S12_x_cal->Clear("");
	p_S11_y_cal->Clear("");
	p_S12_y_cal->Clear("");

	p_IC_RAW->Clear("");
	p_IC->Clear("");

	// p_TINA2_t_raw->Clear("");
	// p_TTT_front->Clear("");
	// p_TTT_back->Clear("");
	// p_CsI->Clear("");
	// p_YY1->Clear("");

	TList *hlist = new TList();

	// TH1F* h_Event = new TH1F("h_Event", "Event", 500000,-0.5,499999.5);
	// hlist->Add(h_Event);

	TH1F *h_T_FE9A = new TH1F("T_FE9A", "T_FE9A", 100000, -5000, 5000);
	hlist->Add(h_T_FE9A);

	TH1F *h_T_FE9A_F3 = new TH1F("T_FE9A_F3", "T_FE9A_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE9A_F3);

	// TH2F* h_T_FE9A_F3_Event = new TH2F("T_FE9A_F3_Event", "T_FE91X_F3_Event",5000,0,3000000,5000,900,1200);
	// hlist->Add(h_T_FE91X_F3_Event);

	TH1F *h_T_FE91X_F3 = new TH1F("T_FE91X_F3", "T_FE91X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE91X_F3);

	TH1F *h_T_FE91Y_F3 = new TH1F("T_FE91Y_F3", "T_FE91Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE91Y_F3);

	TH1F *h_T_FE92X_F3 = new TH1F("T_FE92X_F3", "T_FE92X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE92X_F3);

	TH1F *h_T_FE92Y_F3 = new TH1F("T_FE92Y_F3", "T_FE92Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE92Y_F3);

	TH1F *h_T_FE12A = new TH1F("T_FE12A", "T_FE12A", 100000, -5000, 5000);
	hlist->Add(h_T_FE12A);

	TH1F *h_T_FE12A_F3 = new TH1F("T_FE12A_F3", "T_FE12A_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE12A_F3);

	TH1F *h_T_FE121X_F3 = new TH1F("T_FE121X_F3", "T_FE121X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE121X_F3);

	TH1F *h_T_FE121Y_F3 = new TH1F("T_FE121Y_F3", "T_FE121Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE121Y_F3);

	TH1F *h_T_FE122X_F3 = new TH1F("T_FE122X_F3", "T_FE122X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE122X_F3);

	TH1F *h_T_FE122Y_F3 = new TH1F("T_FE122Y_F3", "T_FE122Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_FE122Y_F3);

	TH1F *h_T_S1A = new TH1F("T_S1A", "T_S1A", 100000, -5000, 5000);
	hlist->Add(h_T_S1A);

	TH1F *h_T_S1A_F3 = new TH1F("T_S1A_F3", "T_S1A_F3", 100000, -5000, 5000);
	hlist->Add(h_T_S1A_F3);

	TH1F *h_T_S11X_F3 = new TH1F("T_S11X_F3", "T_S11X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_S11X_F3);

	TH1F *h_T_S11Y_F3 = new TH1F("T_S11Y_F3", "T_S11Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_S11Y_F3);

	TH1F *h_T_S12X_F3 = new TH1F("T_S12X_F3", "T_S12X_F3", 100000, -5000, 5000);
	hlist->Add(h_T_S12X_F3);

	TH1F *h_T_S12Y_F3 = new TH1F("T_S12Y_F3", "T_S12Y_F3", 100000, -5000, 5000);
	hlist->Add(h_T_S12Y_F3);

	TH2F *h_FE91_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE91_X_Q0_C2[i] = new TH2F(Form("FE91_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE91_X_Q0_C2[i]);
	}

	TH2F *h_FE91_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE91_Y_Q0_C2[i] = new TH2F(Form("FE91_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE91_Y_Q0_C2[i]);
	}

	TH2F *h_FE92_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE92_X_Q0_C2[i] = new TH2F(Form("FE92_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE92_X_Q0_C2[i]);
	}

	TH2F *h_FE92_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE92_Y_Q0_C2[i] = new TH2F(Form("FE92_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE92_Y_Q0_C2[i]);
	}

	TH2F *h_FE121_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE121_X_Q0_C2[i] = new TH2F(Form("FE121_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE121_X_Q0_C2[i]);
	}

	TH2F *h_FE121_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE121_Y_Q0_C2[i] = new TH2F(Form("FE121_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE121_Y_Q0_C2[i]);
	}

	TH2F *h_FE122_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE122_X_Q0_C2[i] = new TH2F(Form("FE122_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE122_X_Q0_C2[i]);
	}

	TH2F *h_FE122_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE122_Y_Q0_C2[i] = new TH2F(Form("FE122_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE122_Y_Q0_C2[i]);
	}

	TH2F *h_S11_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_S11_X_Q0_C2[i] = new TH2F(Form("S11_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_S11_X_Q0_C2[i]);
	}

	TH2F *h_S11_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_S11_Y_Q0_C2[i] = new TH2F(Form("S11_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_S11_Y_Q0_C2[i]);
	}

	TH2F *h_S12_X_Q0_C2[15];
	for (int i = 0; i < 15; i++)
	{
		h_S12_X_Q0_C2[i] = new TH2F(Form("S12_X_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_S12_X_Q0_C2[i]);
	}

	TH2F *h_S12_Y_Q0_C2[16];
	for (int i = 0; i < 16; i++)
	{
		h_S12_Y_Q0_C2[i] = new TH2F(Form("S12_Y_Q0_C2_%d", i + 1), Form("Q0 (C2) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_S12_Y_Q0_C2[i]);
	}

	TH2F *h_FE91_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE91_X_Q0_C[i] = new TH2F(Form("FE91_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE91_X_Q0_C[i]);
	}

	TH2F *h_FE91_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE91_Y_Q0_C[i] = new TH2F(Form("FE91_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE91_Y_Q0_C[i]);
	}

	TH2F *h_FE92_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE92_X_Q0_C[i] = new TH2F(Form("FE92_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE92_X_Q0_C[i]);
	}

	TH2F *h_FE92_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE92_Y_Q0_C[i] = new TH2F(Form("FE92_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE92_Y_Q0_C[i]);
	}

	TH2F *h_FE121_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE121_X_Q0_C[i] = new TH2F(Form("FE121_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE121_X_Q0_C[i]);
	}

	TH2F *h_FE121_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE121_Y_Q0_C[i] = new TH2F(Form("FE121_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE121_Y_Q0_C[i]);
	}

	TH2F *h_FE122_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_FE122_X_Q0_C[i] = new TH2F(Form("FE122_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_FE122_X_Q0_C[i]);
	}

	TH2F *h_FE122_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_FE122_Y_Q0_C[i] = new TH2F(Form("FE122_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_FE122_Y_Q0_C[i]);
	}

	TH2F *h_S11_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_S11_X_Q0_C[i] = new TH2F(Form("S11_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_S11_X_Q0_C[i]);
	}

	TH2F *h_S11_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_S11_Y_Q0_C[i] = new TH2F(Form("S11_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_S11_Y_Q0_C[i]);
	}

	TH2F *h_S12_X_Q0_C[15];
	for (int i = 0; i < 15; i++)
	{
		h_S12_X_Q0_C[i] = new TH2F(Form("S12_X_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 94, -0.5, 93.5, 5000, 0, 100);
		hlist->Add(h_S12_X_Q0_C[i]);
	}

	TH2F *h_S12_Y_Q0_C[16];
	for (int i = 0; i < 16; i++)
	{
		h_S12_Y_Q0_C[i] = new TH2F(Form("S12_Y_Q0_C_%d", i + 1), Form("Q0 (C) vs Strip ID (%d)", i), 58, -0.5, 57.5, 5000, 0, 100);
		hlist->Add(h_S12_Y_Q0_C[i]);
	}

	TH2F *h_FE91_X_Q0 = new TH2F("FE91_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q0);

	TH2F *h_FE91_X_C_Q0 = new TH2F("FE91_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q0);

	TH2F *h_FE91_X_C2_Q0 = new TH2F("FE91_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q0);

	TH2F *h_FE91_Y_Q0 = new TH2F("FE91_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q0);

	TH2F *h_FE91_Y_C_Q0 = new TH2F("FE91_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q0);

	TH2F *h_FE91_Y_C2_Q0 = new TH2F("FE91_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q0);

	TH2F *h_FE91_X_Q1 = new TH2F("FE91_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q1);

	TH2F *h_FE91_X_C_Q1 = new TH2F("FE91_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q1);

	TH2F *h_FE91_X_C2_Q1 = new TH2F("FE91_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q1);

	TH2F *h_FE91_Y_Q1 = new TH2F("FE91_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q1);

	TH2F *h_FE91_Y_C_Q1 = new TH2F("FE91_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q1);

	TH2F *h_FE91_Y_C2_Q1 = new TH2F("FE91_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q1);

	TH2F *h_FE91_X_Q2 = new TH2F("FE91_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q2);

	TH2F *h_FE91_X_C_Q2 = new TH2F("FE91_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q2);

	TH2F *h_FE91_X_C2_Q2 = new TH2F("FE91_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q2);

	TH2F *h_FE91_Y_Q2 = new TH2F("FE91_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q2);

	TH2F *h_FE91_Y_C_Q2 = new TH2F("FE91_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q2);

	TH2F *h_FE91_Y_C2_Q2 = new TH2F("FE91_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q2);

	TH2F *h_FE91_X_Q3 = new TH2F("FE91_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q3);

	TH2F *h_FE91_X_C_Q3 = new TH2F("FE91_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q3);

	TH2F *h_FE91_X_C2_Q3 = new TH2F("FE91_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q3);

	TH2F *h_FE91_Y_Q3 = new TH2F("FE91_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q3);

	TH2F *h_FE91_Y_C_Q3 = new TH2F("FE91_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q3);

	TH2F *h_FE91_Y_C2_Q3 = new TH2F("FE91_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q3);

	TH2F *h_FE91_X_Q4 = new TH2F("FE91_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q4);

	TH2F *h_FE91_X_C_Q4 = new TH2F("FE91_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q4);

	TH2F *h_FE91_X_C2_Q4 = new TH2F("FE91_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q4);

	TH2F *h_FE91_Y_Q4 = new TH2F("FE91_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q4);

	TH2F *h_FE91_Y_C_Q4 = new TH2F("FE91_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q4);

	TH2F *h_FE91_Y_C2_Q4 = new TH2F("FE91_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q4);

	TH2F *h_FE91_X_Q5 = new TH2F("FE91_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_Q5);

	TH2F *h_FE91_X_C_Q5 = new TH2F("FE91_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C_Q5);

	TH2F *h_FE91_X_C2_Q5 = new TH2F("FE91_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE91_X_C2_Q5);

	TH2F *h_FE91_Y_Q5 = new TH2F("FE91_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_Q5);

	TH2F *h_FE91_Y_C_Q5 = new TH2F("FE91_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C_Q5);

	TH2F *h_FE91_Y_C2_Q5 = new TH2F("FE91_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE91_Y_C2_Q5);

	TH2F *h_FE92_X_Q0 = new TH2F("FE92_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q0);

	TH2F *h_FE92_X_C_Q0 = new TH2F("FE92_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q0);

	TH2F *h_FE92_X_C2_Q0 = new TH2F("FE92_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q0);

	TH2F *h_FE92_Y_Q0 = new TH2F("FE92_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q0);

	TH2F *h_FE92_Y_C_Q0 = new TH2F("FE92_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q0);

	TH2F *h_FE92_Y_C2_Q0 = new TH2F("FE92_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q0);

	TH2F *h_FE92_X_Q1 = new TH2F("FE92_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q1);

	TH2F *h_FE92_X_C_Q1 = new TH2F("FE92_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q1);

	TH2F *h_FE92_X_C2_Q1 = new TH2F("FE92_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q1);

	TH2F *h_FE92_Y_Q1 = new TH2F("FE92_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q1);

	TH2F *h_FE92_Y_C_Q1 = new TH2F("FE92_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q1);

	TH2F *h_FE92_Y_C2_Q1 = new TH2F("FE92_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q1);

	TH2F *h_FE92_X_Q2 = new TH2F("FE92_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q2);

	TH2F *h_FE92_X_C_Q2 = new TH2F("FE92_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q2);

	TH2F *h_FE92_X_C2_Q2 = new TH2F("FE92_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q2);

	TH2F *h_FE92_Y_Q2 = new TH2F("FE92_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q2);

	TH2F *h_FE92_Y_C_Q2 = new TH2F("FE92_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q2);

	TH2F *h_FE92_Y_C2_Q2 = new TH2F("FE92_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q2);

	TH2F *h_FE92_X_Q3 = new TH2F("FE92_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q3);

	TH2F *h_FE92_X_C_Q3 = new TH2F("FE92_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q3);

	TH2F *h_FE92_X_C2_Q3 = new TH2F("FE92_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q3);

	TH2F *h_FE92_Y_Q3 = new TH2F("FE92_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q3);

	TH2F *h_FE92_Y_C_Q3 = new TH2F("FE92_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q3);

	TH2F *h_FE92_Y_C2_Q3 = new TH2F("FE92_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q3);

	TH2F *h_FE92_X_Q4 = new TH2F("FE92_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q4);

	TH2F *h_FE92_X_C_Q4 = new TH2F("FE92_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q4);

	TH2F *h_FE92_X_C2_Q4 = new TH2F("FE92_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q4);

	TH2F *h_FE92_Y_Q4 = new TH2F("FE92_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q4);

	TH2F *h_FE92_Y_C_Q4 = new TH2F("FE92_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q4);

	TH2F *h_FE92_Y_C2_Q4 = new TH2F("FE92_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q4);

	TH2F *h_FE92_X_Q5 = new TH2F("FE92_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_Q5);

	TH2F *h_FE92_X_C_Q5 = new TH2F("FE92_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C_Q5);

	TH2F *h_FE92_X_C2_Q5 = new TH2F("FE92_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE92_X_C2_Q5);

	TH2F *h_FE92_Y_Q5 = new TH2F("FE92_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_Q5);

	TH2F *h_FE92_Y_C_Q5 = new TH2F("FE92_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C_Q5);

	TH2F *h_FE92_Y_C2_Q5 = new TH2F("FE92_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE92_Y_C2_Q5);

	TH2F *h_FE121_X_Q0 = new TH2F("FE121_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q0);

	TH2F *h_FE121_X_C_Q0 = new TH2F("FE121_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q0);

	TH2F *h_FE121_X_C2_Q0 = new TH2F("FE121_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q0);

	TH2F *h_FE121_Y_Q0 = new TH2F("FE121_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q0);

	TH2F *h_FE121_Y_C_Q0 = new TH2F("FE121_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q0);

	TH2F *h_FE121_Y_C2_Q0 = new TH2F("FE121_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q0);

	TH2F *h_FE121_X_Q1 = new TH2F("FE121_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q1);

	TH2F *h_FE121_X_C_Q1 = new TH2F("FE121_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q1);

	TH2F *h_FE121_X_C2_Q1 = new TH2F("FE121_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q1);

	TH2F *h_FE121_Y_Q1 = new TH2F("FE121_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q1);

	TH2F *h_FE121_Y_C_Q1 = new TH2F("FE121_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q1);

	TH2F *h_FE121_Y_C2_Q1 = new TH2F("FE121_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q1);

	TH2F *h_FE121_X_Q2 = new TH2F("FE121_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q2);

	TH2F *h_FE121_X_C_Q2 = new TH2F("FE121_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q2);

	TH2F *h_FE121_X_C2_Q2 = new TH2F("FE121_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q2);

	TH2F *h_FE121_Y_Q2 = new TH2F("FE121_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q2);

	TH2F *h_FE121_Y_C_Q2 = new TH2F("FE121_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q2);

	TH2F *h_FE121_Y_C2_Q2 = new TH2F("FE121_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q2);

	TH2F *h_FE121_X_Q3 = new TH2F("FE121_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q3);

	TH2F *h_FE121_X_C_Q3 = new TH2F("FE121_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q3);

	TH2F *h_FE121_X_C2_Q3 = new TH2F("FE121_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q3);

	TH2F *h_FE121_Y_Q3 = new TH2F("FE121_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q3);

	TH2F *h_FE121_Y_C_Q3 = new TH2F("FE121_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q3);

	TH2F *h_FE121_Y_C2_Q3 = new TH2F("FE121_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q3);

	TH2F *h_FE121_X_Q4 = new TH2F("FE121_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q4);

	TH2F *h_FE121_X_C_Q4 = new TH2F("FE121_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q4);

	TH2F *h_FE121_X_C2_Q4 = new TH2F("FE121_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q4);

	TH2F *h_FE121_Y_Q4 = new TH2F("FE121_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q4);

	TH2F *h_FE121_Y_C_Q4 = new TH2F("FE121_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q4);

	TH2F *h_FE121_Y_C2_Q4 = new TH2F("FE121_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q4);

	TH2F *h_FE121_X_Q5 = new TH2F("FE121_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_Q5);

	TH2F *h_FE121_X_C_Q5 = new TH2F("FE121_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C_Q5);

	TH2F *h_FE121_X_C2_Q5 = new TH2F("FE121_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE121_X_C2_Q5);

	TH2F *h_FE121_Y_Q5 = new TH2F("FE121_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_Q5);

	TH2F *h_FE121_Y_C_Q5 = new TH2F("FE121_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C_Q5);

	TH2F *h_FE121_Y_C2_Q5 = new TH2F("FE121_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE121_Y_C2_Q5);

	TH2F *h_FE122_X_Q0 = new TH2F("FE122_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q0);

	TH2F *h_FE122_X_C_Q0 = new TH2F("FE122_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q0);

	TH2F *h_FE122_X_C2_Q0 = new TH2F("FE122_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q0);

	TH2F *h_FE122_Y_Q0 = new TH2F("FE122_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q0);

	TH2F *h_FE122_Y_C_Q0 = new TH2F("FE122_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q0);

	TH2F *h_FE122_Y_C2_Q0 = new TH2F("FE122_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q0);

	TH2F *h_FE122_X_Q1 = new TH2F("FE122_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q1);

	TH2F *h_FE122_X_C_Q1 = new TH2F("FE122_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q1);

	TH2F *h_FE122_X_C2_Q1 = new TH2F("FE122_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q1);

	TH2F *h_FE122_Y_Q1 = new TH2F("FE122_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q1);

	TH2F *h_FE122_Y_C_Q1 = new TH2F("FE122_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q1);

	TH2F *h_FE122_Y_C2_Q1 = new TH2F("FE122_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q1);

	TH2F *h_FE122_X_Q2 = new TH2F("FE122_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q2);

	TH2F *h_FE122_X_C_Q2 = new TH2F("FE122_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q2);

	TH2F *h_FE122_X_C2_Q2 = new TH2F("FE122_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q2);

	TH2F *h_FE122_Y_Q2 = new TH2F("FE122_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q2);

	TH2F *h_FE122_Y_C_Q2 = new TH2F("FE122_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q2);

	TH2F *h_FE122_Y_C2_Q2 = new TH2F("FE122_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q2);

	TH2F *h_FE122_X_Q3 = new TH2F("FE122_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q3);

	TH2F *h_FE122_X_C_Q3 = new TH2F("FE122_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q3);

	TH2F *h_FE122_X_C2_Q3 = new TH2F("FE122_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q3);

	TH2F *h_FE122_Y_Q3 = new TH2F("FE122_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q3);

	TH2F *h_FE122_Y_C_Q3 = new TH2F("FE122_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q3);

	TH2F *h_FE122_Y_C2_Q3 = new TH2F("FE122_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q3);

	TH2F *h_FE122_X_Q4 = new TH2F("FE122_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q4);

	TH2F *h_FE122_X_C_Q4 = new TH2F("FE122_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q4);

	TH2F *h_FE122_X_C2_Q4 = new TH2F("FE122_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q4);

	TH2F *h_FE122_Y_Q4 = new TH2F("FE122_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q4);

	TH2F *h_FE122_Y_C_Q4 = new TH2F("FE122_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q4);

	TH2F *h_FE122_Y_C2_Q4 = new TH2F("FE122_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q4);

	TH2F *h_FE122_X_Q5 = new TH2F("FE122_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_Q5);

	TH2F *h_FE122_X_C_Q5 = new TH2F("FE122_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C_Q5);

	TH2F *h_FE122_X_C2_Q5 = new TH2F("FE122_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_FE122_X_C2_Q5);

	TH2F *h_FE122_Y_Q5 = new TH2F("FE122_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_Q5);

	TH2F *h_FE122_Y_C_Q5 = new TH2F("FE122_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C_Q5);

	TH2F *h_FE122_Y_C2_Q5 = new TH2F("FE122_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_FE122_Y_C2_Q5);

	TH2F *h_S11_X_Q0 = new TH2F("S11_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q0);

	TH2F *h_S11_X_C_Q0 = new TH2F("S11_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q0);

	TH2F *h_S11_X_C2_Q0 = new TH2F("S11_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q0);

	TH2F *h_S11_Y_Q0 = new TH2F("S11_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q0);

	TH2F *h_S11_Y_C_Q0 = new TH2F("S11_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q0);

	TH2F *h_S11_Y_C2_Q0 = new TH2F("S11_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q0);

	TH2F *h_S11_X_Q1 = new TH2F("S11_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q1);

	TH2F *h_S11_X_C_Q1 = new TH2F("S11_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q1);

	TH2F *h_S11_X_C2_Q1 = new TH2F("S11_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q1);

	TH2F *h_S11_Y_Q1 = new TH2F("S11_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q1);

	TH2F *h_S11_Y_C_Q1 = new TH2F("S11_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q1);

	TH2F *h_S11_Y_C2_Q1 = new TH2F("S11_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q1);

	TH2F *h_S11_X_Q2 = new TH2F("S11_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q2);

	TH2F *h_S11_X_C_Q2 = new TH2F("S11_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q2);

	TH2F *h_S11_X_C2_Q2 = new TH2F("S11_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q2);

	TH2F *h_S11_Y_Q2 = new TH2F("S11_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q2);

	TH2F *h_S11_Y_C_Q2 = new TH2F("S11_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q2);

	TH2F *h_S11_Y_C2_Q2 = new TH2F("S11_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q2);

	TH2F *h_S11_X_Q3 = new TH2F("S11_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q3);

	TH2F *h_S11_X_C_Q3 = new TH2F("S11_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q3);

	TH2F *h_S11_X_C2_Q3 = new TH2F("S11_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q3);

	TH2F *h_S11_Y_Q3 = new TH2F("S11_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q3);

	TH2F *h_S11_Y_C_Q3 = new TH2F("S11_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q3);

	TH2F *h_S11_Y_C2_Q3 = new TH2F("S11_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q3);

	TH2F *h_S11_X_Q4 = new TH2F("S11_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q4);

	TH2F *h_S11_X_C_Q4 = new TH2F("S11_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q4);

	TH2F *h_S11_X_C2_Q4 = new TH2F("S11_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q4);

	TH2F *h_S11_Y_Q4 = new TH2F("S11_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q4);

	TH2F *h_S11_Y_C_Q4 = new TH2F("S11_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q4);

	TH2F *h_S11_Y_C2_Q4 = new TH2F("S11_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q4);

	TH2F *h_S11_X_Q5 = new TH2F("S11_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_Q5);

	TH2F *h_S11_X_C_Q5 = new TH2F("S11_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C_Q5);

	TH2F *h_S11_X_C2_Q5 = new TH2F("S11_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S11_X_C2_Q5);

	TH2F *h_S11_Y_Q5 = new TH2F("S11_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_Q5);

	TH2F *h_S11_Y_C_Q5 = new TH2F("S11_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C_Q5);

	TH2F *h_S11_Y_C2_Q5 = new TH2F("S11_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S11_Y_C2_Q5);

	TH2F *h_S12_X_Q0 = new TH2F("S12_X_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q0);

	TH2F *h_S12_X_C_Q0 = new TH2F("S12_X_C_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q0);

	TH2F *h_S12_X_C2_Q0 = new TH2F("S12_X_C2_Q0", "Q0 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q0);

	TH2F *h_S12_Y_Q0 = new TH2F("S12_Y_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q0);

	TH2F *h_S12_Y_C_Q0 = new TH2F("S12_Y_C_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q0);

	TH2F *h_S12_Y_C2_Q0 = new TH2F("S12_Y_C2_Q0", "Q0 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q0);

	TH2F *h_S12_X_Q1 = new TH2F("S12_X_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q1);

	TH2F *h_S12_X_C_Q1 = new TH2F("S12_X_C_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q1);

	TH2F *h_S12_X_C2_Q1 = new TH2F("S12_X_C2_Q1", "Q1 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q1);

	TH2F *h_S12_Y_Q1 = new TH2F("S12_Y_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q1);

	TH2F *h_S12_Y_C_Q1 = new TH2F("S12_Y_C_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q1);

	TH2F *h_S12_Y_C2_Q1 = new TH2F("S12_Y_C2_Q1", "Q1 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q1);

	TH2F *h_S12_X_Q2 = new TH2F("S12_X_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q2);

	TH2F *h_S12_X_C_Q2 = new TH2F("S12_X_C_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q2);

	TH2F *h_S12_X_C2_Q2 = new TH2F("S12_X_C2_Q2", "Q2 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q2);

	TH2F *h_S12_Y_Q2 = new TH2F("S12_Y_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q2);

	TH2F *h_S12_Y_C_Q2 = new TH2F("S12_Y_C_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q2);

	TH2F *h_S12_Y_C2_Q2 = new TH2F("S12_Y_C2_Q2", "Q2 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q2);

	TH2F *h_S12_X_Q3 = new TH2F("S12_X_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q3);

	TH2F *h_S12_X_C_Q3 = new TH2F("S12_X_C_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q3);

	TH2F *h_S12_X_C2_Q3 = new TH2F("S12_X_C2_Q3", "Q3 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q3);

	TH2F *h_S12_Y_Q3 = new TH2F("S12_Y_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q3);

	TH2F *h_S12_Y_C_Q3 = new TH2F("S12_Y_C_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q3);

	TH2F *h_S12_Y_C2_Q3 = new TH2F("S12_Y_C2_Q3", "Q3 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q3);

	TH2F *h_S12_X_Q4 = new TH2F("S12_X_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q4);

	TH2F *h_S12_X_C_Q4 = new TH2F("S12_X_C_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q4);

	TH2F *h_S12_X_C2_Q4 = new TH2F("S12_X_C2_Q4", "Q4 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q4);

	TH2F *h_S12_Y_Q4 = new TH2F("S12_Y_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q4);

	TH2F *h_S12_Y_C_Q4 = new TH2F("S12_Y_C_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q4);

	TH2F *h_S12_Y_C2_Q4 = new TH2F("S12_Y_C2_Q4", "Q4 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q4);

	TH2F *h_S12_X_Q5 = new TH2F("S12_X_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_Q5);

	TH2F *h_S12_X_C_Q5 = new TH2F("S12_X_C_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C_Q5);

	TH2F *h_S12_X_C2_Q5 = new TH2F("S12_X_C2_Q5", "Q5 vs Strip ID", 94, -0.5, 93.5, 5000, 0, 100);
	hlist->Add(h_S12_X_C2_Q5);

	TH2F *h_S12_Y_Q5 = new TH2F("S12_Y_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_Q5);

	TH2F *h_S12_Y_C_Q5 = new TH2F("S12_Y_C_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C_Q5);

	TH2F *h_S12_Y_C2_Q5 = new TH2F("S12_Y_C2_Q5", "Q5 vs Strip ID", 58, -0.5, 57.5, 5000, 0, 100);
	hlist->Add(h_S12_Y_C2_Q5);

	TH1F *h_FE91_X = new TH1F("FE91_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_X);

	TH1F *h_FE91_X_C = new TH1F("FE91_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_X_C);

	TH1F *h_FE91_X_C2 = new TH1F("FE91_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_X_C2);

	TH1F *h_FE91_X_M = new TH1F("FE91_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_X_M);

	TH1F *h_FE91_X_M2 = new TH1F("FE91_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_X_M2);

	TH1F *h_FE92_X = new TH1F("FE92_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_X);

	TH1F *h_FE92_X_C = new TH1F("FE92_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_X_C);

	TH1F *h_FE92_X_C2 = new TH1F("FE92_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_X_C2);

	TH1F *h_FE92_X_M = new TH1F("FE92_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_X_M);

	TH1F *h_FE92_X_M2 = new TH1F("FE92_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_X_M2);

	TH1F *h_FE9_X = new TH1F("FE9_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_X);

	TH1F *h_FE9_X_C = new TH1F("FE9_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_X_C);

	TH1F *h_FE9_X_C2 = new TH1F("FE9_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_X_C2);

	TH1F *h_FE9_X_M = new TH1F("FE9_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_X_M);

	TH1F *h_FE9_X_M2 = new TH1F("FE9_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_X_M2);

	TH1F *h_FE9_A = new TH1F("FE9_A", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_A);

	TH1F *h_FE9_A_C = new TH1F("FE9_A_C", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_A_C);

	TH1F *h_FE9_A_C2 = new TH1F("FE9_A_C2", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_A_C2);

	TH1F *h_FE9_A_M = new TH1F("FE9_A_M", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_A_M);

	TH1F *h_FE9_A_M2 = new TH1F("FE9_A_M2", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_A_M2);

	TH1F *h_FE91_Y = new TH1F("FE91_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_Y);

	TH1F *h_FE91_Y_C = new TH1F("FE91_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_Y_C);

	TH1F *h_FE91_Y_C2 = new TH1F("FE91_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_Y_C2);

	TH1F *h_FE91_Y_M = new TH1F("FE91_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_Y_M);

	TH1F *h_FE91_Y_M2 = new TH1F("FE91_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE91_Y_M2);

	TH1F *h_FE92_Y = new TH1F("FE92_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_Y);

	TH1F *h_FE92_Y_C = new TH1F("FE92_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_Y_C);

	TH1F *h_FE92_Y_C2 = new TH1F("FE92_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_Y_C2);

	TH1F *h_FE92_Y_M = new TH1F("FE92_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_Y_M);

	TH1F *h_FE92_Y_M2 = new TH1F("FE92_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE92_Y_M2);

	TH1F *h_FE9_Y = new TH1F("FE9_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_Y);

	TH1F *h_FE9_Y_C = new TH1F("FE9_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_Y_C);

	TH1F *h_FE9_Y_C2 = new TH1F("FE9_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_Y_C2);

	TH1F *h_FE9_Y_M = new TH1F("FE9_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_Y_M);

	TH1F *h_FE9_Y_M2 = new TH1F("FE9_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE9_Y_M2);

	TH1F *h_FE9_B = new TH1F("FE9_B", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_B);

	TH1F *h_FE9_B_C = new TH1F("FE9_B_C", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_B_C);

	TH1F *h_FE9_B_C2 = new TH1F("FE9_B_C2", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_B_C2);

	TH1F *h_FE9_B_M = new TH1F("FE9_B_M", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_B_M);

	TH1F *h_FE9_B_M2 = new TH1F("FE9_B_M2", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE9_B_M2);

	TH1F *h_FE121_X = new TH1F("FE121_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_X);

	TH1F *h_FE121_X_C = new TH1F("FE121_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_X_C);

	TH1F *h_FE121_X_C2 = new TH1F("FE121_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_X_C2);

	TH1F *h_FE121_X_M = new TH1F("FE121_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_X_M);

	TH1F *h_FE121_X_M2 = new TH1F("FE121_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_X_M2);

	TH1F *h_FE122_X = new TH1F("FE122_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_X);

	TH1F *h_FE122_X_C = new TH1F("FE122_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_X_C);

	TH1F *h_FE122_X_C2 = new TH1F("FE122_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_X_C2);

	TH1F *h_FE122_X_M = new TH1F("FE122_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_X_M);

	TH1F *h_FE122_X_M2 = new TH1F("FE122_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_X_M2);

	TH1F *h_FE12_X = new TH1F("FE12_X", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_X);

	TH1F *h_FE12_X_C = new TH1F("FE12_X_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_X_C);

	TH1F *h_FE12_X_C2 = new TH1F("FE12_X_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_X_C2);

	TH1F *h_FE12_X_M = new TH1F("FE12_X_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_X_M);

	TH1F *h_FE12_X_M2 = new TH1F("FE12_X_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_X_M2);

	TH1F *h_FE12_A = new TH1F("FE12_A", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_A);

	TH1F *h_FE12_A_C = new TH1F("FE12_A_C", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_A_C);

	TH1F *h_FE12_A_C2 = new TH1F("FE12_A_C2", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_A_C2);

	TH1F *h_FE12_A_M = new TH1F("FE12_A_M", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_A_M);

	TH1F *h_FE12_A_M2 = new TH1F("FE12_A_M2", "S0 Horizontal Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_A_M2);

	TH1F *h_FE121_Y = new TH1F("FE121_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_Y);

	TH1F *h_FE121_Y_C = new TH1F("FE121_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_Y_C);

	TH1F *h_FE121_Y_C2 = new TH1F("FE121_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_Y_C2);

	TH1F *h_FE121_Y_M = new TH1F("FE121_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_Y_M);

	TH1F *h_FE121_Y_M2 = new TH1F("FE121_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE121_Y_M2);

	TH1F *h_FE122_Y = new TH1F("FE122_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_Y);

	TH1F *h_FE122_Y_C = new TH1F("FE122_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_Y_C);

	TH1F *h_FE122_Y_C2 = new TH1F("FE122_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_Y_C2);

	TH1F *h_FE122_Y_M = new TH1F("FE122_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_Y_M);

	TH1F *h_FE122_Y_M2 = new TH1F("FE122_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE122_Y_M2);

	TH1F *h_FE12_Y = new TH1F("FE12_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_Y);

	TH1F *h_FE12_Y_C = new TH1F("FE12_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_Y_C);

	TH1F *h_FE12_Y_C2 = new TH1F("FE12_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_Y_C2);

	TH1F *h_FE12_Y_M = new TH1F("FE12_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_Y_M);

	TH1F *h_FE12_Y_M2 = new TH1F("FE12_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_FE12_Y_M2);

	TH1F *h_FE12_B = new TH1F("FE12_B", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_B);

	TH1F *h_FE12_B_C = new TH1F("FE12_B_C", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_B_C);

	TH1F *h_FE12_B_C2 = new TH1F("FE12_B_C2", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_B_C2);

	TH1F *h_FE12_B_M = new TH1F("FE12_B_M", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_B_M);

	TH1F *h_FE12_B_M2 = new TH1F("FE12_B_M2", "S0 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_FE12_B_M2);

	TH1F *h_S11_X = new TH1F("S11_X", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S11_X);

	TH1F *h_S11_X_C = new TH1F("S11_X_C", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S11_X_C);

	TH1F *h_S11_X_C2 = new TH1F("S11_X_C2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S11_X_C2);

	TH1F *h_S11_X_M = new TH1F("S11_X_M", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S11_X_M);

	TH1F *h_S11_X_M2 = new TH1F("S11_X_M2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S11_X_M2);

	TH1F *h_S12_X = new TH1F("S12_X", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S12_X);

	TH1F *h_S12_X_C = new TH1F("S12_X_C", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S12_X_C);

	TH1F *h_S12_X_C2 = new TH1F("S12_X_C2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S12_X_C2);

	TH1F *h_S12_X_M = new TH1F("S12_X_M", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S12_X_M);

	TH1F *h_S12_X_M2 = new TH1F("S12_X_M2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S12_X_M2);

	TH1F *h_S1_X = new TH1F("S1_X", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S1_X);

	TH1F *h_S1_X_C = new TH1F("S1_X_C", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S1_X_C);

	TH1F *h_S1_X_C2 = new TH1F("S1_X_C2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S1_X_C2);

	TH1F *h_S1_X_M = new TH1F("S1_X_M", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S1_X_M);

	TH1F *h_S1_X_M2 = new TH1F("S1_X_M2", "S0 Horizontal Position [mm]", 5000, -200, 200);
	hlist->Add(h_S1_X_M2);

	TH1F *h_S1_A = new TH1F("S1_A", "S1 Horizontal Angle [mrad]", 5000, -200, 200);
	hlist->Add(h_S1_A);

	TH1F *h_S1_A_C = new TH1F("S1_A_C", "S1 Horizontal Angle [mrad]", 5000, -200, 200);
	hlist->Add(h_S1_A_C);

	TH1F *h_S1_A_C2 = new TH1F("S1_A_C2", "S1 Horizontal Angle [mrad]", 5000, -200, 200);
	hlist->Add(h_S1_A_C2);

	TH1F *h_S1_A_M = new TH1F("S1_A_M", "S1 Horizontal Angle [mrad]", 5000, -200, 200);
	hlist->Add(h_S1_A_M);

	TH1F *h_S1_A_M2 = new TH1F("S1_A_M2", "S1 Horizontal Angle [mrad]", 5000, -200, 200);
	hlist->Add(h_S1_A_M2);

	TH1F *h_S11_Y = new TH1F("S11_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S11_Y);

	TH1F *h_S11_Y_C = new TH1F("S11_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S11_Y_C);

	TH1F *h_S11_Y_C2 = new TH1F("S11_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S11_Y_C2);

	TH1F *h_S11_Y_M = new TH1F("S11_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S11_Y_M);

	TH1F *h_S11_Y_M2 = new TH1F("S11_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S11_Y_M2);

	TH1F *h_S12_Y = new TH1F("S12_Y", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S12_Y);

	TH1F *h_S12_Y_C = new TH1F("S12_Y_C", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S12_Y_C);

	TH1F *h_S12_Y_C2 = new TH1F("S12_Y_C2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S12_Y_C2);

	TH1F *h_S12_Y_M = new TH1F("S12_Y_M", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S12_Y_M);

	TH1F *h_S12_Y_M2 = new TH1F("S12_Y_M2", "S0 Vertical Position [mm]", 5000, -100, 100);
	hlist->Add(h_S12_Y_M2);

	TH1F *h_S1_Y = new TH1F("S1_Y", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_S1_Y);

	TH1F *h_S1_Y_C = new TH1F("S1_Y_C", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_S1_Y_C);

	TH1F *h_S1_Y_C2 = new TH1F("S1_Y_C2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_S1_Y_C2);

	TH1F *h_S1_Y_M = new TH1F("S1_Y_M", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_S1_Y_M);

	TH1F *h_S1_Y_M2 = new TH1F("S1_Y_M2", "S0 Horizontal Position [mm]", 5000, -100, 100);
	hlist->Add(h_S1_Y_M2);

	TH1F *h_S1_B = new TH1F("S1_B", "S1 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_S1_B);

	TH1F *h_S1_B_C = new TH1F("S1_B_C", "S1 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_S1_B_C);

	TH1F *h_S1_B_C2 = new TH1F("S1_B_C2", "S1 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_S1_B_C2);

	TH1F *h_S1_B_M = new TH1F("S1_B_M", "S1 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_S1_B_M);

	TH1F *h_S1_B_M2 = new TH1F("S1_B_M2", "S1 Vertical Angle [mrad]", 5000, -100, 100);
	hlist->Add(h_S1_B_M2);

	TH1F *h_FE91_h_Q0_Q1 = new TH1F("FE91_h_Q0_Q1", "Q0 - Q1 (Horizontal) at FE9 first PPAC.", 2500, 0, 25);
	hlist->Add(h_FE91_h_Q0_Q1);

	TH1F *h_FE91_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE91_h_Q0_Q1_S[i][j] = new TH1F(Form("FE91_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at FE9 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE91_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE91_v_Q0_Q1 = new TH1F("FE91_v_Q0_Q1", "Q0 - Q1 (Vertical) at FE9 first PPAC.", 2500, 0, 25);
	hlist->Add(h_FE91_v_Q0_Q1);

	TH1F *h_FE91_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE91_v_Q0_Q1_S[i][j] = new TH1F(Form("FE91_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at FE9 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE91_v_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE92_h_Q0_Q1 = new TH1F("FE92_h_Q0_Q1", "Q0 - Q1 (Horizontal) at FE9 second PPAC.", 2500, 0, 25);
	hlist->Add(h_FE92_h_Q0_Q1);

	TH1F *h_FE92_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE92_h_Q0_Q1_S[i][j] = new TH1F(Form("FE92_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at FE9 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE92_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE92_v_Q0_Q1 = new TH1F("FE92_v_Q0_Q1", "Q0 - Q1 (Vertical) at FE9 second PPAC.", 2500, 0, 25);
	hlist->Add(h_FE92_v_Q0_Q1);

	TH1F *h_FE92_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE92_v_Q0_Q1_S[i][j] = new TH1F(Form("FE92_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at FE9 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE92_v_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE121_h_Q0_Q1 = new TH1F("FE121_h_Q0_Q1", "Q0 - Q1 (Horizontal) at FE12 first PPAC.", 2500, 0, 25);
	hlist->Add(h_FE121_h_Q0_Q1);

	TH1F *h_FE121_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE121_h_Q0_Q1_S[i][j] = new TH1F(Form("FE121_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at FE12 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE121_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE121_v_Q0_Q1 = new TH1F("FE121_v_Q0_Q1", "Q0 - Q1 (Vertical) at FE12 first PPAC.", 2500, 0, 25);
	hlist->Add(h_FE121_v_Q0_Q1);

	TH1F *h_FE121_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE121_v_Q0_Q1_S[i][j] = new TH1F(Form("FE121_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at FE12 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE121_v_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE122_h_Q0_Q1 = new TH1F("FE122_h_Q0_Q1", "Q0 - Q1 (Horizontal) at FE12 second PPAC.", 2500, 0, 25);
	hlist->Add(h_FE122_h_Q0_Q1);

	TH1F *h_FE122_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE122_h_Q0_Q1_S[i][j] = new TH1F(Form("FE122_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at FE12 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE122_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_FE122_v_Q0_Q1 = new TH1F("FE122_v_Q0_Q1", "Q0 - Q1 (Vertical) at FE12 second PPAC.", 2500, 0, 25);
	hlist->Add(h_FE122_v_Q0_Q1);

	TH1F *h_FE122_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_FE122_v_Q0_Q1_S[i][j] = new TH1F(Form("FE122_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at FE12 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_FE122_v_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_S11_h_Q0_Q1 = new TH1F("S11_h_Q0_Q1", "Q0 - Q1 (Horizontal) at S1 first PPAC.", 2500, 0, 25);
	hlist->Add(h_S11_h_Q0_Q1);

	TH1F *h_S11_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_S11_h_Q0_Q1_S[i][j] = new TH1F(Form("S11_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at S1 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_S11_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_S11_v_Q0_Q1 = new TH1F("S11_v_Q0_Q1", "Q0 - Q1 (Vertical) at S1 first PPAC.", 2500, 0, 25);
	hlist->Add(h_S11_v_Q0_Q1);

	TH1F *h_S11_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_S11_v_Q0_Q1_S[i][j] = new TH1F(Form("S11_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at S1 first PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_S11_v_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_S12_h_Q0_Q1 = new TH1F("S12_h_Q0_Q1", "Q0 - Q1 (Horizontal) at S1 second PPAC.", 2500, 0, 25);
	hlist->Add(h_S12_h_Q0_Q1);

	TH1F *h_S12_h_Q0_Q1_S[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
		{
			if (abs(i - j) == 1)
			{
				h_S12_h_Q0_Q1_S[i][j] = new TH1F(Form("S12_h_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Horizontal, ID  %d and %d) at S1 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_S12_h_Q0_Q1_S[i][j]);
			}
		}
	}

	TH1F *h_S12_v_Q0_Q1 = new TH1F("S12_v_Q0_Q1", "Q0 - Q1 (Vertical) at S1 second PPAC.", 2500, 0, 25);
	hlist->Add(h_S12_v_Q0_Q1);

	TH1F *h_S12_v_Q0_Q1_S[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
		{
			if (abs(i - j) == 1)
			{
				h_S12_v_Q0_Q1_S[i][j] = new TH1F(Form("S12_v_Q0_Q1_S_%d_%d", i, j), Form("Q0 - Q1 (Vertical, ID  %d and %d) at S1 second PPAC.", i, j), 2500, 0, 25);
				hlist->Add(h_S12_v_Q0_Q1_S[i][j]);
			}
		}
	}

	// TFile *file_FE9 = new TFile("/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_Conversion/FE9_Conversion_Coefficient.root");
	TFile *file_FE9 = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/SRPPAC_Conversion24/FE9_Conversion_Coefficient.root"); // for lxpool artemis installation

	file_FE9->cd();

	TH1F *h_FE91_h_Q0_Q1_F = (TH1F *)file_FE9->Get("FE91_h_Q0_Q1_F");
	TH1F *h_FE91_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE91_h_Q0_Q1_S_F[i][j] = (TH1F *)file_FE9->Get(Form("FE91_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE91_v_Q0_Q1_F = (TH1F *)file_FE9->Get("FE91_v_Q0_Q1_F");
	TH1F *h_FE91_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE91_v_Q0_Q1_S_F[i][j] = (TH1F *)file_FE9->Get(Form("FE91_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE92_h_Q0_Q1_F = (TH1F *)file_FE9->Get("FE92_h_Q0_Q1_F");
	TH1F *h_FE92_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE92_h_Q0_Q1_S_F[i][j] = (TH1F *)file_FE9->Get(Form("FE92_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE92_v_Q0_Q1_F = (TH1F *)file_FE9->Get("FE92_v_Q0_Q1_F");
	TH1F *h_FE92_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE92_v_Q0_Q1_S_F[i][j] = (TH1F *)file_FE9->Get(Form("FE92_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	// TFile *file_FE12 = new TFile("/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_Conversion/FE12_Conversion_Coefficient.root");
	TFile *file_FE12 = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/SRPPAC_Conversion24/FE12_Conversion_Coefficient.root"); // for lxpool artemis installation

	file_FE12->cd();

	TH1F *h_FE121_h_Q0_Q1_F = (TH1F *)file_FE12->Get("FE121_h_Q0_Q1_F");
	TH1F *h_FE121_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE121_h_Q0_Q1_S_F[i][j] = (TH1F *)file_FE12->Get(Form("FE121_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE121_v_Q0_Q1_F = (TH1F *)file_FE12->Get("FE121_v_Q0_Q1_F");
	TH1F *h_FE121_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE121_v_Q0_Q1_S_F[i][j] = (TH1F *)file_FE12->Get(Form("FE121_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE122_h_Q0_Q1_F = (TH1F *)file_FE12->Get("FE122_h_Q0_Q1_F");
	TH1F *h_FE122_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE122_h_Q0_Q1_S_F[i][j] = (TH1F *)file_FE12->Get(Form("FE122_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_FE122_v_Q0_Q1_F = (TH1F *)file_FE12->Get("FE122_v_Q0_Q1_F");
	TH1F *h_FE122_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_FE122_v_Q0_Q1_S_F[i][j] = (TH1F *)file_FE12->Get(Form("FE122_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	// TFile *file_S1 = new TFile("/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_Conversion/S1_Conversion_Coefficient.root");
	TFile *file_S1 = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/SRPPAC_Conversion24/S1_Conversion_Coefficient.root"); // for lxpool artemis installation

	file_S1->cd();

	TH1F *h_S11_h_Q0_Q1_F = (TH1F *)file_S1->Get("S11_h_Q0_Q1_F");

	TH1F *h_S11_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_S11_h_Q0_Q1_S_F[i][j] = (TH1F *)file_S1->Get(Form("S11_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_S11_v_Q0_Q1_F = (TH1F *)file_S1->Get("S11_v_Q0_Q1_F");
	TH1F *h_S11_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_S11_v_Q0_Q1_S_F[i][j] = (TH1F *)file_S1->Get(Form("S11_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_S12_h_Q0_Q1_F = (TH1F *)file_S1->Get("S12_h_Q0_Q1_F");
	TH1F *h_S12_h_Q0_Q1_S_F[94][94];
	for (int i = 0; i < 94; i++)
	{
		for (int j = 0; j < 94; j++)
			if (abs(i - j) == 1)
			{
				{
					h_S12_h_Q0_Q1_S_F[i][j] = (TH1F *)file_S1->Get(Form("S12_h_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	TH1F *h_S12_v_Q0_Q1_F = (TH1F *)file_S1->Get("S12_v_Q0_Q1_F");
	TH1F *h_S12_v_Q0_Q1_S_F[58][58];
	for (int i = 0; i < 58; i++)
	{
		for (int j = 0; j < 58; j++)
			if (abs(i - j) == 1)
			{
				{
					h_S12_v_Q0_Q1_S_F[i][j] = (TH1F *)file_S1->Get(Form("S12_v_Q0_Q1_S_F_%d_%d", i, j));
				}
			}
	}

	// cout << endl;
	// cout << "Variables" << endl;
	// cout << endl;

	/***************************
	  Declaration of Variables
	 ***************************/

	// Variables used in the analysis. Longitudes in mm, times in ns, energies and masses in MeV (or MeV/nucleon for the beam) and angles in degrees.

	double PI = 3.14159265358979323846; // PI, the one and only.
	double M_50Ca = 46535.0915;			// Mass of 50Ca.
	double M_51Sc = 47462.924;			// Mass of 51Sc.
	double M_49K = 45613.5757;			// Mass of 49K.

	double F3;
	double F3DS;
	double S0;
	double S1;
	double FE12;

	int SRPPAC_max_mult = 7; // maximun number of strips we read for an ion.
	int SRPPAC_max_ion = 7;	 // maximun number of strips ions we read.

	int TTT_Counter = 0;
	int YY1_Counter = 0;

	int F3_E_Counter = 0;
	int F3_Counter = 0;
	int FE91_A_E_Counter = 0;
	int FE91_A_Counter = 0;
	int FE92_A_E_Counter = 0;
	int FE92_A_Counter = 0;
	int FE9_A_Counter = 0;
	int F3_FE9_A_Counter = 0;
	int FE91_X_Counter = 0;
	int FE91_X_E_Counter = 0;
	int FE91_XA_Counter = 0;
	int FE91_XA_E_Counter = 0;
	int FE91_Y_Counter = 0;
	int FE91_Y_E_Counter = 0;
	int FE91_YA_Counter = 0;
	int FE91_YA_E_Counter = 0;
	int FE92_X_Counter = 0;
	int FE92_X_E_Counter = 0;
	int FE92_XA_Counter = 0;
	int FE92_XA_E_Counter = 0;
	int FE92_Y_Counter = 0;
	int FE92_Y_E_Counter = 0;
	int FE92_YA_Counter = 0;
	int FE92_YA_E_Counter = 0;
	int FE91_XY_Counter = 0;
	int FE91_YX_Counter = 0;
	int FE92_XY_Counter = 0;
	int FE92_YX_Counter = 0;
	int FE91_X_Q_Counter = 0;
	int FE91_Y_Q_Counter = 0;
	int FE92_X_Q_Counter = 0;
	int FE92_Y_Q_Counter = 0;
	int FE121_A_E_Counter = 0;
	int FE121_A_Counter = 0;
	int FE122_A_E_Counter = 0;
	int FE122_A_Counter = 0;
	int FE12_A_Counter = 0;
	int F3_FE12_A_Counter = 0;
	int FE121_X_Counter = 0;
	int FE121_X_E_Counter = 0;
	int FE121_XA_Counter = 0;
	int FE121_XA_E_Counter = 0;
	int FE121_Y_Counter = 0;
	int FE121_Y_E_Counter = 0;
	int FE121_YA_Counter = 0;
	int FE121_YA_E_Counter = 0;
	int FE122_X_Counter = 0;
	int FE122_X_E_Counter = 0;
	int FE122_XA_Counter = 0;
	int FE122_XA_E_Counter = 0;
	int FE122_Y_Counter = 0;
	int FE122_Y_E_Counter = 0;
	int FE122_YA_Counter = 0;
	int FE122_YA_E_Counter = 0;
	int FE121_XY_Counter = 0;
	int FE121_YX_Counter = 0;
	int FE122_XY_Counter = 0;
	int FE122_YX_Counter = 0;
	int FE121_X_Q_Counter = 0;
	int FE121_Y_Q_Counter = 0;
	int FE122_X_Q_Counter = 0;
	int FE122_Y_Q_Counter = 0;
	int S11_A_E_Counter = 0;
	int S11_A_Counter = 0;
	int S12_A_E_Counter = 0;
	int S12_A_Counter = 0;
	int S1_A_Counter = 0;
	int F3_S1_A_Counter = 0;
	int S11_X_Counter = 0;
	int S11_X_E_Counter = 0;
	int S11_XA_Counter = 0;
	int S11_XA_E_Counter = 0;
	int S11_Y_Counter = 0;
	int S11_Y_E_Counter = 0;
	int S11_YA_Counter = 0;
	int S11_YA_E_Counter = 0;
	int S12_X_E_Counter = 0;
	int S12_X_Counter = 0;
	int S12_XA_Counter = 0;
	int S12_XA_E_Counter = 0;
	int S12_Y_Counter = 0;
	int S12_Y_E_Counter = 0;
	int S12_YA_Counter = 0;
	int S12_YA_E_Counter = 0;
	int S11_XY_Counter = 0;
	int S11_YX_Counter = 0;
	int S12_XY_Counter = 0;
	int S12_YX_Counter = 0;
	int S11_X_Q_Counter = 0;
	int S11_Y_Q_Counter = 0;
	int S12_X_Q_Counter = 0;
	int S12_Y_Q_Counter = 0;

	double F3_Time = -1000000;	  // Time at F3 Diamond
	double F3_T[SRPPAC_max_mult]; // Time at F3 Diamond (array).
	double FE9_Z = 500;			  // Longitudinal distance between FE9 PPACs.

	// double FE91_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE9 first PPAC.
	// double FE92_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE9 second PPAC.
	// double FE91_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE9 first PPAC.
	// double FE92_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE9 second PPAC.
	// double FE91_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 first PPAC.
	// double FE92_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 second PPAC.
	// double FE91_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 first PPAC.
	// double FE92_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 second PPAC.
	// double FE91_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 first PPAC.
	// double FE92_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 second PPAC.
	// double FE91_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 first PPAC.
	// double FE92_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE9 second PPAC.

	double FE91_X_I[3][7][7];	 // ID, time and charge at FE9 first PPAC.
	double FE92_X_I[3][7][7];	 // ID, time and charge at FE9 second PPAC.
	double FE91_Y_I[3][7][7];	 // ID, time and charge at FE9 first PPAC.
	double FE92_Y_I[3][7][7];	 // ID, time and charge at FE9 second PPAC.
	double FE91_X_I_C[3][7][7];	 // Corrected ID, time and charge at FE9 first PPAC.
	double FE92_X_I_C[3][7][7];	 // Corrected ID, time and charge at FE9 second PPAC.
	double FE91_Y_I_C[3][7][7];	 // Corrected ID, time and charge at FE9 first PPAC.
	double FE92_Y_I_C[3][7][7];	 // Corrected ID, time and charge at FE9 second PPAC.
	double FE91_X_I_C2[3][7][7]; // Corrected ID, time and charge at FE9 first PPAC.
	double FE92_X_I_C2[3][7][7]; // Corrected ID, time and charge at FE9 second PPAC.
	double FE91_Y_I_C2[3][7][7]; // Corrected ID, time and charge at FE9 first PPAC.
	double FE92_Y_I_C2[3][7][7]; // Corrected ID, time and charge at FE9 second PPAC.

	double FE91_X[SRPPAC_max_ion];	  // Horizontal position at FE9 first PPAC.
	double FE92_X[SRPPAC_max_ion];	  // Horizontal position at FE9 second PPAC.
	double FE91_Y[SRPPAC_max_ion];	  // Vertical position at FE9 first PPAC.
	double FE92_Y[SRPPAC_max_ion];	  // Vertical position at FE9 second PPAC.
	double FE91_X_C[SRPPAC_max_ion];  // Horizontal position at FE9 first PPAC.
	double FE92_X_C[SRPPAC_max_ion];  // Horizontal position at FE9 second PPAC.
	double FE91_Y_C[SRPPAC_max_ion];  // Vertical position at FE9 first PPAC.
	double FE92_Y_C[SRPPAC_max_ion];  // Vertical position at FE9 second PPAC.
	double FE91_X_C2[SRPPAC_max_ion]; // Horizontal position at FE9 first PPAC.
	double FE92_X_C2[SRPPAC_max_ion]; // Horizontal position at FE9 second PPAC.
	double FE91_Y_C2[SRPPAC_max_ion]; // Vertical position at FE9 first PPAC.
	double FE92_Y_C2[SRPPAC_max_ion]; // Vertical position at FE9 second PPAC.
	double FE91_X_M[SRPPAC_max_ion];  // Horizontal position at FE9 first PPAC.
	double FE92_X_M[SRPPAC_max_ion];  // Horizontal position at FE9 second PPAC.
	double FE91_Y_M[SRPPAC_max_ion];  // Vertical position at FE9 first PPAC.
	double FE92_Y_M[SRPPAC_max_ion];  // Vertical position at FE9 second PPAC.
	double FE91_X_M2[SRPPAC_max_ion]; // Horizontal position at FE9 first PPAC.
	double FE92_X_M2[SRPPAC_max_ion]; // Horizontal position at FE9 second PPAC.
	double FE91_Y_M2[SRPPAC_max_ion]; // Vertical position at FE9 first PPAC.
	double FE92_Y_M2[SRPPAC_max_ion]; // Vertical position at FE9 second PPAC.
	double FE91_X_factor = 36;		  // Charge factor at FE9 first PPAC.
	double FE91_Y_factor = 50;		  // Charge factor at FE9 first PPAC.
	double FE92_X_factor = 39;		  // Charge factor at FE9 second PPAC.
	double FE92_Y_factor = 36;		  // Charge factor at FE9 second PPAC.
	double FE91_T_I[SRPPAC_max_ion];  // Time at FE9 first PPAC.
	double FE92_T_I[SRPPAC_max_ion];  // Time at FE9 second PPAC.
	double FE9_T_I[SRPPAC_max_ion];	  // Time at FE9 (average between anodes).
	double PID_T[SRPPAC_max_ion];	  // Time of Flight between F3 and FE9.
	double FE9_X[SRPPAC_max_ion];	  // Horizontal position at FE9 focal plane.
	double FE9_X_C[SRPPAC_max_ion];	  // Horizontal position between FE9 focal plane.
	double FE9_X_C2[SRPPAC_max_ion];  // Horizontal position between FE9 focal plane.
	double FE9_X_M[SRPPAC_max_ion];	  // Horizontal position between FE9 focal plane.
	double FE9_X_M2[SRPPAC_max_ion];  // Horizontal position between FE9 focal plane.
	double FE9_Y[SRPPAC_max_ion];	  // Vertical position at FE9 focal plane.
	double FE9_Y_C[SRPPAC_max_ion];	  // Vertical position between FE9 focal plane.
	double FE9_Y_C2[SRPPAC_max_ion];  // Vertical position between FE9 focal plane.
	double FE9_Y_M[SRPPAC_max_ion];	  // Vertical position between FE9 focal plane.
	double FE9_Y_M2[SRPPAC_max_ion];  // Vertical position between FE9 focal plane.
	double FE9_A[SRPPAC_max_ion];	  // Horizontal angle at FE9 focal plane.
	double FE9_A_C[SRPPAC_max_ion];	  // Horizontal angle between FE9 focal plane.
	double FE9_A_C2[SRPPAC_max_ion];  // Horizontal angle between FE9 focal plane.
	double FE9_A_M[SRPPAC_max_ion];	  // Horizontal angle between FE9 focal plane.
	double FE9_A_M2[SRPPAC_max_ion];  // Horizontal angle between FE9 focal plane.
	double FE9_B[SRPPAC_max_ion];	  // Vertical angle at FE9 focal plane.
	double FE9_B_C[SRPPAC_max_ion];	  // Vertical angle between FE9 focal plane.
	double FE9_B_C2[SRPPAC_max_ion];  // Vertical angle between FE9 focal plane.
	double FE9_B_M[SRPPAC_max_ion];	  // Vertical angle between FE9 focal plane.
	double FE9_B_M2[SRPPAC_max_ion];  // Vertical angle between FE9 focal plane.

	// double FE12_S0 = 2017;
	double Z_ToF = 14871.68;
	// double Z_ToF = 14478.68; //Longitudinal distance between FE9 (Middle of PPACs) and FE12.
	// double Z_ToF = 14539.93; //Longitudinal distance between FE9 and FE12.
	double FE12_S0 = 1962; // Longitudinal distance between FE12 first PPAC and S0.
	double FE12_Z = 500;   // Longitudinal distance between FE12 PPACs.

	// double FE121_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE12 first PPAC.
	// double FE122_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE12 second PPAC.
	// double FE121_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE12 first PPAC.
	// double FE122_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at FE12 second PPAC.
	// double FE121_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 first PPAC.
	// double FE122_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 second PPAC.
	// double FE121_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 first PPAC.
	// double FE122_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 second PPAC.
	// double FE121_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 first PPAC.
	// double FE122_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 second PPAC.
	// double FE121_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 first PPAC.
	// double FE122_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at FE12 second PPAC.

	double FE121_X_I[3][7][7];	  // ID, time and charge at FE12 first PPAC.
	double FE122_X_I[3][7][7];	  // ID, time and charge at FE12 second PPAC.
	double FE121_Y_I[3][7][7];	  // ID, time and charge at FE12 first PPAC.
	double FE122_Y_I[3][7][7];	  // ID, time and charge at FE12 second PPAC.
	double FE121_X_I_C[3][7][7];  // Corrected ID, time and charge at FE12 first PPAC.
	double FE122_X_I_C[3][7][7];  // Corrected ID, time and charge at FE12 second PPAC.
	double FE121_Y_I_C[3][7][7];  // Corrected ID, time and charge at FE12 first PPAC.
	double FE122_Y_I_C[3][7][7];  // Corrected ID, time and charge at FE12 second PPAC.
	double FE121_X_I_C2[3][7][7]; // Corrected ID, time and charge at FE12 first PPAC.
	double FE122_X_I_C2[3][7][7]; // Corrected ID, time and charge at FE12 second PPAC.
	double FE121_Y_I_C2[3][7][7]; // Corrected ID, time and charge at FE12 first PPAC.
	double FE122_Y_I_C2[3][7][7]; // Corrected ID, time and charge at FE12 second PPAC.

	double FE121_X[SRPPAC_max_ion];	   // Horizontal position at FE12 first PPAC.
	double FE122_X[SRPPAC_max_ion];	   // Horizontal position at FE12 second PPAC.
	double FE121_Y[SRPPAC_max_ion];	   // Vertical position at FE12 first PPAC.
	double FE122_Y[SRPPAC_max_ion];	   // Vertical position at FE12 second PPAC.
	double FE121_X_C[SRPPAC_max_ion];  // Horizontal position at FE12 first PPAC.
	double FE122_X_C[SRPPAC_max_ion];  // Horizontal position at FE12 second PPAC.
	double FE121_Y_C[SRPPAC_max_ion];  // Vertical position at FE12 first PPAC.
	double FE122_Y_C[SRPPAC_max_ion];  // Vertical position at FE12 second PPAC.
	double FE121_X_C2[SRPPAC_max_ion]; // Horizontal position at FE12 first PPAC.
	double FE122_X_C2[SRPPAC_max_ion]; // Horizontal position at FE12 second PPAC.
	double FE121_Y_C2[SRPPAC_max_ion]; // Vertical position at FE12 first PPAC.
	double FE122_Y_C2[SRPPAC_max_ion]; // Vertical position at FE12 second PPAC.
	double FE121_X_M[SRPPAC_max_ion];  // Horizontal position at FE12 first PPAC.
	double FE122_X_M[SRPPAC_max_ion];  // Horizontal position at FE12 second PPAC.
	double FE121_Y_M[SRPPAC_max_ion];  // Vertical position at FE12 first PPAC.
	double FE122_Y_M[SRPPAC_max_ion];  // Vertical position at FE12 second PPAC.
	double FE121_X_M2[SRPPAC_max_ion]; // Horizontal position at FE12 first PPAC.
	double FE122_X_M2[SRPPAC_max_ion]; // Horizontal position at FE12 second PPAC.
	double FE121_Y_M2[SRPPAC_max_ion]; // Vertical position at FE12 first PPAC.
	double FE122_Y_M2[SRPPAC_max_ion]; // Vertical position at FE12 second PPAC.
	double FE121_X_factor = 36;
	;								  // Charge factor at FE12 first PPAC.
	double FE121_Y_factor = 50;		  // Charge factor at FE12 first PPAC.
	double FE122_X_factor = 39;		  // Charge factor at FE12 second PPAC.
	double FE122_Y_factor = 36;		  // Charge factor at FE12 second PPAC.
	double FE121_T_I[SRPPAC_max_ion]; // Time at FE12 first PPAC.
	double FE122_T_I[SRPPAC_max_ion]; // Time at FE12 second PPAC.
	double FE12_T_I[SRPPAC_max_ion];  // Time at FE12 (average between anodes).

	double FE12_T_I_1[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_2[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_3[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_4[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_5[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_6[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_7[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_8[SRPPAC_max_ion]; // Time at FE12 (average between anodes).
	double FE12_T_I_9[SRPPAC_max_ion]; // Time at FE12 (average between anodes).

	double Beam_T[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.

	double Beam_T_1[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_2[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_3[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_4[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_5[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_6[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_7[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_8[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.
	double Beam_T_9[SRPPAC_max_ion]; // Time of Flight between FE9 and FE12.

	double FE12_X[SRPPAC_max_ion];		  // Horizontal position at FE12 focal plane.
	double FE12_X_C[SRPPAC_max_ion];	  // Horizontal position between FE12 focal plane.
	double FE12_X_C2[SRPPAC_max_ion];	  // Horizontal position between FE12 focal plane.
	double FE12_X_M[SRPPAC_max_ion];	  // Horizontal position between FE12 focal plane.
	double FE12_X_M2[SRPPAC_max_ion];	  // Horizontal position between FE12 focal plane.
	double FE12_Y[SRPPAC_max_ion];		  // Vertical position at FE12 focal plane.
	double FE12_Y_C[SRPPAC_max_ion];	  // Vertical position between FE12 focal plane.
	double FE12_Y_C2[SRPPAC_max_ion];	  // Vertical position between FE12 focal plane.
	double FE12_Y_M[SRPPAC_max_ion];	  // Vertical position between FE12 focal plane.
	double FE12_Y_M2[SRPPAC_max_ion];	  // Vertical position between FE12 focal plane.
	double FE12_A[SRPPAC_max_ion];		  // Horizontal angle at FE12 focal plane.
	double FE12_A_C[SRPPAC_max_ion];	  // Horizontal angle between FE12 focal plane.
	double FE12_A_C2[SRPPAC_max_ion];	  // Horizontal angle between FE12 focal plane.
	double FE12_A_M[SRPPAC_max_ion];	  // Horizontal angle between FE12 focal plane.
	double FE12_A_M2[SRPPAC_max_ion];	  // Horizontal angle between FE12 focal plane.
	double FE12_B[SRPPAC_max_ion];		  // Vertical angle at FE12 focal plane.
	double FE12_B_C[SRPPAC_max_ion];	  // Vertical angle between FE12 focal plane.
	double FE12_B_C2[SRPPAC_max_ion];	  // Vertical angle between FE12 focal plane.
	double FE12_B_M[SRPPAC_max_ion];	  // Vertical angle between FE12 focal plane.
	double FE12_B_M2[SRPPAC_max_ion];	  // Vertical angle between FE12 focal plane.
	double FE12_Theta[SRPPAC_max_ion];	  // Angle at FE12 focal plane.
	double FE12_Theta_C[SRPPAC_max_ion];  // Angle between FE12 focal plane.
	double FE12_Theta_C2[SRPPAC_max_ion]; // Angle between FE12 focal plane.
	double FE12_Theta_M[SRPPAC_max_ion];  // Angle between FE12 focal plane.
	double FE12_Theta_M2[SRPPAC_max_ion]; // Angle between FE12 focal plane.

	double beta;		  // Relativistic beta between FE9 and FE12.
	double gamma;		  // Relativistic gamma between FE9 and FE12.
	double E_Beam;		  // Energy of the degraded 50Ca beam.
	double E_Beam_C = 15; // Corrected energy of the degraded 50Ca beam.

	double S1_S0 = 560.8; // Longitudinal distance between S1 First SR-PPAC and S1 focal plane.
	double S1_Z = 350;	  // Longitudinal distance between S1 PPACs.

	// double S11_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at S1 first PPAC.
	// double S12_X_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at S1 second PPAC.
	// double S11_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at S1 first PPAC.
	// double S12_Y_I[3][SRPPAC_max_mult][SRPPAC_max_ion]; //ID, time and charge at S1 second PPAC.
	// double S11_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 first PPAC.
	// double S12_X_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 second PPAC.
	// double S11_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 first PPAC.
	// double S12_Y_I_C[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 second PPAC.
	// double S11_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 first PPAC.
	// double S12_X_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 second PPAC.
	// double S11_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 first PPAC.
	// double S12_Y_I_C2[3][SRPPAC_max_mult][SRPPAC_max_ion]; //Corrected ID, time and charge at S1 second PPAC.

	double S11_X_I[3][7][7];	// ID, time and charge at S1 first PPAC.
	double S12_X_I[3][7][7];	// ID, time and charge at S1 second PPAC.
	double S11_Y_I[3][7][7];	// ID, time and charge at S1 first PPAC.
	double S12_Y_I[3][7][7];	// ID, time and charge at S1 second PPAC.
	double S11_X_I_C[3][7][7];	// Corrected ID, time and charge at S1 first PPAC.
	double S12_X_I_C[3][7][7];	// Corrected ID, time and charge at S1 second PPAC.
	double S11_Y_I_C[3][7][7];	// Corrected ID, time and charge at S1 first PPAC.
	double S12_Y_I_C[3][7][7];	// Corrected ID, time and charge at S1 second PPAC.
	double S11_X_I_C2[3][7][7]; // Corrected ID, time and charge at S1 first PPAC.
	double S12_X_I_C2[3][7][7]; // Corrected ID, time and charge at S1 second PPAC.
	double S11_Y_I_C2[3][7][7]; // Corrected ID, time and charge at S1 first PPAC.
	double S12_Y_I_C2[3][7][7]; // Corrected ID, time and charge at S1 second PPAC.

	double S11_X[SRPPAC_max_ion];		// Horizontal position at S1 first PPAC.
	double S12_X[SRPPAC_max_ion];		// Horizontal position at S1 second PPAC.
	double S11_Y[SRPPAC_max_ion];		// Vertical position at S1 first PPAC.
	double S12_Y[SRPPAC_max_ion];		// Vertical position at S1 second PPAC.
	double S11_X_C[SRPPAC_max_ion];		// Horizontal position at S1 first PPAC.
	double S12_X_C[SRPPAC_max_ion];		// Horizontal position at S1 second PPAC.
	double S11_Y_C[SRPPAC_max_ion];		// Vertical position at S1 first PPAC.
	double S12_Y_C[SRPPAC_max_ion];		// Vertical position at S1 second PPAC.
	double S11_X_C2[SRPPAC_max_ion];	// Horizontal position at S1 first PPAC.
	double S12_X_C2[SRPPAC_max_ion];	// Horizontal position at S1 second PPAC.
	double S11_Y_C2[SRPPAC_max_ion];	// Vertical position at S1 first PPAC.
	double S12_Y_C2[SRPPAC_max_ion];	// Vertical position at S1 second PPAC.
	double S11_X_M[SRPPAC_max_ion];		// Horizontal position at S1 first PPAC.
	double S12_X_M[SRPPAC_max_ion];		// Horizontal position at S1 second PPAC.
	double S11_Y_M[SRPPAC_max_ion];		// Vertical position at S1 first PPAC.
	double S12_Y_M[SRPPAC_max_ion];		// Vertical position at S1 second PPAC.
	double S11_X_M2[SRPPAC_max_ion];	// Horizontal position at S1 first PPAC.
	double S12_X_M2[SRPPAC_max_ion];	// Horizontal position at S1 second PPAC.
	double S11_Y_M2[SRPPAC_max_ion];	// Vertical position at S1 first PPAC.
	double S12_Y_M2[SRPPAC_max_ion];	// Vertical position at S1 second PPAC.
	double S11_X_factor = 48;			// Charge factor at S1 first PPAC.
	double S11_Y_factor = 50;			// Charge factor at S1 first PPAC.
	double S12_X_factor = 46;			// Charge factor at S1 second PPAC.
	double S12_Y_factor = 52;			// Charge factor at S1 second PPAC.
	double S11_T_I[SRPPAC_max_ion];		// Time at S1 first PPAC.
	double S12_T_I[SRPPAC_max_ion];		// Time at S1 second PPAC.
	double S1_T_I[SRPPAC_max_ion];		// Time at S1 (average between anodes).
	double S1PID_T[SRPPAC_max_ion];		// Time at S1 (average between anodes).
	double S1_X[SRPPAC_max_ion];		// Horizontal position at S1 focal plane.
	double S1_X_C[SRPPAC_max_ion];		// Horizontal position between S1 focal plane.
	double S1_X_C2[SRPPAC_max_ion];		// Horizontal position between S1 focal plane.
	double S1_X_M[SRPPAC_max_ion];		// Horizontal position between S1 focal plane.
	double S1_X_M2[SRPPAC_max_ion];		// Horizontal position between S1 focal plane.
	double S1_Y[SRPPAC_max_ion];		// Vertical position at S1 focal plane.
	double S1_Y_C[SRPPAC_max_ion];		// Vertical position between S1 focal plane.
	double S1_Y_C2[SRPPAC_max_ion];		// Vertical position between S1 focal plane.
	double S1_Y_M[SRPPAC_max_ion];		// Vertical position between S1 focal plane.
	double S1_Y_M2[SRPPAC_max_ion];		// Vertical position between S1 focal plane.
	double S1_A[SRPPAC_max_ion];		// Horizontal angle at S1 focal plane.
	double S1_A_C[SRPPAC_max_ion];		// Horizontal angle between S1 focal plane.
	double S1_A_C2[SRPPAC_max_ion];		// Horizontal angle between S1 focal plane.
	double S1_A_M[SRPPAC_max_ion];		// Horizontal angle between S1 focal plane.
	double S1_A_M2[SRPPAC_max_ion];		// Horizontal angle between S1 focal plane.
	double S1_B[SRPPAC_max_ion];		// Vertical angle at S1 focal plane.
	double S1_B_C[SRPPAC_max_ion];		// Vertical angle between S1 focal plane.
	double S1_B_C2[SRPPAC_max_ion];		// Vertical angle between S1 focal plane.
	double S1_B_M[SRPPAC_max_ion];		// Vertical angle between S1 focal plane.
	double S1_B_M2[SRPPAC_max_ion];		// Vertical angle between S1 focal plane.
	double S1_Theta[SRPPAC_max_ion];	// Angle at S1 focal plane.
	double S1_Theta_C[SRPPAC_max_ion];	// Angle between S1 focal plane.
	double S1_Theta_C2[SRPPAC_max_ion]; // Angle between S1 focal plane.
	double S1_Theta_M[SRPPAC_max_ion];	// Angle between S1 focal plane.
	double S1_Theta_M2[SRPPAC_max_ion]; // Angle between S1 focal plane.
	double S1_R[SRPPAC_max_ion];		// Radial position at S1 focal plane.
	double S1_R_C[SRPPAC_max_ion];		// Radial position between S1 focal plane.
	double S1_R_C2[SRPPAC_max_ion];		// Radial position between S1 focal plane.
	double S1_R_M[SRPPAC_max_ion];		// Radial position between S1 focal plane.
	double S1_R_M2[SRPPAC_max_ion];		// Radial position between S1 focal plane.

	double FE9_E[SRPPAC_max_ion];  // Energy in MeV/u at FE9. This comes from PID_T_0 TOF.
	double FE12_E[SRPPAC_max_ion]; // Energy in MeV/u at FE12. This comes from Beam_T_0 TOF.
	double S1_E[SRPPAC_max_ion];   // Energy in MeV/u at S1. This comes from S1PID_T_0 TOF.

	double betaFE9[SRPPAC_max_ion];	 // beta at FE9. This comes from PID_T_0 TOF.
	double betaFE12[SRPPAC_max_ion]; // beta at FE12. This comes from Beam_T_0 TOF.
	double betaS1[SRPPAC_max_ion];	 // beta at S1. This comes from S1PID_T_0 TOF.

	double IC_Charge = 0;		 // Charge measured by the Ionization Chamber.
	double IC_Brho_zero = 1.407; // Brho at the central trajectory as determned during the experiment.
	double IC_X = -0.4;			 //(x|x) term as determined for sharaq12 experiment.
	// double IC_X = 10; //(x|x) term as determined for sharaq12 experiment.
	double IC_delta = -2222;   //(x|delta) term [mm] as determined for sharaq12 experiment.
	double IC_delta_a = 50000; //(x|delta_a) term [mm/rad] as determined for sharaq12 experiment.
	double IC_Brho;			   // Brho
	double AQ;				   // A/Q at IC.
	double IC_C_RAW[30];
	double IC_E[30];
	double IC_E_Cal[30];
	double IC_E_max;
	double IC_segment = 25.233; // Length of each individual segment [mm].
	double IC_Z;
	double IC_Telescope_deltaE;
	double IC_Telescope_E;

	// double TINA2_T_RAW[23][5]; // TINA2 RAW times.

	// double YY1_hit_energies[50]; // We order the energies descendent in energy in this vector.
	// int YY1_hit_strips[50];		 // Strip ID of the energies above.
	// double YY1_threshold = 0.;	 // Threshold for a pulse to be considered a hit for YY1.
	// // double YY1_threshold = 0.;
	// int YY1_pulse_mult;																															  // Pulse multiplicity for YY1.
	// int YY1_hit_mult;																															  // Hit multiplicity for YY1.
	// double YY1_E[5];																															  // Energy of YY1.
	// double YY1_E_C;																																  // Corrected energy of YY1 assuming a proton.
	// double YY1_theta_list[16] = {170.8, 169.8, 168.8, 167.8, 166.8, 165.7, 164.6, 163.5, 162.3, 161.2, 160.0, 158.9, 157.7, 156.5, 155.2, 154.0}; // Laboratory theta angles of the YY1.
	// double YY1_phi_list[6] = {90., 150., 210., 270., 330., 30.};
	// double YY1_r_list[16] = {251.73, 249.20, 246.76, 244.39, 242.10, 239.89, 237.76, 235.73, 233.78, 231.92, 230.16, 228.50, 226.93, 225.46, 224.09, 222.83}; // Radial distance of the YY1 strips.
	// double YY1_X;																																			  // X coordinate of the YY1.
	// double YY1_Y;																																			  // Y coordinate of the YY1.
	// double YY1_Z;																																			  // Z coordinate of the YY1.
	// double YY1_Theta;																																		  // Theta coordinate of YY1.
	// double YY1_Phi;																																			  // Phi coordinate of YY1.
	// double YY1_R;																																			  // Radial coordinate of YY1.
	// double YY1_X_C;																																			  // X coordinate of the YY1
	// double YY1_Y_C;																																			  // Y coordinate of the YY1.
	// double YY1_Z_C;																																			  // Z coordinate of the YY1.
	// double YY1_Theta_C;																																		  // Theta coordinate of YY1.
	// double YY1_Phi_C;																																		  // Phi coordinate of YY1.

	// double TTT_hit_front_energies[50]; // We order the front energies descendent in energy in this vector.
	// double TTT_hit_back_energies[50];  // We order the back energies descendent in energy in this vector.
	// int TTT_hit_front_strips[50];	   // Strip ID of the front energies above.
	// int TTT_hit_back_strips[50];	   // Strip ID of the back energies above.
	// // double TTT_correlation = 0.25; //Back-Front TTT energy correlation.
	// // double TTT_correlation = 0.25;
	// double TTT_correlation = 100.;
	// // double TTT_threshold = 1.; //Threshold for a pulse to be considered a hit for TTT.
	// double TTT_threshold = 0.;
	// int TTT_pulse_mult_front; // Pulse multiplicity for front TTT.
	// int TTT_pulse_mult_back;  // Pulse multiplicity for back TTT.
	// int TTT_hit_mult_front;	  // Hit multiplicity for front TTT.
	// int TTT_hit_mult_back;	  // Hit multiplicity for back  TTT.
	// double TTT_E_front;		  // Energy of front TTT.
	// double TTT_E_back;		  // Energy of back TTT.
	// int TTT_ID_front;		  // ID of front TTT.
	// int TTT_ID_back;		  // ID of back TTT.
	// // Some constants of TiNA2 extracted from NPTool simulations.
	// double TTT_length = 100.42;								   // Length of a TTT side.
	// double TTT_active_length = 97.22;						   // Length of the active region of a TTT side.
	// double TTT_strip_width = TTT_active_length / 128.;		   // Width of each strip.
	// double TTT_target_to_strip = -14.14 - TTT_strip_width / 2; // Distance from target to center of first back strip along Z (TTinaProccessor3.cc).
	// double TTT_X;											   // X coordinate of the TTT.
	// double TTT_Y;											   // Y coordinate of the TTT.
	// double TTT_Z;											   // Z coordinate of the TTT.
	// double TTT_Theta;										   // Theta coordinate of the TTT.
	// double TTT_Phi;											   // Phi coordinate of the TTT.
	// double TTT_X_C;											   // X coordinate of the TTT.
	// double TTT_Y_C;											   // Y coordinate of the TTT.
	// double TTT_Z_C;											   // Z coordinate of the TTT.
	// double TTT_Theta_C;										   // Theta coordinate of the TTT.
	// double TTT_Phi_C;										   // Phi coordinate of the TTT.
	// double CsI_ID[50];										   // ID of the CsI.
	// double CsI_E[50];										   // Uncalibrated energy of the CsI.
	// double CsI_Shift[16] = {0.114, -0.056, -0.329, -0.115, -0.023, -0.250, -0.111, 0.520, 0.203, 0.255, 0.017, 0.447, 0.410, 0.195, 0.400, -0.111};
	// int CsI_ID_Match; // ID of the good CsI crystal.
	// int CsI_E_Match;  // Energy of the good CsI crystal.
	// double TTT_R_C;	  // Radial distance covered by the protons.
	// double TTT_V_C;	  // Distance covered by the protons.
	// double TTT_T;	  // TTT time.
	// double CsI_T[16]; // CsI time.

	// Functions used in the analysis.
	double f_Theta(double X, double Y, double Z, double X_0, double Y_0, double Z_0);
	double f_Phi(double X, double Y);
	double f_Excitation_Energy(double Proton_Energy, double Scattering_Angle, double Beam_Energy, double Incident_Angle);
	vector<double> f_Coordinates(int ID_Front, int ID_Back);
	int f_CsI_ID(int ID_Front, int ID_Back);
	double f_SRPPAC_gain(int a, int b, int c);
	double f_SRPPAC_gain2(int o, int a, int b, int c);
	// void f_sort (double array[3][SRPPAC_max_mult][SRPPAC_max_ion]); //Function which returns an SR-PPAC array ordered from higher to lower energy
	void f_sort(double array[3][7][7]);

	// Files we read in the analysis.
	double list_SRPPAC_gain[2][6][94]; // First index = 0 (1) means vertical (horizontal)strips, second index indicates SRPPAC index starting from FE91 and third index strip number starting from 0.
	for (int i = 0; i < 2; i++)
	{
		for (int j = 0; j < 6; j++)
		{
			for (int k = 0; k < 94; k++)
			{
				list_SRPPAC_gain[i][j][k] = f_SRPPAC_gain(i, j, k);
			}
		}
	}

	double list_SRPPAC_gain2[2][16][6][94]; // First index = 0 (1) means vertical (horizontal)strips, second index indicates sector, third index indicates SRPPAC index starting from FE91 and fourth index strip number starting from 0.
	// We fill the matrix.
	for (int h = 0; h < 2; h++)
	{
		for (int i = 0; i < 16; i++)
		{
			for (int j = 0; j < 6; j++)
			{
				for (int k = 0; k < 94; k++)
				{
					list_SRPPAC_gain2[h][i][j][k] = f_SRPPAC_gain2(h, i, j, k);
				}
			}
		}
	}

	// cout << endl;
	// cout << "Output" << endl;
	// cout << endl;

	/***************************
			 Output Tree
	 ***************************/

	// We create a new File with a  smaller Tree in which we fill the good events only.
	// string output_new = "/home/jupiter/test/work/artemis-oedo/output/Analysis/sharaq12_" + to_string(frun) + "new.root";
	// TFile *ofile_new = new TFile(output_new.c_str(), "recreate");
	// TFile *ofile_new = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/physOutput/24sharaq12phys_1053new.root", "recreate");
	TFile *ofile_new = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/physOutput/24sharaq12phys_1056new.root", "recreate");
	TTree *tree_new = new TTree("tree_new", "Good events sharaq12");

	// We declare the variables que want to fill in the new Tree.
	for (int k = 0; k < SRPPAC_max_ion; k++)
	{
		string F3_T_name = "F3_T_" + to_string(k);
		tree_new->Branch(F3_T_name.c_str(), &F3_T[k], 320000);

		string PID_T_name = "PID_T_" + to_string(k);
		tree_new->Branch(PID_T_name.c_str(), &PID_T[k], 320000);

		string FE9_X_name = "FE9_X_" + to_string(k);
		tree_new->Branch(FE9_X_name.c_str(), &FE9_X_M2[k], 320000);

		string FE9_Y_name = "FE9_Y_" + to_string(k);
		tree_new->Branch(FE9_Y_name.c_str(), &FE9_Y_M2[k], 320000);

		string FE9_A_name = "FE9_A_" + to_string(k);
		tree_new->Branch(FE9_A_name.c_str(), &FE9_A_M2[k], 320000);

		string FE9_B_name = "FE9_B_" + to_string(k);
		tree_new->Branch(FE9_B_name.c_str(), &FE9_B_M2[k], 320000);

		string Beam_T_name = "Beam_T_" + to_string(k);
		tree_new->Branch(Beam_T_name.c_str(), &Beam_T[k], 320000);

		string Beam_T_1_name = "Beam_T_1_" + to_string(k);
		tree_new->Branch(Beam_T_1_name.c_str(), &Beam_T_1[k], 320000);

		string Beam_T_2_name = "Beam_T_2_" + to_string(k);
		tree_new->Branch(Beam_T_2_name.c_str(), &Beam_T_2[k], 320000);

		string Beam_T_3_name = "Beam_T_3_" + to_string(k);
		tree_new->Branch(Beam_T_3_name.c_str(), &Beam_T_3[k], 320000);

		string Beam_T_4_name = "Beam_T_4_" + to_string(k);
		tree_new->Branch(Beam_T_4_name.c_str(), &Beam_T_4[k], 320000);

		string Beam_T_5_name = "Beam_T_5_" + to_string(k);
		tree_new->Branch(Beam_T_5_name.c_str(), &Beam_T_5[k], 320000);

		string Beam_T_6_name = "Beam_T_6_" + to_string(k);
		tree_new->Branch(Beam_T_6_name.c_str(), &Beam_T_6[k], 320000);

		string Beam_T_7_name = "Beam_T_7_" + to_string(k);
		tree_new->Branch(Beam_T_7_name.c_str(), &Beam_T_7[k], 320000);

		string Beam_T_8_name = "Beam_T_8_" + to_string(k);
		tree_new->Branch(Beam_T_8_name.c_str(), &Beam_T_8[k], 320000);

		string Beam_T_9_name = "Beam_T_9_" + to_string(k);
		tree_new->Branch(Beam_T_9_name.c_str(), &Beam_T_9[k], 320000);

		string S0_X_name = "S0_X_" + to_string(k);
		tree_new->Branch(S0_X_name.c_str(), &FE12_X_M2[k], 320000);

		string S0_Y_name = "S0_Y_" + to_string(k);
		tree_new->Branch(S0_Y_name.c_str(), &FE12_Y_M2[k], 320000);

		string S0_A_name = "S0_A_" + to_string(k);
		tree_new->Branch(S0_A_name.c_str(), &FE12_A_M2[k], 320000);

		string S0_B_name = "S0_B_" + to_string(k);
		tree_new->Branch(S0_B_name.c_str(), &FE12_B_M2[k], 320000);

		string S1PID_T_name = "S1PID_T_" + to_string(k);
		tree_new->Branch(S1PID_T_name.c_str(), &S1PID_T[k], 320000);

		string S1_X_name = "S1_X_" + to_string(k);
		tree_new->Branch(S1_X_name.c_str(), &S1_X_M2[k], 320000);

		string S1_Y_name = "S1_Y_" + to_string(k);
		tree_new->Branch(S1_Y_name.c_str(), &S1_Y_M2[k], 320000);

		string S1_A_name = "S1_A_" + to_string(k);
		tree_new->Branch(S1_A_name.c_str(), &S1_A_M2[k], 320000);

		string S1_B_name = "S1_B_" + to_string(k);
		tree_new->Branch(S1_B_name.c_str(), &S1_B_M2[k], 320000);

		string FE9_E_name = "FE9_E_" + to_string(k);
		tree_new->Branch(FE9_E_name.c_str(), &FE9_E[k], 320000);

		string FE12_E_name = "FE12_E_" + to_string(k);
		tree_new->Branch(FE12_E_name.c_str(), &FE12_E[k], 320000);

		string S1_E_name = "S1_E_" + to_string(k);
		tree_new->Branch(S1_E_name.c_str(), &S1_E[k], 320000);

		string betaFE9_name = "betaFE9_" + to_string(k);
		tree_new->Branch(betaFE9_name.c_str(), &betaFE9[k], 320000);

		string betaFE12_name = "betaFE12_" + to_string(k);
		tree_new->Branch(betaFE12_name.c_str(), &betaFE12[k], 320000);

		string betaS1_name = "betaS1_" + to_string(k);
		tree_new->Branch(betaS1_name.c_str(), &betaS1[k], 320000);
	}

	// IC Charge Info to be stored in IC_C_ branch
	for (int k = 0; k < 30; k++)
	{
		string IC_name_RAW = "IC_C_" + to_string(k);
		tree_new->Branch(IC_name_RAW.c_str(), &IC_C_RAW[k], 320000);
	}

	// IC Energy Info to be stored in IC_E_ branch
	for (int k = 0; k < 30; k++)
	{
		string IC_name_Energy = "IC_E_" + to_string(k);
		tree_new->Branch(IC_name_Energy.c_str(), &IC_E[k], 320000);
	}

	// Calibrated/Scaled IC Energy Info to be stored in IC_E_Cal_ branch
	for (int k = 0; k < 30; k++)
	{
		string IC_name_EnergyCal = "IC_E_Cal_" + to_string(k);
		tree_new->Branch(IC_name_EnergyCal.c_str(), &IC_E_Cal[k], 320000);
	}

	// tree_new->Branch("YY1_ID_0", &YY1_hit_strips[0], 320000);
	// tree_new->Branch("YY1_ID_1", &YY1_hit_strips[1], 320000);
	// tree_new->Branch("YY1_ID_2", &YY1_hit_strips[2], 320000);
	// tree_new->Branch("YY1_ID_3", &YY1_hit_strips[3], 320000);
	// tree_new->Branch("YY1_ID_4", &YY1_hit_strips[4], 320000);
	// tree_new->Branch("YY1_E_0", &YY1_hit_energies[0], 320000);
	// tree_new->Branch("YY1_E_1", &YY1_hit_energies[1], 320000);
	// tree_new->Branch("YY1_E_2", &YY1_hit_energies[2], 320000);
	// tree_new->Branch("YY1_E_3", &YY1_hit_energies[3], 320000);
	// tree_new->Branch("YY1_E_4", &YY1_hit_energies[4], 320000);

	// tree_new->Branch("TTT_F_ID_0", &TTT_hit_front_strips[0], 320000);
	// tree_new->Branch("TTT_F_ID_1", &TTT_hit_front_strips[1], 320000);
	// tree_new->Branch("TTT_F_ID_2", &TTT_hit_front_strips[2], 320000);
	// tree_new->Branch("TTT_F_ID_3", &TTT_hit_front_strips[3], 320000);
	// tree_new->Branch("TTT_F_ID_4", &TTT_hit_front_strips[4], 320000);
	// tree_new->Branch("TTT_F_E_0", &TTT_hit_front_energies[0], 320000);
	// tree_new->Branch("TTT_F_E_1", &TTT_hit_front_energies[1], 320000);
	// tree_new->Branch("TTT_F_E_2", &TTT_hit_front_energies[2], 320000);
	// tree_new->Branch("TTT_F_E_3", &TTT_hit_front_energies[3], 320000);
	// tree_new->Branch("TTT_F_E_4", &TTT_hit_front_energies[4], 320000);

	// tree_new->Branch("TTT_B_ID_0", &TTT_hit_back_strips[0], 320000);
	// tree_new->Branch("TTT_B_ID_1", &TTT_hit_back_strips[1], 320000);
	// tree_new->Branch("TTT_B_ID_2", &TTT_hit_back_strips[2], 320000);
	// tree_new->Branch("TTT_B_ID_3", &TTT_hit_back_strips[3], 320000);
	// tree_new->Branch("TTT_B_ID_4", &TTT_hit_back_strips[4], 320000);
	// tree_new->Branch("TTT_B_E_0", &TTT_hit_back_energies[0], 320000);
	// tree_new->Branch("TTT_B_E_1", &TTT_hit_back_energies[1], 320000);
	// tree_new->Branch("TTT_B_E_2", &TTT_hit_back_energies[2], 320000);
	// tree_new->Branch("TTT_B_E_3", &TTT_hit_back_energies[3], 320000);
	// tree_new->Branch("TTT_B_E_4", &TTT_hit_back_energies[4], 320000);

	// tree_new->Branch("CsI_E_0", &CsI_E[0], 320000);
	// tree_new->Branch("CsI_E_1", &CsI_E[1], 320000);
	// tree_new->Branch("CsI_E_2", &CsI_E[2], 320000);
	// tree_new->Branch("CsI_E_3", &CsI_E[3], 320000);
	// tree_new->Branch("CsI_E_4", &CsI_E[4], 320000);
	// tree_new->Branch("CsI_E_5", &CsI_E[5], 320000);
	// tree_new->Branch("CsI_E_6", &CsI_E[6], 320000);
	// tree_new->Branch("CsI_E_7", &CsI_E[7], 320000);
	// tree_new->Branch("CsI_E_8", &CsI_E[8], 320000);
	// tree_new->Branch("CsI_E_9", &CsI_E[9], 320000);
	// tree_new->Branch("CsI_E_10", &CsI_E[10], 320000);
	// tree_new->Branch("CsI_E_11", &CsI_E[11], 320000);
	// tree_new->Branch("CsI_E_12", &CsI_E[12], 320000);
	// tree_new->Branch("CsI_E_13", &CsI_E[13], 320000);
	// tree_new->Branch("CsI_E_14", &CsI_E[14], 320000);
	// tree_new->Branch("CsI_E_15", &CsI_E[15], 320000);

	// tree_new->Branch("YY1_T_RAW_0", &TINA2_T_RAW[0][0], 320000);
	// tree_new->Branch("YY1_T_RAW_1", &TINA2_T_RAW[1][0], 320000);
	// tree_new->Branch("YY1_T_RAW_2", &TINA2_T_RAW[2][0], 320000);
	// tree_new->Branch("YY1_T_RAW_3", &TINA2_T_RAW[3][0], 320000);
	// tree_new->Branch("YY1_T_RAW_4", &TINA2_T_RAW[4][0], 320000);
	// tree_new->Branch("YY1_T_RAW_5", &TINA2_T_RAW[5][0], 320000);
	// tree_new->Branch("TTT_T_RAW_0", &TINA2_T_RAW[6][0], 320000);
	// tree_new->Branch("CsI_T_RAW_0", &TINA2_T_RAW[7][0], 320000);
	// tree_new->Branch("CsI_T_RAW_1", &TINA2_T_RAW[8][0], 320000);
	// tree_new->Branch("CsI_T_RAW_2", &TINA2_T_RAW[9][0], 320000);
	// tree_new->Branch("CsI_T_RAW_3", &TINA2_T_RAW[10][0], 320000);
	// tree_new->Branch("CsI_T_RAW_4", &TINA2_T_RAW[11][0], 320000);
	// tree_new->Branch("CsI_T_RAW_5", &TINA2_T_RAW[12][0], 320000);
	// tree_new->Branch("CsI_T_RAW_6", &TINA2_T_RAW[13][0], 320000);
	// tree_new->Branch("CsI_T_RAW_7", &TINA2_T_RAW[14][0], 320000);
	// tree_new->Branch("CsI_T_RAW_8", &TINA2_T_RAW[15][0], 320000);
	// tree_new->Branch("CsI_T_RAW_9", &TINA2_T_RAW[16][0], 320000);
	// tree_new->Branch("CsI_T_RAW_10", &TINA2_T_RAW[17][0], 320000);
	// tree_new->Branch("CsI_T_RAW_11", &TINA2_T_RAW[18][0], 320000);
	// tree_new->Branch("CsI_T_RAW_12", &TINA2_T_RAW[19][0], 320000);
	// tree_new->Branch("CsI_T_RAW_13", &TINA2_T_RAW[20][0], 320000);
	// tree_new->Branch("CsI_T_RAW_14", &TINA2_T_RAW[21][0], 320000);
	// tree_new->Branch("CsI_T_RAW_15", &TINA2_T_RAW[22][0], 320000);

	/***************************
				LOOP
	 ***************************/

	// cout << endl;
	cout << "LOOP" << endl;
	// cout << endl;

	// Number of events in the input tree.
	int tentries = tree->GetEntries();
	// cout << "TreeEntries = " << tentries << endl;
	// cout << endl;
	b = tentries; // We read all the entries of the Tree.
	// b = 10000;
	cout << "Number of entries = " << b << endl;
	// Loop over the events of the input Tree.endl

	// for(int i = a; i < 3; i++)
	for (int i = a; i < b; i++)
	{
		tree->GetEntry(i);
		// cout << endl;
		// cout << "Event Number = " << i << endl;
		// cout << endl;
		if (i % 100000 == 0)
		{
			cout << "Event Number " << i << endl;
		}

		// cout << "Event Number " << i << endl;

		TTT_Counter = 0;
		YY1_Counter = 0;

		/*
		if (array_coin_f3->GetEntries() > 0)
	  {
		p_coin_f3 = (TTimingChargeData*) array_coin_f3->At(0);
		F3 = p_coin_f3->GetTiming();
	  }

		if (array_coin_f3ds->GetEntries() > 0)
	  {
		p_coin_f3ds = (TTimingChargeData*) array_coin_f3ds->At(0);
		F3DS = p_coin_f3ds->GetTiming();
	  }

		if (array_coin_s0->GetEntries() > 0)
	  {
		p_coin_s0 = (TTimingChargeData*) array_coin_s0->At(0);
		S0 = p_coin_s0->GetTiming();
	  }

		if (array_coin_s1->GetEntries() > 0)
	  {
		p_coin_s1 = (TTimingChargeData*) array_coin_s1->At(0);
		S1 = p_coin_s1->GetTiming();
	  }

		if (array_coin_fe12->GetEntries() > 0)
	  {
		p_coin_fe12 = (TTimingChargeData*) array_coin_fe12->At(0);
		FE12 = p_coin_fe12->GetTiming();
	  }
		*/

		// Trigger condition we impose.
		// if (array_coin_f3ds->GetEntries() == 0)
		//    continue;

		// We first reset the values of all variables.

		for (int k = 0; k < SRPPAC_max_mult; k++)
		{
			F3_T[k] = -1000000;
			FE91_T_I[k] = -1000000;
			FE92_T_I[k] = -1000000;
			FE9_T_I[k] = -1000000;
			PID_T[k] = -1000000;
			FE121_T_I[k] = -1000000;
			FE122_T_I[k] = -1000000;
			FE12_T_I[k] = -1000000;

			FE12_T_I_1[k] = -1000000;
			FE12_T_I_2[k] = -1000000;
			FE12_T_I_3[k] = -1000000;
			FE12_T_I_4[k] = -1000000;
			FE12_T_I_5[k] = -1000000;
			FE12_T_I_6[k] = -1000000;
			FE12_T_I_7[k] = -1000000;
			FE12_T_I_8[k] = -1000000;
			FE12_T_I_9[k] = -1000000;

			Beam_T[k] = -1000000;

			Beam_T_1[k] = -1000000;
			Beam_T_2[k] = -1000000;
			Beam_T_3[k] = -1000000;
			Beam_T_4[k] = -1000000;
			Beam_T_5[k] = -1000000;
			Beam_T_6[k] = -1000000;
			Beam_T_7[k] = -1000000;
			Beam_T_8[k] = -1000000;
			Beam_T_9[k] = -1000000;

			S11_T_I[k] = -1000000;
			S12_T_I[k] = -1000000;
			S1_T_I[k] = -1000000;
			S1PID_T[k] = -1000000;

			FE9_E[k] = -1000000;
			FE12_E[k] = -1000000;
			S1_E[k] = -1000000;

			betaFE9[k] = -1000000;
			betaFE12[k] = -1000000;
			betaS1[k] = -1000000;

			for (int l = 0; l < 3; l++)
			{
				for (int m = 0; m < SRPPAC_max_ion; m++)
				{
					FE91_X_I[l][k][m] = -1000000;
					FE91_X_I_C[l][k][m] = -1000000;
					FE91_X_I_C2[l][k][m] = -1000000;
					FE91_Y_I[l][k][m] = -1000000;
					FE91_Y_I_C[l][k][m] = -1000000;
					FE91_Y_I_C2[l][k][m] = -1000000;
					FE92_X_I[l][k][m] = -1000000;
					FE92_X_I_C[l][k][m] = -1000000;
					FE92_X_I_C2[l][k][m] = -1000000;
					FE92_Y_I[l][k][m] = -1000000;
					FE92_Y_I_C[l][k][m] = -1000000;
					FE92_Y_I_C2[l][k][m] = -1000000;
					FE121_X_I[l][k][m] = -1000000;
					FE121_X_I_C[l][k][m] = -1000000;
					FE121_X_I_C2[l][k][m] = -1000000;
					FE121_Y_I[l][k][m] = -1000000;
					FE121_Y_I_C[l][k][m] = -1000000;
					FE121_Y_I_C2[l][k][m] = -1000000;
					FE122_X_I[l][k][m] = -1000000;
					FE122_X_I_C[l][k][m] = -1000000;
					FE122_X_I_C2[l][k][m] = -1000000;
					FE122_Y_I[l][k][m] = -1000000;
					FE122_Y_I_C[l][k][m] = -1000000;
					FE122_Y_I_C2[l][k][m] = -1000000;
					S11_X_I[l][k][m] = -1000000;
					S11_X_I_C[l][k][m] = -1000000;
					S11_X_I_C2[l][k][m] = -1000000;
					S11_Y_I[l][k][m] = -1000000;
					S11_Y_I_C[l][k][m] = -1000000;
					S11_Y_I_C2[l][k][m] = -1000000;
					S12_X_I[l][k][m] = -1000000;
					S12_X_I_C[l][k][m] = -1000000;
					S12_X_I_C2[l][k][m] = -1000000;
					S12_Y_I[l][k][m] = -1000000;
					S12_Y_I_C[l][k][m] = -1000000;
					S12_Y_I_C2[l][k][m] = -1000000;
				}
			}
		}

		for (int m = 0; m < SRPPAC_max_ion; m++)
		{
			FE91_X[m] = -1000000;
			FE91_X_C[m] = -1000000;
			FE91_X_C2[m] = -1000000;
			FE91_X_M[m] = -1000000;
			FE91_X_M2[m] = -1000000;
			FE91_Y[m] = -1000000;
			FE91_Y_C[m] = -1000000;
			FE91_Y_C2[m] = -1000000;
			FE91_Y_M[m] = -1000000;
			FE91_Y_M2[m] = -1000000;
			FE92_X[m] = -1000000;
			FE92_X_C[m] = -1000000;
			FE92_X_C2[m] = -1000000;
			FE92_X_M[m] = -1000000;
			FE92_X_M2[m] = -1000000;
			FE92_Y[m] = -1000000;
			FE92_Y_C[m] = -1000000;
			FE92_Y_C2[m] = -1000000;
			FE92_Y_M[m] = -1000000;
			FE92_Y_M2[m] = -1000000;
			FE9_X[m] = -1000000;
			FE9_X_C[m] = -1000000;
			FE9_X_C2[m] = -1000000;
			FE9_X_M[m] = -1000000;
			FE9_X_M2[m] = -1000000;
			FE9_Y[m] = -1000000;
			FE9_Y_C[m] = -1000000;
			FE9_Y_C2[m] = -1000000;
			FE9_Y_M[m] = -1000000;
			FE9_Y_M2[m] = -1000000;
			FE9_A[m] = -1000000;
			FE9_A_C[m] = -1000000;
			FE9_A_C2[m] = -1000000;
			FE9_A_M[m] = -1000000;
			FE9_A_M2[m] = -1000000;
			FE9_B[m] = -1000000;
			FE9_B_C[m] = -1000000;
			FE9_B_C2[m] = -1000000;
			FE9_B_M[m] = -1000000;
			FE9_B_M2[m] = -1000000;
			FE121_X[m] = -1000000;
			FE121_X_C[m] = -1000000;
			FE121_X_C2[m] = -1000000;
			FE121_X_M[m] = -1000000;
			FE121_X_M2[m] = -1000000;
			FE121_Y[m] = -1000000;
			FE121_Y_C[m] = -1000000;
			FE121_Y_C2[m] = -1000000;
			FE121_Y_M[m] = -1000000;
			FE121_Y_M2[m] = -1000000;
			FE122_X[m] = -1000000;
			FE122_X_C[m] = -1000000;
			FE122_X_C2[m] = -1000000;
			FE122_X_M[m] = -1000000;
			FE122_X_M2[m] = -1000000;
			FE122_Y[m] = -1000000;
			FE122_Y_C[m] = -1000000;
			FE122_Y_C2[m] = -1000000;
			FE122_Y_M[m] = -1000000;
			FE122_Y_M2[m] = -1000000;
			FE12_X[m] = -1000000;
			FE12_X_C[m] = -1000000;
			FE12_X_C2[m] = -1000000;
			FE12_X_M[m] = -1000000;
			FE12_X_M2[m] = -1000000;
			FE12_Y[m] = -1000000;
			FE12_Y_C[m] = -1000000;
			FE12_Y_C2[m] = -1000000;
			FE12_Y_M[m] = -1000000;
			FE12_Y_M2[m] = -1000000;
			FE12_A[m] = -1000000;
			FE12_A_C[m] = -1000000;
			FE12_A_C2[m] = -1000000;
			FE12_A_M[m] = -1000000;
			FE12_A_M2[m] = -1000000;
			FE12_B[m] = -1000000;
			FE12_B_C[m] = -1000000;
			FE12_B_C2[m] = -1000000;
			FE12_B_M[m] = -1000000;
			FE12_B_M2[m] = -1000000;
			S11_X[m] = -1000000;
			S11_X_C[m] = -1000000;
			S11_X_C2[m] = -1000000;
			S11_X_M[m] = -1000000;
			S11_X_M2[m] = -1000000;
			S11_Y[m] = -1000000;
			S11_Y_C[m] = -1000000;
			S11_Y_C2[m] = -1000000;
			S11_Y_M[m] = -1000000;
			S11_Y_M2[m] = -1000000;
			S12_X[m] = -1000000;
			S12_X_C[m] = -1000000;
			S12_X_C2[m] = -1000000;
			S12_X_M[m] = -1000000;
			S12_X_M2[m] = -1000000;
			S12_Y[m] = -1000000;
			S12_Y_C[m] = -1000000;
			S12_Y_C2[m] = -1000000;
			S12_Y_M[m] = -1000000;
			S12_Y_M2[m] = -1000000;
			S1_X[m] = -1000000;
			S1_X_C[m] = -1000000;
			S1_X_C2[m] = -1000000;
			S1_X_M[m] = -1000000;
			S1_X_M2[m] = -1000000;
			S1_Y[m] = -1000000;
			S1_Y_C[m] = -1000000;
			S1_Y_C2[m] = -1000000;
			S1_Y_M[m] = -1000000;
			S1_Y_M2[m] = -1000000;
			S1_A[m] = -1000000;
			S1_A_C[m] = -1000000;
			S1_A_C2[m] = -1000000;
			S1_A_M[m] = -1000000;
			S1_A_M2[m] = -1000000;
			S1_B[m] = -1000000;
			S1_B_C[m] = -1000000;
			S1_B_C2[m] = -1000000;
			S1_B_M[m] = -1000000;
			S1_B_M2[m] = -1000000;
		}

		/********************************************
		  1.- F3-FE9 Particle Identification (PID)
		 ********************************************/

		// cout << endl;
		// cout << "F3-FE9" << endl;
		// cout << endl;

		// 1.- Particle Identification (PID) of the beam through F3 CVD Diamod detector and FE9 SR-PPACs.

		// cout << endl;
		// cout << endl;
		// cout << "EVENT = " << i << endl;
		// cout << endl;
		// cout << endl;

		// From the time provided by the F3 diamond and the FE9 SRPPACs anodes we obtain the F3-FE9 ToF of the ions.

		// cout << endl;
		// cout << "F3 anode: " << array_F3_t->GetEntries() << " entries" << endl;

		if (array_F3_t->GetEntries() > 0)
		{
			F3_E_Counter = F3_E_Counter + 1;
			for (int k = 0; k < array_F3_t->GetEntries() && k < SRPPAC_max_ion; k++)
			{
				F3_Counter = F3_Counter + 1;
				p_F3_t = (TTimingChargePositionData *)array_F3_t->At(k);
				F3_T[k] = p_F3_t->GetTiming();

				// cout << endl;
				// cout << "Entry = " << k << endl;
				// cout << "F3 Time = " << F3_T[k] << endl;
			}
		}

		// cout << "F3 OK" << endl;

		// cout << endl;
		// cout << "FE91 anode: " << array_FE91_t->GetEntries() << " entries" << endl;

		if (array_FE91_t->GetEntries() > 0)
		{
			FE91_A_E_Counter = FE91_A_E_Counter + 1;
			for (int k = 0; k < array_FE91_t->GetEntries() && k < SRPPAC_max_ion; k++)
			{
				FE91_A_Counter = FE91_A_Counter + 1;
				p_FE91_t = (TTimingChargePositionData *)array_FE91_t->At(k);
				FE91_T_I[k] = p_FE91_t->GetTiming();

				// cout << endl;
				// cout << "Entry = " << k << endl;
				// cout << "Time = " << FE91_T_I[k] << endl;
			}
		}

		// cout << "FE91 Anode OK" << endl;

		// cout << endl;
		// cout << "FE92 anode: " << array_FE92_t->GetEntries() << " entries" << endl;

		if (array_FE92_t->GetEntries() > 0)
		{
			FE92_A_E_Counter = FE92_A_E_Counter + 1;
			for (int k = 0; k < array_FE92_t->GetEntries() && k < SRPPAC_max_ion; k++)
			{
				FE92_A_Counter = FE92_A_Counter + 1;
				p_FE92_t = (TTimingChargePositionData *)array_FE92_t->At(k);
				FE92_T_I[k] = p_FE92_t->GetTiming();

				// cout << endl;
				// cout << "Entry = " << k << endl;
				// cout << "Time = " << FE92_T_I[k] << endl;
			}
		}

		// cout << "FE92 Anode OK" << endl;

		// cout << endl;
		// cout << "FE9 Time: " << endl;

		double FE9_T_dummy;
		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				// h_T_FE9A->Fill(FE92_T_I[j] - FE91_T_I[k]);
				if (FE92_T_I[j] - FE91_T_I[k] > 4. && FE92_T_I[j] - FE91_T_I[k] < 43.)
				{
					FE9_A_Counter = FE9_A_Counter + 1;
					FE9_T_dummy = (542.25 * FE92_T_I[j] - 122.5 * FE91_T_I[k]) / 419.75;
					FE9_T_I[j] = FE9_T_dummy;

					// cout << endl;
					// cout << "FE91 Entry = " << k << ", FE92 Entry = " << j << endl;
					// cout << "Time = " << FE9_T_I[j] << endl;
				}
			}
		}

		// cout << "FE9 Anode OK" << endl;

		// cout << endl;
		// cout << "PID Time: " << endl;

		double betaFE9_dummy;
		double FE9_E_dummy;
		double PID_T_dummy;
		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				h_T_FE9A_F3->Fill(FE9_T_I[j] - F3_T[k]);
				if (FE9_T_I[j] - F3_T[k] > 1020. && FE9_T_I[j] - F3_T[k] < 1140.)
				{
					F3_FE9_A_Counter = F3_FE9_A_Counter + 1;
					PID_T_dummy = FE9_T_I[j] - F3_T[k];
					PID_T[k] = PID_T_dummy;

					// cout << endl;
					// cout << "F3 Entry = " << k << ", FE9 Entry = " << j << endl;
					// cout << "PID Time = " << PID_T[k] << endl;

					FE9_E_dummy = calculateBeamEnergy(PID_T[k], distance_F3_FE9);
					FE9_E[k] = FE9_E_dummy;

					betaFE9_dummy = calculateBeta(PID_T[k], distance_F3_FE9);
					betaFE9[k] = betaFE9_dummy;
				}
			}
		}

		// cout << "F3-FE9 Anode OK" << endl;

		// cout << endl;
		// cout << "FE91 X catode: " << array_FE91_x_cal->GetEntries() << " entries" << endl;

		// We calculate the position at FE9 of the F3-FE9 ions.
		double FE91_X_T_dummy;
		if (array_FE91_x_cal->GetEntries() > 0)
		{
			FE91_X_E_Counter = FE91_X_E_Counter + 1;
			for (int k = 0; k < array_FE91_x_cal->GetEntries() && k < 50; k++)
			{
				FE91_X_Counter = FE91_X_Counter + 1;
				p_FE91_x_cal = (TTimingChargePositionData *)array_FE91_x_cal->At(k);
				FE91_X_T_dummy = p_FE91_x_cal->GetTiming();

				for (int m = 0; m < array_FE91_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					// h_T_FE91X_F3->Fill(FE91_X_T_dummy - F3_T[m]);
					// h_T_FE91X_F3_Event->Fill(i,FE91_X_T_dummy - F3_T[m]);
					if (FE91_X_T_dummy - F3_T[m] > 1020 && FE91_X_T_dummy - F3_T[m] < 1080)
					{
						if (FE91_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE91_X_I[0][l - 1][m] != -1000000 && FE91_X_I[0][l][m] == -1000000 && FE91_X_I[1][l - 1][m] != p_FE91_x_cal->GetTiming())
								{
									FE91_XA_Counter = FE91_XA_Counter + 1;
									FE91_X_I[0][l][m] = p_FE91_x_cal->GetID();
									FE91_X_I[1][l][m] = p_FE91_x_cal->GetTiming();
									FE91_X_I[2][l][m] = p_FE91_x_cal->GetCharge();

									FE91_X_I_C[0][l][m] = FE91_X_I[0][l][m];
									FE91_X_I_C[1][l][m] = FE91_X_I[1][l][m];
									FE91_X_I_C[2][l][m] = FE91_X_I[2][l][m] * (FE91_X_factor / list_SRPPAC_gain[1][0][int(FE91_X_I[0][l][m])]);

									// cout << endl;
									// cout << "Entry = " << k << endl;
									// cout << "Ion (Multiplicity) = " << m << endl;
									// cout << "ID = " << FE91_X_I[0][l][m]  << endl;
									// cout << "Time = " << FE91_X_I[1][l][m]  << endl;
									// cout << "Charge = " << FE91_X_I[2][l][m]  << endl;
									// cout << "ID (C) = " << FE91_X_I_C[0][l][m]  << endl;
									// cout << "Time (C) = " << FE91_X_I_C[1][l][m]  << endl;
									// cout << "Charge (C) = " << FE91_X_I_C[2][l][m]  << endl;
								}
							}
						}

						if (FE91_X_I[0][0][m] == -1000000)
						{
							FE91_XA_E_Counter = FE91_XA_E_Counter + 1;
							FE91_X_I[0][0][m] = p_FE91_x_cal->GetID();
							FE91_X_I[1][0][m] = p_FE91_x_cal->GetTiming();
							FE91_X_I[2][0][m] = p_FE91_x_cal->GetCharge();

							FE91_X_I_C[0][0][m] = FE91_X_I[0][0][m];
							FE91_X_I_C[1][0][m] = FE91_X_I[1][0][m];
							FE91_X_I_C[2][0][m] = FE91_X_I[2][0][m] * (FE91_X_factor / list_SRPPAC_gain[1][0][int(FE91_X_I[0][0][m])]);

							// cout << endl;
							// cout << "Entry = " << k << endl;
							// cout << "Ion (Multiplicity) = " << m << endl;
							// cout << "ID = " << FE91_X_I[0][0][m]  << endl;
							// cout << "Time = " << FE91_X_I[1][0][m]  << endl;
							// cout << "Charge = " << FE91_X_I[2][0][m]  << endl;
							// cout << "ID (C) = " << FE91_X_I_C[0][0][m]  << endl;
							// cout << "Time (C) = " << FE91_X_I_C[1][0][m]  << endl;
							// cout << "Charge (C) = " << FE91_X_I_C[2][0][m]  << endl;
						}
					}
				}
			}
		}

		f_sort(FE91_X_I_C);

		////cout << "FE91 X OK" << endl;

		// cout << endl;
		// cout << "FE91 Y catode: " << array_FE91_y_cal->GetEntries() << " entries" << endl;

		double FE91_Y_T_dummy;
		if (array_FE91_y_cal->GetEntries() > 0)
		{
			FE91_Y_E_Counter = FE91_Y_E_Counter + 1;
			for (int k = 0; k < array_FE91_y_cal->GetEntries() && k < 50; k++)
			{
				FE91_Y_Counter = FE91_Y_Counter + 1;
				p_FE91_y_cal = (TTimingChargePositionData *)array_FE91_y_cal->At(k);
				FE91_Y_T_dummy = p_FE91_y_cal->GetTiming();

				for (int m = 0; m < array_FE91_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE91Y_F3->Fill(FE91_Y_T_dummy - F3_T[m]);
					if (FE91_Y_T_dummy - F3_T[m] > 1030 && FE91_Y_T_dummy - F3_T[m] < 1090)
					{
						if (FE91_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE91_Y_I[0][l - 1][m] != -1000000 && FE91_Y_I[0][l][m] == -1000000 && FE91_Y_I[1][l - 1][m] != p_FE91_y_cal->GetTiming())
								{
									FE91_YA_Counter = FE91_YA_Counter + 1;
									FE91_Y_I[0][l][m] = p_FE91_y_cal->GetID();
									FE91_Y_I[1][l][m] = p_FE91_y_cal->GetTiming();
									FE91_Y_I[2][l][m] = p_FE91_y_cal->GetCharge();

									FE91_Y_I_C[0][l][m] = FE91_Y_I[0][l][m];
									FE91_Y_I_C[1][l][m] = FE91_Y_I[1][l][m];
									FE91_Y_I_C[2][l][m] = FE91_Y_I[2][l][m] * (FE91_Y_factor / list_SRPPAC_gain[0][0][int(FE91_Y_I[0][l][m])]);

									// cout << endl;
									// cout << "Entry = " << k << endl;
									// cout << "Ion (Multiplicity) = " << m << endl;
									// cout << "ID = " << FE91_Y_I[0][l][m]  << endl;
									// cout << "Time = " << FE91_Y_I[1][l][m]  << endl;
									// cout << "Charge = " << FE91_Y_I[2][l][m]  << endl;
									// cout << "ID (C) = " << FE91_Y_I_C[0][l][m]  << endl;
									// cout << "Time (C) = " << FE91_Y_I_C[1][l][m]  << endl;
									// cout << "Charge (C) = " << FE91_Y_I_C[2][l][m]  << endl;
								}
							}
						}

						if (FE91_Y_I[0][0][m] == -1000000)
						{
							FE91_YA_E_Counter = FE91_YA_E_Counter + 1;
							FE91_Y_I[0][0][m] = p_FE91_y_cal->GetID();
							FE91_Y_I[1][0][m] = p_FE91_y_cal->GetTiming();
							FE91_Y_I[2][0][m] = p_FE91_y_cal->GetCharge();

							FE91_Y_I_C[0][0][m] = FE91_Y_I[0][0][m];
							FE91_Y_I_C[1][0][m] = FE91_Y_I[1][0][m];
							FE91_Y_I_C[2][0][m] = FE91_Y_I[2][0][m] * (FE91_Y_factor / list_SRPPAC_gain[0][0][int(FE91_Y_I[0][0][m])]);

							// cout << endl;
							// cout << "Entry = " << k << endl;
							// cout << "Ion (Multiplicity) = " << m << endl;
							// cout << "ID = " << FE91_Y_I[0][0][m]  << endl;
							// cout << "Time = " << FE91_Y_I[1][0][m]  << endl;
							// cout << "Charge = " << FE91_Y_I[2][0][m]  << endl;
							// cout << "ID (C) = " << FE91_Y_I_C[0][0][m]  << endl;
							// cout << "Time (C) = " << FE91_Y_I_C[1][0][m]  << endl;
							// cout << "Charge (C) = " << FE91_Y_I_C[2][0][m]  << endl;
						}
					}
				}
			}
		}

		f_sort(FE91_Y_I_C);

		// cout << "FE91 Y OK" << endl;

		// cout << endl;
		// cout << "FE91 Y (C2): " << endl;

		for (int k = 0; k < array_FE91_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE91_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE91_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE91_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE91_X_I_C[0][0][m] - FE91_Y_I_C[0][0][l]) < 50)
						{
							FE91_XY_Counter = FE91_XY_Counter + 1;
							FE91_X_I_C2[0][k][m] = FE91_X_I_C[0][k][m];
							FE91_X_I_C2[1][k][m] = FE91_X_I_C[1][k][m];
							FE91_X_I_C2[2][k][m] = FE91_X_I_C[2][k][m] * (FE91_X_factor / list_SRPPAC_gain2[1][int(FE91_Y_I_C[0][0][l] / 4)][0][int(FE91_X_I_C[0][k][m])]);

							// cout << endl;
							// cout << "Entry = " << k << endl;
							// cout << "Ion (Multiplicity) = " << m << endl;
							// cout << "ID = " << FE91_X_I_C2[0][0][m]  << endl;
							// cout << "Time = " << FE91_X_I_C2[1][0][m]  << endl;
							// cout << "Charge = " << FE91_X_I_C2[2][0][m]  << endl;
						}
					}
				}
			}
		}

		f_sort(FE91_X_I_C2);

		// cout << "FE91 X_C2 OK" << endl;

		for (int k = 0; k < array_FE91_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE91_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE91_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE91_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE91_Y_I_C[0][0][m] - FE91_X_I_C[0][0][l]) < 50)
						{
							FE91_YX_Counter = FE91_YX_Counter + 1;
							FE91_Y_I_C2[0][k][m] = FE91_Y_I_C[0][k][m];
							FE91_Y_I_C2[1][k][m] = FE91_Y_I_C[1][k][m];
							FE91_Y_I_C2[2][k][m] = FE91_Y_I_C[2][k][m] * (FE91_Y_factor / list_SRPPAC_gain2[0][int(FE91_X_I_C[0][0][l] / 6)][0][int(FE91_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE91_Y_I_C2);

		// cout << "FE91 Y_C2 OK" << endl;

		for (int m = 0; m < array_FE91_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_X_I_C2[2][1][m] > 0 && abs(FE91_X_I_C2[0][0][m] - FE91_X_I_C2[0][1][m]) == 1)
			{
				h_FE91_h_Q0_Q1->Fill(FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]);
				h_FE91_h_Q0_Q1_S[int(FE91_X_I_C2[0][0][m])][int(FE91_X_I_C2[0][1][m])]->Fill(FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]);

				FE91_X_Q_Counter = FE91_X_Q_Counter + 1;
				double FE91_X_up = 0.;
				double FE91_X_down = 0.;
				double FE91_X_up_C = 0.;
				double FE91_X_down_C = 0.;
				double FE91_X_up_C2 = 0.;
				double FE91_X_down_C2 = 0.;
				for (int k = 0; k < array_FE91_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_X_I[2][k][m]))
						continue;
					FE91_X_up = FE91_X_up + FE91_X_I[0][k][m] * FE91_X_I[2][k][m];
					FE91_X_down = FE91_X_down + FE91_X_I[2][k][m];
				}
				for (int k = 0; k < array_FE91_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_X_I_C[2][k][m]))
						continue;
					FE91_X_up_C = FE91_X_up_C + FE91_X_I_C[0][k][m] * FE91_X_I_C[2][k][m];
					FE91_X_down_C = FE91_X_down_C + FE91_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE91_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_X_I_C2[2][k][m]))
						continue;
					FE91_X_up_C2 = FE91_X_up_C2 + FE91_X_I_C2[0][k][m] * FE91_X_I_C2[2][k][m];
					FE91_X_down_C2 = FE91_X_down_C2 + FE91_X_I_C2[2][k][m];
				}

				FE91_X[m] = -((FE91_X_up / FE91_X_down) * (240. / 94.) + 2.55 / 2. - 120);
				FE91_X_C[m] = -((FE91_X_up_C / FE91_X_down_C) * (240. / 94.) + 2.55 / 2. - 120);
				FE91_X_C2[m] = -((FE91_X_up_C2 / FE91_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120);

				if (FE91_X_I_C2[0][0][m] > FE91_X_I_C2[0][1][m])
				{
					FE91_X_M[m] = -((FE91_X_I_C2[0][0][m] - (1 - h_FE91_h_Q0_Q1_F->GetBinContent(int((FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE91_X_I_C2[0][0][m] < FE91_X_I_C2[0][1][m])
				{
					FE91_X_M[m] = -((FE91_X_I_C2[0][0][m] + (1 - h_FE91_h_Q0_Q1_F->GetBinContent(int((FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE91_X_I_C2[0][0][m] > FE91_X_I_C2[0][1][m])
				{
					FE91_X_M2[m] = -((FE91_X_I_C2[0][0][m] - (1 - h_FE91_h_Q0_Q1_S_F[int(FE91_X_I_C2[0][0][m])][int(FE91_X_I_C2[0][1][m])]->GetBinContent(int((FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE91_X_I_C2[0][0][m] < FE91_X_I_C2[0][1][m])
				{
					FE91_X_M2[m] = -((FE91_X_I_C2[0][0][m] + (1 - h_FE91_h_Q0_Q1_S_F[int(FE91_X_I_C2[0][0][m])][int(FE91_X_I_C2[0][1][m])]->GetBinContent(int((FE91_X_I_C2[2][0][m] - FE91_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}
			}
		}

		// cout << "FE91 X_M2 OK" << endl;

		for (int m = 0; m < array_FE91_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_Y_I_C2[2][1][m] > 0 && abs(FE91_Y_I_C2[0][0][m] - FE91_Y_I_C2[0][1][m]) == 1)
			{
				h_FE91_v_Q0_Q1->Fill(FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]);
				h_FE91_v_Q0_Q1_S[int(FE91_Y_I_C2[0][0][m])][int(FE91_Y_I_C2[0][1][m])]->Fill(FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]);

				FE91_Y_Q_Counter = FE91_Y_Q_Counter + 1;
				double FE91_Y_up = 0.;
				double FE91_Y_down = 0.;
				double FE91_Y_up_C = 0.;
				double FE91_Y_down_C = 0.;
				double FE91_Y_up_C2 = 0.;
				double FE91_Y_down_C2 = 0.;
				for (int k = 0; k < array_FE91_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_Y_I[2][k][m]))
						continue;
					FE91_Y_up = FE91_Y_up + FE91_Y_I[0][k][m] * FE91_Y_I[2][k][m];
					FE91_Y_down = FE91_Y_down + FE91_Y_I[2][k][m];
				}
				for (int k = 0; k < array_FE91_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_Y_I_C[2][k][m]))
						continue;
					FE91_Y_up_C = FE91_Y_up_C + FE91_Y_I_C[0][k][m] * FE91_Y_I_C[2][k][m];
					FE91_Y_down_C = FE91_Y_down_C + FE91_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE91_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE91_Y_I_C2[2][k][m]))
						continue;
					FE91_Y_up_C2 = FE91_Y_up_C2 + FE91_Y_I_C2[0][k][m] * FE91_Y_I_C2[2][k][m];
					FE91_Y_down_C2 = FE91_Y_down_C2 + FE91_Y_I_C2[2][k][m];
				}

				FE91_Y[m] = -((FE91_Y_up / FE91_Y_down) * (150. / 58.) + 2.58 / 2. - 75);
				FE91_Y_C[m] = -((FE91_Y_up_C / FE91_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75);
				FE91_Y_C2[m] = -((FE91_Y_up_C2 / FE91_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75);

				if (FE91_Y_I_C2[0][0][m] > FE91_Y_I_C2[0][1][m])
				{
					FE91_Y_M[m] = -((FE91_Y_I_C2[0][0][m] - (1 - h_FE91_v_Q0_Q1_F->GetBinContent(int((FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE91_Y_I_C2[0][0][m] < FE91_Y_I_C2[0][1][m])
				{
					FE91_Y_M[m] = -((FE91_Y_I_C2[0][0][m] + (1 - h_FE91_v_Q0_Q1_F->GetBinContent(int((FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE91_Y_I_C2[0][0][m] > FE91_Y_I_C2[0][1][m])
				{
					FE91_Y_M2[m] = -((FE91_Y_I_C2[0][0][m] - (1 - h_FE91_v_Q0_Q1_S_F[int(FE91_Y_I_C2[0][0][m])][int(FE91_Y_I_C2[0][1][m])]->GetBinContent(int((FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE91_Y_I_C2[0][0][m] < FE91_Y_I_C2[0][1][m])
				{
					FE91_Y_M2[m] = -((FE91_Y_I_C2[0][0][m] + (1 - h_FE91_v_Q0_Q1_S_F[int(FE91_Y_I_C2[0][0][m])][int(FE91_Y_I_C2[0][1][m])]->GetBinContent(int((FE91_Y_I_C2[2][0][m] - FE91_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}
			}
		}

		// cout << "FE91 Y_M2 OK" << endl;

		double FE92_X_T_dummy;
		if (array_FE92_x_cal->GetEntries() > 0)
		{
			FE92_X_E_Counter = FE92_X_E_Counter + 1;
			for (int k = 0; k < array_FE92_x_cal->GetEntries() && k < 50; k++)
			{
				FE92_X_Counter = FE92_X_Counter + 1;
				p_FE92_x_cal = (TTimingChargePositionData *)array_FE92_x_cal->At(k);
				FE92_X_T_dummy = p_FE92_x_cal->GetTiming();

				for (int m = 0; m < array_FE92_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE92X_F3->Fill(FE92_X_T_dummy - F3_T[m]);
					if (FE92_X_T_dummy - F3_T[m] > 1020 && FE92_X_T_dummy - F3_T[m] < 1100)
					{
						if (FE92_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE92_X_I[0][l - 1][m] != -1000000 && FE92_X_I[0][l][m] == -1000000 && FE92_X_I[1][l - 1][m] != p_FE92_x_cal->GetTiming())
								{
									FE92_XA_Counter = FE92_XA_Counter + 1;
									FE92_X_I[0][l][m] = p_FE92_x_cal->GetID();
									FE92_X_I[1][l][m] = p_FE92_x_cal->GetTiming();
									FE92_X_I[2][l][m] = p_FE92_x_cal->GetCharge();

									FE92_X_I_C[0][l][m] = FE92_X_I[0][l][m];
									FE92_X_I_C[1][l][m] = FE92_X_I[1][l][m];
									FE92_X_I_C[2][l][m] = FE92_X_I[2][l][m] * (FE92_X_factor / list_SRPPAC_gain[1][1][int(FE92_X_I[0][l][m])]);
								}
							}
						}

						if (FE92_X_I[0][0][m] == -1000000)
						{
							FE92_XA_E_Counter = FE92_XA_E_Counter + 1;
							FE92_X_I[0][0][m] = p_FE92_x_cal->GetID();
							FE92_X_I[1][0][m] = p_FE92_x_cal->GetTiming();
							FE92_X_I[2][0][m] = p_FE92_x_cal->GetCharge();

							FE92_X_I_C[0][0][m] = FE92_X_I[0][0][m];
							FE92_X_I_C[1][0][m] = FE92_X_I[1][0][m];
							FE92_X_I_C[2][0][m] = FE92_X_I[2][0][m] * (FE92_X_factor / list_SRPPAC_gain[1][1][int(FE92_X_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE92_X_I_C);

		// cout << "FE92 X OK" << endl;

		double FE92_Y_T_dummy;
		if (array_FE92_y_cal->GetEntries() > 0)
		{
			FE92_Y_E_Counter = FE92_Y_E_Counter + 1;
			for (int k = 0; k < array_FE92_y_cal->GetEntries() && k < 50; k++)
			{
				FE92_Y_Counter = FE92_Y_Counter + 1;
				p_FE92_y_cal = (TTimingChargePositionData *)array_FE92_y_cal->At(k);
				FE92_Y_T_dummy = p_FE92_y_cal->GetTiming();

				for (int m = 0; m < array_FE92_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE92Y_F3->Fill(FE92_Y_T_dummy - F3_T[m]);
					if (FE92_Y_T_dummy - F3_T[m] > 1030 && FE92_Y_T_dummy - F3_T[m] < 1110)
					{
						if (FE92_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE92_Y_I[0][l - 1][m] != -1000000 && FE92_Y_I[0][l][m] == -1000000 && FE92_Y_I[1][l - 1][m] != p_FE92_y_cal->GetTiming())
								{
									FE92_YA_Counter = FE92_YA_Counter + 1;
									FE92_Y_I[0][l][m] = p_FE92_y_cal->GetID();
									FE92_Y_I[1][l][m] = p_FE92_y_cal->GetTiming();
									FE92_Y_I[2][l][m] = p_FE92_y_cal->GetCharge();

									FE92_Y_I_C[0][l][m] = FE92_Y_I[0][l][m];
									FE92_Y_I_C[1][l][m] = FE92_Y_I[1][l][m];
									FE92_Y_I_C[2][l][m] = FE92_Y_I[2][l][m] * (FE92_Y_factor / list_SRPPAC_gain[0][1][int(FE92_Y_I[0][l][m])]);
								}
							}
						}

						if (FE92_Y_I[0][0][m] == -1000000)
						{
							FE92_YA_E_Counter = FE92_YA_E_Counter + 1;
							FE92_Y_I[0][0][m] = p_FE92_y_cal->GetID();
							FE92_Y_I[1][0][m] = p_FE92_y_cal->GetTiming();
							FE92_Y_I[2][0][m] = p_FE92_y_cal->GetCharge();

							FE92_Y_I_C[0][0][m] = FE92_Y_I[0][0][m];
							FE92_Y_I_C[1][0][m] = FE92_Y_I[1][0][m];
							FE92_Y_I_C[2][0][m] = FE92_Y_I[2][0][m] * (FE92_Y_factor / list_SRPPAC_gain[0][1][int(FE92_Y_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE92_Y_I_C);

		// cout << "FE92 Y OK" << endl;

		for (int k = 0; k < array_FE92_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE92_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE92_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE92_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE92_X_I_C[0][0][m] - FE92_Y_I_C[0][0][l]) < 50)
						{
							FE92_XY_Counter = FE92_XY_Counter + 1;
							FE92_X_I_C2[0][k][m] = FE92_X_I_C[0][k][m];
							FE92_X_I_C2[1][k][m] = FE92_X_I_C[1][k][m];
							FE92_X_I_C2[2][k][m] = FE92_X_I_C[2][k][m] * (FE92_X_factor / list_SRPPAC_gain2[1][int(FE92_Y_I_C[0][0][l] / 4)][1][int(FE92_X_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE92_X_I_C2);

		// cout << "FE92 X_C2 OK" << endl;

		for (int k = 0; k < array_FE92_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE92_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE92_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE92_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE92_Y_I_C[0][0][m] - FE92_X_I_C[0][0][l]) < 50)
						{
							FE92_YX_Counter = FE92_YX_Counter + 1;
							FE92_Y_I_C2[0][k][m] = FE92_Y_I_C[0][k][m];
							FE92_Y_I_C2[1][k][m] = FE92_Y_I_C[1][k][m];
							FE92_Y_I_C2[2][k][m] = FE92_Y_I_C[2][k][m] * (FE92_Y_factor / list_SRPPAC_gain2[0][int(FE92_X_I_C[0][0][l] / 6)][1][int(FE92_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE92_Y_I_C2);

		// cout << "FE92 Y_C2 OK" << endl;

		for (int m = 0; m < array_FE92_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_X_I_C2[2][1][m] > 0 && abs(FE92_X_I_C2[0][0][m] - FE92_X_I_C2[0][1][m]) == 1)
			{
				h_FE92_h_Q0_Q1->Fill(FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]);
				h_FE92_h_Q0_Q1_S[int(FE92_X_I_C2[0][0][m])][int(FE92_X_I_C2[0][1][m])]->Fill(FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]);

				FE92_X_Q_Counter = FE92_X_Q_Counter + 1;
				double FE92_X_up = 0.;
				double FE92_X_down = 0.;
				double FE92_X_up_C = 0.;
				double FE92_X_down_C = 0.;
				double FE92_X_up_C2 = 0.;
				double FE92_X_down_C2 = 0.;
				for (int k = 0; k < array_FE92_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_X_I[2][k][m]))
						continue;
					FE92_X_up = FE92_X_up + FE92_X_I[0][k][m] * FE92_X_I[2][k][m];
					FE92_X_down = FE92_X_down + FE92_X_I[2][k][m];
				}
				for (int k = 0; k < array_FE92_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_X_I_C[2][k][m]))
						continue;
					FE92_X_up_C = FE92_X_up_C + FE92_X_I_C[0][k][m] * FE92_X_I_C[2][k][m];
					FE92_X_down_C = FE92_X_down_C + FE92_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE92_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_X_I_C2[2][k][m]))
						continue;
					FE92_X_up_C2 = FE92_X_up_C2 + FE92_X_I_C2[0][k][m] * FE92_X_I_C2[2][k][m];
					FE92_X_down_C2 = FE92_X_down_C2 + FE92_X_I_C2[2][k][m];
				}

				FE92_X[m] = -((FE92_X_up / FE92_X_down) * (240. / 94.) + 2.55 / 2. - 120);
				FE92_X_C[m] = -((FE92_X_up_C / FE92_X_down_C) * (240. / 94.) + 2.55 / 2. - 120);
				FE92_X_C2[m] = -((FE92_X_up_C2 / FE92_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120);

				if (FE92_X_I_C2[0][0][m] > FE92_X_I_C2[0][1][m])
				{
					FE92_X_M[m] = -((FE92_X_I_C2[0][0][m] - (1 - h_FE92_h_Q0_Q1_F->GetBinContent(int((FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE92_X_I_C2[0][0][m] < FE92_X_I_C2[0][1][m])
				{
					FE92_X_M[m] = -((FE92_X_I_C2[0][0][m] + (1 - h_FE92_h_Q0_Q1_F->GetBinContent(int((FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE92_X_I_C2[0][0][m] > FE92_X_I_C2[0][1][m])
				{
					FE92_X_M2[m] = -((FE92_X_I_C2[0][0][m] - (1 - h_FE92_h_Q0_Q1_S_F[int(FE92_X_I_C2[0][0][m])][int(FE92_X_I_C2[0][1][m])]->GetBinContent(int((FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (FE92_X_I_C2[0][0][m] < FE92_X_I_C2[0][1][m])
				{
					FE92_X_M2[m] = -((FE92_X_I_C2[0][0][m] + (1 - h_FE92_h_Q0_Q1_S_F[int(FE92_X_I_C2[0][0][m])][int(FE92_X_I_C2[0][1][m])]->GetBinContent(int((FE92_X_I_C2[2][0][m] - FE92_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}
			}
		}

		// cout << "FE92 X_M2 OK" << endl;

		for (int m = 0; m < array_FE92_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_Y_I_C2[2][1][m] > 0 && abs(FE92_Y_I_C2[0][0][m] - FE92_Y_I_C2[0][1][m]) == 1)
			{
				h_FE92_v_Q0_Q1->Fill(FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]);
				h_FE92_v_Q0_Q1_S[int(FE92_Y_I_C2[0][0][m])][int(FE92_Y_I_C2[0][1][m])]->Fill(FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]);

				FE92_Y_Q_Counter = FE92_Y_Q_Counter + 1;
				double FE92_Y_up = 0.;
				double FE92_Y_down = 0.;
				double FE92_Y_up_C = 0.;
				double FE92_Y_down_C = 0.;
				double FE92_Y_up_C2 = 0.;
				double FE92_Y_down_C2 = 0.;
				for (int k = 0; k < array_FE92_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_Y_I[2][k][m]))
						continue;
					FE92_Y_up = FE92_Y_up + FE92_Y_I[0][k][m] * FE92_Y_I[2][k][m];
					FE92_Y_down = FE92_Y_down + FE92_Y_I[2][k][m];
				}
				for (int k = 0; k < array_FE92_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_Y_I_C[2][k][m]))
						continue;
					FE92_Y_up_C = FE92_Y_up_C + FE92_Y_I_C[0][k][m] * FE92_Y_I_C[2][k][m];
					FE92_Y_down_C = FE92_Y_down_C + FE92_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE92_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE92_Y_I_C2[2][k][m]))
						continue;
					FE92_Y_up_C2 = FE92_Y_up_C2 + FE92_Y_I_C2[0][k][m] * FE92_Y_I_C2[2][k][m];
					FE92_Y_down_C2 = FE92_Y_down_C2 + FE92_Y_I_C2[2][k][m];
				}

				FE92_Y[m] = -((FE92_Y_up / FE92_Y_down) * (150. / 58.) + 2.58 / 2. - 75);
				FE92_Y_C[m] = -((FE92_Y_up_C / FE92_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75);
				FE92_Y_C2[m] = -((FE92_Y_up_C2 / FE92_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75);

				if (FE92_Y_I_C2[0][0][m] > FE92_Y_I_C2[0][1][m])
				{
					FE92_Y_M[m] = -((FE92_Y_I_C2[0][0][m] - (1 - h_FE92_v_Q0_Q1_F->GetBinContent(int((FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE92_Y_I_C2[0][0][m] < FE92_Y_I_C2[0][1][m])
				{
					FE92_Y_M[m] = -((FE92_Y_I_C2[0][0][m] + (1 - h_FE92_v_Q0_Q1_F->GetBinContent(int((FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE92_Y_I_C2[0][0][m] > FE92_Y_I_C2[0][1][m])
				{
					FE92_Y_M2[m] = -((FE92_Y_I_C2[0][0][m] - (1 - h_FE92_v_Q0_Q1_S_F[int(FE92_Y_I_C2[0][0][m])][int(FE92_Y_I_C2[0][1][m])]->GetBinContent(int((FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (FE92_Y_I_C2[0][0][m] < FE92_Y_I_C2[0][1][m])
				{
					FE92_Y_M2[m] = -((FE92_Y_I_C2[0][0][m] + (1 - h_FE92_v_Q0_Q1_S_F[int(FE92_Y_I_C2[0][0][m])][int(FE92_Y_I_C2[0][1][m])]->GetBinContent(int((FE92_Y_I_C2[2][0][m] - FE92_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}
			}
		}

		// cout << "FE92 Y_M2 OK" << endl;

		for (int m = 0; m < SRPPAC_max_ion; m++)
		{
			if (PID_T[m] > 0)
			{

				FE9_X[m] = (542.25 * FE91_X[m] - 122.5 * FE92_X[m]) / 419.75;
				FE9_X_C[m] = (542.25 * FE91_X_C[m] - 122.5 * FE92_X_C[m]) / 419.75;
				FE9_X_C2[m] = (542.25 * FE91_X_C2[m] - 122.5 * FE92_X_C2[m]) / 419.75;
				FE9_X_M[m] = (542.25 * FE91_X_M[m] - 122.5 * FE92_X_M[m]) / 419.75;
				FE9_X_M2[m] = (542.25 * FE91_X_M2[m] - 122.5 * FE92_X_M2[m]) / 419.75;

				FE9_Y[m] = (542.25 * FE91_Y[m] - 122.5 * FE92_Y[m]) / 419.75;
				FE9_Y_C[m] = (542.25 * FE91_Y_C[m] - 122.5 * FE92_Y_C[m]) / 419.75;
				FE9_Y_C2[m] = (542.25 * FE91_Y_C2[m] - 122.5 * FE92_Y_C2[m]) / 419.75;
				FE9_Y_M[m] = (542.25 * FE91_Y_M[m] - 122.5 * FE92_Y_M[m]) / 419.75;
				FE9_Y_M2[m] = (542.25 * FE91_Y_M2[m] - 122.5 * FE92_Y_M2[m]) / 419.75;

				FE9_A[m] = atan((FE92_X[m] - FE91_X[m]) / FE9_Z);
				FE9_A_C[m] = atan((FE92_X_C[m] - FE91_X_C[m]) / FE9_Z);
				FE9_A_C2[m] = atan((FE92_X_C2[m] - FE91_X_C2[m]) / FE9_Z);
				FE9_A_M[m] = atan((FE92_X_M[m] - FE91_X_M[m]) / FE9_Z);
				FE9_A_M2[m] = atan((FE92_X_M2[m] - FE91_X_M2[m]) / FE9_Z);

				FE9_B[m] = atan((FE92_Y[m] - FE91_Y[m]) / FE9_Z);
				FE9_B_C[m] = atan((FE92_Y_C[m] - FE91_Y_C[m]) / FE9_Z);
				FE9_B_C2[m] = atan((FE92_Y_C2[m] - FE91_Y_C2[m]) / FE9_Z);
				FE9_B_M[m] = atan((FE92_Y_M[m] - FE91_Y_M[m]) / FE9_Z);
				FE9_B_M2[m] = atan((FE92_Y_M2[m] - FE91_Y_M2[m]) / FE9_Z);
			}
		}

		// cout << "FE9 OK" << endl;

		/*****************************************
		   2.- Position and energy of interacion
		 *****************************************/

		// cout << endl;
		// cout << "FE12" << endl;
		// cout << endl;

		// From the time provided by the FE9 and FE12 SRPPACs anodes we obtain the FE9-FE12 ToF of the ions.

		if (array_FE121_t->GetEntries() > 0)
		{
			FE121_A_E_Counter = FE121_A_E_Counter + 1;
			for (int k = 0; k < array_FE121_t->GetEntries() && k < SRPPAC_max_ion; k++)
			{
				FE121_A_Counter = FE121_A_Counter + 1;
				p_FE121_t = (TTimingChargePositionData *)array_FE121_t->At(k);
				FE121_T_I[k] = p_FE121_t->GetTiming();
			}
		}

		if (array_FE122_t->GetEntries() > 0)
		{
			FE122_A_E_Counter = FE122_A_E_Counter + 1;
			for (int k = 0; k < array_FE122_t->GetEntries() && k < SRPPAC_max_ion; k++)
			{
				FE122_A_Counter = FE122_A_Counter + 1;
				p_FE122_t = (TTimingChargePositionData *)array_FE122_t->At(k);
				FE122_T_I[k] = p_FE122_t->GetTiming();
			}
		}

		double FE12_T_dummy;
		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				h_T_FE12A->Fill(FE122_T_I[j] - FE121_T_I[k]);
				if (FE122_T_I[j] - FE121_T_I[k] > -15. && FE122_T_I[j] - FE121_T_I[k] < 15. && FE122_T_I[j] != -1000000 && FE121_T_I[k] != -1000000)
				{
					FE12_A_Counter = FE12_A_Counter + 1;
					FE12_T_dummy = (FE122_T_I[j] + FE121_T_I[k]) / 2.;
					FE12_T_I[j] = FE12_T_dummy;
					// cout << FE12_T_dummy  << endl;
				}
			}
		}

		double betaFE12_dummy;
		double FE12_E_dummy;
		double Beam_T_dummy;
		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				h_T_FE12A_F3->Fill(FE12_T_I[j] - F3_T[k]);
				if (FE12_T_I[j] - F3_T[k] > 1900. && FE12_T_I[j] - F3_T[k] < 2200.)
				{
					F3_FE12_A_Counter = F3_FE12_A_Counter + 1;
					// Beam_T_dummy = FE12_T_I[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_dummy = FE12_T_I[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T[k] = Beam_T_dummy;
					// cout << Beam_T[k] << endl;

					FE12_E_dummy = calculateBeamEnergy(Beam_T[k] + 19.23, distance_FE9_FE12); // +19.23 ns is the TOF offset for 2024 Beam_T_0
					FE12_E[k] = FE12_E_dummy;

					betaFE12_dummy = calculateBeta(Beam_T[k] + 19.23, distance_FE9_FE12); // +19.23 ns is the TOF offset for 2024 Beam_T_0
					betaFE12[k] = betaFE12_dummy;
				}
			}
		}

		// We calculate the position at FE9 of the F3-FE9 ions.
		double FE121_X_T_dummy;
		if (array_FE121_x_cal->GetEntries() > 0)
		{
			FE121_X_E_Counter = FE121_X_E_Counter + 1;
			for (int k = 0; k < array_FE121_x_cal->GetEntries() && k < 50; k++)
			{
				FE121_X_Counter = FE121_X_Counter + 1;
				p_FE121_x_cal = (TTimingChargePositionData *)array_FE121_x_cal->At(k);
				FE121_X_T_dummy = p_FE121_x_cal->GetTiming();

				for (int m = 0; m < array_FE121_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE121X_F3->Fill(FE121_X_T_dummy - F3_T[m]);
					if (FE121_X_T_dummy - F3_T[m] > 1900 && FE121_X_T_dummy - F3_T[m] < 2200)
					{
						if (FE121_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE121_X_I[0][l - 1][m] != -1000000 && FE121_X_I[0][l][m] == -1000000 && FE121_X_I[1][l - 1][m] != p_FE121_x_cal->GetTiming())
								{
									FE121_XA_Counter = FE121_XA_Counter + 1;
									FE121_X_I[0][l][m] = p_FE121_x_cal->GetID();
									FE121_X_I[1][l][m] = p_FE121_x_cal->GetTiming();
									FE121_X_I[2][l][m] = p_FE121_x_cal->GetCharge();

									FE121_X_I_C[0][l][m] = FE121_X_I[0][l][m];
									FE121_X_I_C[1][l][m] = FE121_X_I[1][l][m];
									FE121_X_I_C[2][l][m] = FE121_X_I[2][l][m] * (FE121_X_factor / list_SRPPAC_gain[1][2][int(FE121_X_I[0][l][m])]);
								}
							}
						}

						if (FE121_X_I[0][0][m] == -1000000)
						{
							FE121_XA_E_Counter = FE121_XA_E_Counter + 1;
							FE121_X_I[0][0][m] = p_FE121_x_cal->GetID();
							FE121_X_I[1][0][m] = p_FE121_x_cal->GetTiming();
							FE121_X_I[2][0][m] = p_FE121_x_cal->GetCharge();

							FE121_X_I_C[0][0][m] = FE121_X_I[0][0][m];
							FE121_X_I_C[1][0][m] = FE121_X_I[1][0][m];
							FE121_X_I_C[2][0][m] = FE121_X_I[2][0][m] * (FE121_X_factor / list_SRPPAC_gain[1][2][int(FE121_X_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE121_X_I_C);

		double FE121_Y_T_dummy;
		if (array_FE121_y_cal->GetEntries() > 0)
		{
			FE121_Y_E_Counter = FE121_Y_E_Counter + 1;
			for (int k = 0; k < array_FE121_y_cal->GetEntries() && k < 50; k++)
			{
				FE121_Y_Counter = FE121_Y_Counter + 1;
				p_FE121_y_cal = (TTimingChargePositionData *)array_FE121_y_cal->At(k);
				FE121_Y_T_dummy = p_FE121_y_cal->GetTiming();

				for (int m = 0; m < array_FE121_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE121Y_F3->Fill(FE121_Y_T_dummy - F3_T[m]);
					if (FE121_Y_T_dummy - F3_T[m] > 1900 && FE121_Y_T_dummy - F3_T[m] < 2200)
					{
						if (FE121_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE121_Y_I[0][l - 1][m] != -1000000 && FE121_Y_I[0][l][m] == -1000000 && FE121_Y_I[1][l - 1][m] != p_FE121_y_cal->GetTiming())
								{
									FE121_YA_Counter = FE121_YA_Counter + 1;
									FE121_Y_I[0][l][m] = p_FE121_y_cal->GetID();
									FE121_Y_I[1][l][m] = p_FE121_y_cal->GetTiming();
									FE121_Y_I[2][l][m] = p_FE121_y_cal->GetCharge();

									FE121_Y_I_C[0][l][m] = FE121_Y_I[0][l][m];
									FE121_Y_I_C[1][l][m] = FE121_Y_I[1][l][m];
									FE121_Y_I_C[2][l][m] = FE121_Y_I[2][l][m] * (FE121_Y_factor / list_SRPPAC_gain[0][2][int(FE121_Y_I[0][l][m])]);
								}
							}
						}

						if (FE121_Y_I[0][0][m] == -1000000)
						{
							FE121_YA_E_Counter = FE121_YA_E_Counter + 1;
							FE121_Y_I[0][0][m] = p_FE121_y_cal->GetID();
							FE121_Y_I[1][0][m] = p_FE121_y_cal->GetTiming();
							FE121_Y_I[2][0][m] = p_FE121_y_cal->GetCharge();

							FE121_Y_I_C[0][0][m] = FE121_Y_I[0][0][m];
							FE121_Y_I_C[1][0][m] = FE121_Y_I[1][0][m];
							FE121_Y_I_C[2][0][m] = FE121_Y_I[2][0][m] * (FE121_Y_factor / list_SRPPAC_gain[0][2][int(FE121_Y_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE121_Y_I_C);

		for (int k = 0; k < array_FE121_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE121_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE121_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE121_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE121_X_I_C[0][0][m] - FE121_Y_I_C[0][0][l]) < 90)
						{
							FE121_XY_Counter = FE121_XY_Counter + 1;
							FE121_X_I_C2[0][k][m] = FE121_X_I_C[0][k][m];
							FE121_X_I_C2[1][k][m] = FE121_X_I_C[1][k][m];
							FE121_X_I_C2[2][k][m] = FE121_X_I_C[2][k][m] * (FE121_X_factor / list_SRPPAC_gain2[1][int(FE121_Y_I_C[0][0][l] / 4)][2][int(FE121_X_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE121_X_I_C2);

		for (int k = 0; k < array_FE121_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE121_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE121_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE121_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE121_Y_I_C[0][0][m] - FE121_X_I_C[0][0][l]) < 90)
						{
							FE121_YX_Counter = FE121_YX_Counter + 1;
							FE121_Y_I_C2[0][k][m] = FE121_Y_I_C[0][k][m];
							FE121_Y_I_C2[1][k][m] = FE121_Y_I_C[1][k][m];
							FE121_Y_I_C2[2][k][m] = FE121_Y_I_C[2][k][m] * (FE121_Y_factor / list_SRPPAC_gain2[0][int(FE121_X_I_C[0][0][l] / 6)][2][int(FE121_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE121_Y_I_C2);

		for (int m = 0; m < array_FE121_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_X_I_C2[2][1][m] > 0 && abs(FE121_X_I_C2[0][0][m] - FE121_X_I_C2[0][1][m]) == 1)
			{
				h_FE121_h_Q0_Q1->Fill(FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]);
				h_FE121_h_Q0_Q1_S[int(FE121_X_I_C2[0][0][m])][int(FE121_X_I_C2[0][1][m])]->Fill(FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]);

				FE121_X_Q_Counter = FE121_X_Q_Counter + 1;
				double FE121_X_up = 0.;
				double FE121_X_down = 0.;
				double FE121_X_up_C = 0.;
				double FE121_X_down_C = 0.;
				double FE121_X_up_C2 = 0.;
				double FE121_X_down_C2 = 0.;
				for (int k = 0; k < array_FE121_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_X_I[2][k][m]))
						continue;
					FE121_X_up = FE121_X_up + FE121_X_I[0][k][m] * FE121_X_I[2][k][m];
					FE121_X_down = FE121_X_down + FE121_X_I[2][k][m];
				}
				for (int k = 0; k < array_FE121_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_X_I_C[2][k][m]))
						continue;
					FE121_X_up_C = FE121_X_up_C + FE121_X_I_C[0][k][m] * FE121_X_I_C[2][k][m];
					FE121_X_down_C = FE121_X_down_C + FE121_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE121_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_X_I_C2[2][k][m]))
						continue;
					FE121_X_up_C2 = FE121_X_up_C2 + FE121_X_I_C2[0][k][m] * FE121_X_I_C2[2][k][m];
					FE121_X_down_C2 = FE121_X_down_C2 + FE121_X_I_C2[2][k][m];
				}

				FE121_X[m] = -((FE121_X_up / FE121_X_down) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				FE121_X_C[m] = -((FE121_X_up_C / FE121_X_down_C) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				FE121_X_C2[m] = -((FE121_X_up_C2 / FE121_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120) + 50;

				if (FE121_X_I_C2[0][0][m] > FE121_X_I_C2[0][1][m])
				{
					FE121_X_M[m] = -((FE121_X_I_C2[0][0][m] - (1 - h_FE121_h_Q0_Q1_F->GetBinContent(int((FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE121_X_I_C2[0][0][m] < FE121_X_I_C2[0][1][m])
				{
					FE121_X_M[m] = -((FE121_X_I_C2[0][0][m] + (1 - h_FE121_h_Q0_Q1_F->GetBinContent(int((FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE121_X_I_C2[0][0][m] > FE121_X_I_C2[0][1][m])
				{
					FE121_X_M2[m] = -((FE121_X_I_C2[0][0][m] - (1 - h_FE121_h_Q0_Q1_S_F[int(FE121_X_I_C2[0][0][m])][int(FE121_X_I_C2[0][1][m])]->GetBinContent(int((FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE121_X_I_C2[0][0][m] < FE121_X_I_C2[0][1][m])
				{
					FE121_X_M2[m] = -((FE121_X_I_C2[0][0][m] + (1 - h_FE121_h_Q0_Q1_S_F[int(FE121_X_I_C2[0][0][m])][int(FE121_X_I_C2[0][1][m])]->GetBinContent(int((FE121_X_I_C2[2][0][m] - FE121_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}
			}
		}

		for (int m = 0; m < array_FE121_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_Y_I_C2[2][1][m] > 0 && abs(FE121_Y_I_C2[0][0][m] - FE121_Y_I_C2[0][1][m]) == 1)
			{
				h_FE121_v_Q0_Q1->Fill(FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]);
				h_FE121_v_Q0_Q1_S[int(FE121_Y_I_C2[0][0][m])][int(FE121_Y_I_C2[0][1][m])]->Fill(FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]);

				FE121_Y_Q_Counter = FE121_Y_Q_Counter + 1;
				double FE121_Y_up = 0.;
				double FE121_Y_down = 0.;
				double FE121_Y_up_C = 0.;
				double FE121_Y_down_C = 0.;
				double FE121_Y_up_C2 = 0.;
				double FE121_Y_down_C2 = 0.;
				for (int k = 0; k < array_FE121_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_Y_I[2][k][m]))
						continue;
					FE121_Y_up = FE121_Y_up + FE121_Y_I[0][k][m] * FE121_Y_I[2][k][m];
					FE121_Y_down = FE121_Y_down + FE121_Y_I[2][k][m];
				}
				for (int k = 0; k < array_FE121_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_Y_I_C[2][k][m]))
						continue;
					FE121_Y_up_C = FE121_Y_up_C + FE121_Y_I_C[0][k][m] * FE121_Y_I_C[2][k][m];
					FE121_Y_down_C = FE121_Y_down_C + FE121_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE121_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE121_Y_I_C2[2][k][m]))
						continue;
					FE121_Y_up_C2 = FE121_Y_up_C2 + FE121_Y_I_C2[0][k][m] * FE121_Y_I_C2[2][k][m];
					FE121_Y_down_C2 = FE121_Y_down_C2 + FE121_Y_I_C2[2][k][m];
				}

				FE121_Y[m] = -((FE121_Y_up / FE121_Y_down) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				FE121_Y_C[m] = -((FE121_Y_up_C / FE121_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				FE121_Y_C2[m] = -((FE121_Y_up_C2 / FE121_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75) - 30;

				if (FE121_Y_I_C2[0][0][m] > FE121_Y_I_C2[0][1][m])
				{
					FE121_Y_M[m] = -((FE121_Y_I_C2[0][0][m] - (1 - h_FE121_v_Q0_Q1_F->GetBinContent(int((FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE121_Y_I_C2[0][0][m] < FE121_Y_I_C2[0][1][m])
				{
					FE121_Y_M[m] = -((FE121_Y_I_C2[0][0][m] + (1 - h_FE121_v_Q0_Q1_F->GetBinContent(int((FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE121_Y_I_C2[0][0][m] > FE121_Y_I_C2[0][1][m])
				{
					FE121_Y_M2[m] = -((FE121_Y_I_C2[0][0][m] - (1 - h_FE121_v_Q0_Q1_S_F[int(FE121_Y_I_C2[0][0][m])][int(FE121_Y_I_C2[0][1][m])]->GetBinContent(int((FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE121_Y_I_C2[0][0][m] < FE121_Y_I_C2[0][1][m])
				{
					FE121_Y_M2[m] = -((FE121_Y_I_C2[0][0][m] + (1 - h_FE121_v_Q0_Q1_S_F[int(FE121_Y_I_C2[0][0][m])][int(FE121_Y_I_C2[0][1][m])]->GetBinContent(int((FE121_Y_I_C2[2][0][m] - FE121_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}
			}
		}

		double FE122_X_T_dummy;
		if (array_FE122_x_cal->GetEntries() > 0)
		{
			FE122_X_E_Counter = FE122_X_E_Counter + 1;
			for (int k = 0; k < array_FE122_x_cal->GetEntries() && k < 50; k++)
			{
				FE122_X_Counter = FE122_X_Counter + 1;
				p_FE122_x_cal = (TTimingChargePositionData *)array_FE122_x_cal->At(k);
				FE122_X_T_dummy = p_FE122_x_cal->GetTiming();

				for (int m = 0; m < array_FE122_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE122X_F3->Fill(FE122_X_T_dummy - F3_T[m]);
					if (FE122_X_T_dummy - F3_T[m] > 1900 && FE122_X_T_dummy - F3_T[m] < 2200)
					{
						if (FE122_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE122_X_I[0][l - 1][m] != -1000000 && FE122_X_I[0][l][m] == -1000000 && FE122_X_I[1][l - 1][m] != p_FE122_x_cal->GetTiming())
								{
									FE122_XA_Counter = FE122_XA_Counter + 1;
									FE122_X_I[0][l][m] = p_FE122_x_cal->GetID();
									FE122_X_I[1][l][m] = p_FE122_x_cal->GetTiming();
									FE122_X_I[2][l][m] = p_FE122_x_cal->GetCharge();

									FE122_X_I_C[0][l][m] = FE122_X_I[0][l][m];
									FE122_X_I_C[1][l][m] = FE122_X_I[1][l][m];
									FE122_X_I_C[2][l][m] = FE122_X_I[2][l][m] * (FE122_X_factor / list_SRPPAC_gain[1][3][int(FE122_X_I[0][l][m])]);
								}
							}
						}

						if (FE122_X_I[0][0][m] == -1000000)
						{
							FE122_XA_E_Counter = FE122_XA_E_Counter + 1;
							FE122_X_I[0][0][m] = p_FE122_x_cal->GetID();
							FE122_X_I[1][0][m] = p_FE122_x_cal->GetTiming();
							FE122_X_I[2][0][m] = p_FE122_x_cal->GetCharge();

							FE122_X_I_C[0][0][m] = FE122_X_I[0][0][m];
							FE122_X_I_C[1][0][m] = FE122_X_I[1][0][m];
							FE122_X_I_C[2][0][m] = FE122_X_I[2][0][m] * (FE122_X_factor / list_SRPPAC_gain[1][3][int(FE122_X_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE122_X_I_C);

		double FE122_Y_T_dummy;
		if (array_FE122_y_cal->GetEntries() > 0)
		{
			FE122_Y_E_Counter = FE122_Y_E_Counter + 1;
			for (int k = 0; k < array_FE122_y_cal->GetEntries() && k < 50; k++)
			{
				FE122_Y_Counter = FE122_Y_Counter + 1;
				p_FE122_y_cal = (TTimingChargePositionData *)array_FE122_y_cal->At(k);
				FE122_Y_T_dummy = p_FE122_y_cal->GetTiming();

				for (int m = 0; m < array_FE122_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_FE122Y_F3->Fill(FE122_Y_T_dummy - F3_T[m]);
					if (FE122_Y_T_dummy - F3_T[m] > 1900 && FE122_Y_T_dummy - F3_T[m] < 2200)
					{
						if (FE122_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (FE122_Y_I[0][l - 1][m] != -1000000 && FE122_Y_I[0][l][m] == -1000000 && FE122_Y_I[1][l - 1][m] != p_FE122_y_cal->GetTiming())
								{
									FE122_YA_Counter = FE122_YA_Counter + 1;
									FE122_Y_I[0][l][m] = p_FE122_y_cal->GetID();
									FE122_Y_I[1][l][m] = p_FE122_y_cal->GetTiming();
									FE122_Y_I[2][l][m] = p_FE122_y_cal->GetCharge();

									FE122_Y_I_C[0][l][m] = FE122_Y_I[0][l][m];
									FE122_Y_I_C[1][l][m] = FE122_Y_I[1][l][m];
									FE122_Y_I_C[2][l][m] = FE122_Y_I[2][l][m] * (FE122_Y_factor / list_SRPPAC_gain[0][3][int(FE122_Y_I[0][l][m])]);
								}
							}
						}

						if (FE122_Y_I[0][0][m] == -1000000)
						{
							FE122_YA_E_Counter = FE122_YA_E_Counter + 1;
							FE122_Y_I[0][0][m] = p_FE122_y_cal->GetID();
							FE122_Y_I[1][0][m] = p_FE122_y_cal->GetTiming();
							FE122_Y_I[2][0][m] = p_FE122_y_cal->GetCharge();

							FE122_Y_I_C[0][0][m] = FE122_Y_I[0][0][m];
							FE122_Y_I_C[1][0][m] = FE122_Y_I[1][0][m];
							FE122_Y_I_C[2][0][m] = FE122_Y_I[2][0][m] * (FE122_Y_factor / list_SRPPAC_gain[0][3][int(FE122_Y_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(FE122_Y_I_C);

		for (int k = 0; k < array_FE122_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE122_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE122_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE122_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE122_X_I_C[0][0][m] - FE122_Y_I_C[0][0][l]) < 90)
						{
							FE122_XY_Counter = FE122_XY_Counter + 1;
							FE122_X_I_C2[0][k][m] = FE122_X_I_C[0][k][m];
							FE122_X_I_C2[1][k][m] = FE122_X_I_C[1][k][m];
							FE122_X_I_C2[2][k][m] = FE122_X_I_C[2][k][m] * (FE122_X_factor / list_SRPPAC_gain2[1][int(FE122_Y_I_C[0][0][l] / 4)][3][int(FE122_X_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE122_X_I_C2);

		for (int k = 0; k < array_FE122_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_FE122_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (FE122_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_FE122_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(FE122_Y_I_C[0][0][m] - FE122_X_I_C[0][0][l]) < 90)
						{
							FE122_YX_Counter = FE122_YX_Counter + 1;
							FE122_Y_I_C2[0][k][m] = FE122_Y_I_C[0][k][m];
							FE122_Y_I_C2[1][k][m] = FE122_Y_I_C[1][k][m];
							FE122_Y_I_C2[2][k][m] = FE122_Y_I_C[2][k][m] * (FE122_Y_factor / list_SRPPAC_gain2[0][int(FE122_X_I_C[0][0][l] / 6)][3][int(FE122_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(FE122_Y_I_C2);

		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				if (FE122_T_I[j] - FE121_T_I[k] > -15. && FE122_T_I[j] - FE121_T_I[k] < 15. && FE122_T_I[j] != -1000000 && FE121_T_I[k] != -1000000)
				{
					FE12_T_dummy = (FE122_X_I_C2[1][0][j] + FE121_X_I_C2[1][0][k]) / 2.;
					FE12_T_I_1[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_Y_I_C2[1][0][j] + FE121_X_I_C2[1][0][k]) / 2.;
					FE12_T_I_2[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_T_I[j] + FE121_X_I_C2[1][0][k]) / 2.;
					FE12_T_I_3[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_X_I_C2[1][0][j] + FE121_Y_I_C2[1][0][k]) / 2.;
					FE12_T_I_4[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_Y_I_C2[1][0][j] + FE121_Y_I_C2[1][0][k]) / 2.;
					FE12_T_I_5[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_T_I[j] + FE121_Y_I_C2[1][0][k]) / 2.;
					FE12_T_I_6[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_X_I_C2[1][0][j] + FE121_T_I[k]) / 2.;
					FE12_T_I_7[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_Y_I_C2[1][0][j] + FE121_T_I[k]) / 2.;
					FE12_T_I_8[j] = FE12_T_dummy;
					FE12_T_dummy = (FE122_T_I[j] + FE121_T_I[k]) / 2.;
					FE12_T_I_9[j] = FE12_T_dummy;
				}
			}
		}

		for (int j = 0; j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < SRPPAC_max_ion; k++)
			{
				if (FE12_T_I[j] - F3_T[k] > 1900. && FE12_T_I[j] - F3_T[k] < 2200.)
				{
					Beam_T_dummy = FE12_T_I_1[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_1[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_2[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_2[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_3[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_3[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_4[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_4[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_5[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_5[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_6[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_6[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_7[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_7[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_8[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_8[k] = Beam_T_dummy;
					Beam_T_dummy = FE12_T_I_9[j] - PID_T[k] - F3_T[k] - 715.279;
					Beam_T_9[k] = Beam_T_dummy;
					// cout << Beam_T[k] << endl;
				}
			}
		}

		for (int m = 0; m < array_FE122_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_X_I_C2[2][1][m] > 0 && abs(FE122_X_I_C2[0][0][m] - FE122_X_I_C2[0][1][m]) == 1)
			{
				h_FE122_h_Q0_Q1->Fill(FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]);
				h_FE122_h_Q0_Q1_S[int(FE122_X_I_C2[0][0][m])][int(FE122_X_I_C2[0][1][m])]->Fill(FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]);

				FE122_X_Q_Counter = FE122_X_Q_Counter + 1;
				double FE122_X_up = 0.;
				double FE122_X_down = 0.;
				double FE122_X_up_C = 0.;
				double FE122_X_down_C = 0.;
				double FE122_X_up_C2 = 0.;
				double FE122_X_down_C2 = 0.;
				for (int k = 0; k < array_FE122_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_X_I[2][k][m]))
						continue;
					FE122_X_up = FE122_X_up + FE122_X_I[0][k][m] * FE122_X_I[2][k][m];
					FE122_X_down = FE122_X_down + FE122_X_I[2][k][m];
				}
				for (int k = 0; k < array_FE122_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_X_I_C[2][k][m]))
						continue;
					FE122_X_up_C = FE122_X_up_C + FE122_X_I_C[0][k][m] * FE122_X_I_C[2][k][m];
					FE122_X_down_C = FE122_X_down_C + FE122_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE122_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_X_I_C2[2][k][m]))
						continue;
					FE122_X_up_C2 = FE122_X_up_C2 + FE122_X_I_C2[0][k][m] * FE122_X_I_C2[2][k][m];
					FE122_X_down_C2 = FE122_X_down_C2 + FE122_X_I_C2[2][k][m];
				}

				FE122_X[m] = -((FE122_X_up / FE122_X_down) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				FE122_X_C[m] = -((FE122_X_up_C / FE122_X_down_C) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				FE122_X_C2[m] = -((FE122_X_up_C2 / FE122_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120) + 50;

				if (FE122_X_I_C2[0][0][m] > FE122_X_I_C2[0][1][m])
				{
					FE122_X_M[m] = -((FE122_X_I_C2[0][0][m] - (1 - h_FE122_h_Q0_Q1_F->GetBinContent(int((FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE122_X_I_C2[0][0][m] < FE122_X_I_C2[0][1][m])
				{
					FE122_X_M[m] = -((FE122_X_I_C2[0][0][m] + (1 - h_FE122_h_Q0_Q1_F->GetBinContent(int((FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE122_X_I_C2[0][0][m] > FE122_X_I_C2[0][1][m])
				{
					FE122_X_M2[m] = -((FE122_X_I_C2[0][0][m] - (1 - h_FE122_h_Q0_Q1_S_F[int(FE122_X_I_C2[0][0][m])][int(FE122_X_I_C2[0][1][m])]->GetBinContent(int((FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}

				if (FE122_X_I_C2[0][0][m] < FE122_X_I_C2[0][1][m])
				{
					FE122_X_M2[m] = -((FE122_X_I_C2[0][0][m] + (1 - h_FE122_h_Q0_Q1_S_F[int(FE122_X_I_C2[0][0][m])][int(FE122_X_I_C2[0][1][m])]->GetBinContent(int((FE122_X_I_C2[2][0][m] - FE122_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120) + 50;
				}
			}
		}

		for (int m = 0; m < array_FE122_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_Y_I_C2[2][1][m] > 0 && abs(FE122_Y_I_C2[0][0][m] - FE122_Y_I_C2[0][1][m]) == 1)
			{
				h_FE122_v_Q0_Q1->Fill(FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]);
				h_FE122_v_Q0_Q1_S[int(FE122_Y_I_C2[0][0][m])][int(FE122_Y_I_C2[0][1][m])]->Fill(FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]);

				FE122_Y_Q_Counter = FE122_Y_Q_Counter + 1;
				double FE122_Y_up = 0.;
				double FE122_Y_down = 0.;
				double FE122_Y_up_C = 0.;
				double FE122_Y_down_C = 0.;
				double FE122_Y_up_C2 = 0.;
				double FE122_Y_down_C2 = 0.;
				for (int k = 0; k < array_FE122_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_Y_I[2][k][m]))
						continue;
					FE122_Y_up = FE122_Y_up + FE122_Y_I[0][k][m] * FE122_Y_I[2][k][m];
					FE122_Y_down = FE122_Y_down + FE122_Y_I[2][k][m];
				}
				for (int k = 0; k < array_FE122_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_Y_I_C[2][k][m]))
						continue;
					FE122_Y_up_C = FE122_Y_up_C + FE122_Y_I_C[0][k][m] * FE122_Y_I_C[2][k][m];
					FE122_Y_down_C = FE122_Y_down_C + FE122_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_FE122_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(FE122_Y_I_C2[2][k][m]))
						continue;
					FE122_Y_up_C2 = FE122_Y_up_C2 + FE122_Y_I_C2[0][k][m] * FE122_Y_I_C2[2][k][m];
					FE122_Y_down_C2 = FE122_Y_down_C2 + FE122_Y_I_C2[2][k][m];
				}

				FE122_Y[m] = -((FE122_Y_up / FE122_Y_down) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				FE122_Y_C[m] = -((FE122_Y_up_C / FE122_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				FE122_Y_C2[m] = -((FE122_Y_up_C2 / FE122_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75) - 30;

				if (FE122_Y_I_C2[0][0][m] > FE122_Y_I_C2[0][1][m])
				{
					FE122_Y_M[m] = -((FE122_Y_I_C2[0][0][m] - (1 - h_FE122_v_Q0_Q1_F->GetBinContent(int((FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE122_Y_I_C2[0][0][m] < FE122_Y_I_C2[0][1][m])
				{
					FE122_Y_M[m] = -((FE122_Y_I_C2[0][0][m] + (1 - h_FE122_v_Q0_Q1_F->GetBinContent(int((FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE122_Y_I_C2[0][0][m] > FE122_Y_I_C2[0][1][m])
				{
					FE122_Y_M2[m] = -((FE122_Y_I_C2[0][0][m] - (1 - h_FE122_v_Q0_Q1_S_F[int(FE122_Y_I_C2[0][0][m])][int(FE122_Y_I_C2[0][1][m])]->GetBinContent(int((FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}

				if (FE122_Y_I_C2[0][0][m] < FE122_Y_I_C2[0][1][m])
				{
					FE122_Y_M2[m] = -((FE122_Y_I_C2[0][0][m] + (1 - h_FE122_v_Q0_Q1_S_F[int(FE122_Y_I_C2[0][0][m])][int(FE122_Y_I_C2[0][1][m])]->GetBinContent(int((FE122_Y_I_C2[2][0][m] - FE122_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75) - 30;
				}
			}
		}

		for (int m = 0; m < SRPPAC_max_ion; m++)
		{
			if (Beam_T[m] > 0)
			{

				FE12_A[m] = atan((FE122_X[m] - FE121_X[m]) / FE12_Z);
				FE12_A_C[m] = atan((FE122_X_C[m] - FE121_X_C[m]) / FE12_Z);
				FE12_A_C2[m] = atan((FE122_X_C2[m] - FE121_X_C2[m]) / FE12_Z);
				FE12_A_M[m] = atan((FE122_X_M[m] - FE121_X_M[m]) / FE12_Z);
				FE12_A_M2[m] = atan((FE122_X_M2[m] - FE121_X_M2[m]) / FE12_Z);

				FE12_B[m] = atan((FE122_Y[m] - FE121_Y[m]) / FE12_Z);
				FE12_B_C[m] = atan((FE122_Y_C[m] - FE121_Y_C[m]) / FE12_Z);
				FE12_B_C2[m] = atan((FE122_Y_C2[m] - FE121_Y_C2[m]) / FE12_Z);
				FE12_B_M[m] = atan((FE122_Y_M[m] - FE121_Y_M[m]) / FE12_Z);
				FE12_B_M2[m] = atan((FE122_Y_M2[m] - FE121_Y_M2[m]) / FE12_Z);

				FE12_X[m] = FE12_S0 * tan(FE12_A[m]) + FE121_X[m];
				FE12_X_C[m] = FE12_S0 * tan(FE12_A_C[m]) + FE121_X_C[m];
				FE12_X_C2[m] = FE12_S0 * tan(FE12_A_C2[m]) + FE121_X_C2[m];
				FE12_X_M[m] = FE12_S0 * tan(FE12_A_M[m]) + FE121_X_M[m];
				FE12_X_M2[m] = FE12_S0 * tan(FE12_A_M2[m]) + FE121_X_M2[m];

				FE12_Y[m] = FE12_S0 * tan(FE12_B[m]) + FE121_Y[m];
				FE12_Y_C[m] = FE12_S0 * tan(FE12_B_C[m]) + FE121_Y_C[m];
				FE12_Y_C2[m] = FE12_S0 * tan(FE12_B_C2[m]) + FE121_Y_C2[m];
				FE12_Y_M[m] = FE12_S0 * tan(FE12_B_M[m]) + FE121_Y_M[m];
				FE12_Y_M2[m] = FE12_S0 * tan(FE12_B_M2[m]) + FE121_Y_M2[m];
			}
		}

		// cout << "FE12 OK" << endl;

		/**********************************
			  3.- Recoil Identification.
		***********************************/

		// cout << endl;
		// cout << "S1" << endl;
		// cout << endl;

		// From the time provided by the FE12 and S1 SRPPACs anodes we obtain the FE12-S1 ToF of the ions.

		/*
		if (array_S11_y_cal->GetEntries() > 0)
	  {
		S11_A_E_Counter = S11_A_E_Counter + 1;
		for (int k = 0; k < array_S11_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		  {
			S11_A_Counter = S11_A_Counter + 1;
			p_S11_t = (TTimingChargePositionData*) array_S11_y_cal->At(k);//Apao
			S11_T_I[k] = p_S11_t->GetTiming();
		  }
	  }

		if (array_S12_x_cal->GetEntries() > 0)
	  {
		S12_A_E_Counter = S12_A_E_Counter + 1;
		for (int k = 0; k < array_S12_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		  {
			S12_A_Counter = S12_A_Counter + 1;
			p_S12_t = (TTimingChargePositionData*) array_S12_x_cal->At(k);//Apao
			S12_T_I[k] = p_S12_t->GetTiming();
		  }
	  }

		double S1_T_dummy;
		for (int j = 0; j < 50; j++)
		  {
			for (int k = 0; k < 50; k++)
		  {
			//cout << S12_T_I[j] - S11_T_I[k] << endl;
			//h_T_S1A->Fill(S12_T_I[j] - S11_T_I[k]);
			h_T_S1A->Fill(S12_T_I[0] - S11_T_I[0]);
			if (S12_T_I[j] - S11_T_I[k] > -5. && S12_T_I[j] - S11_T_I[k] < 30. && S12_T_I[j] != -1000000 && S11_T_I[k] != -1000000)
			  {
				S1_A_Counter = S1_A_Counter + 1;
				S1_T_dummy = (S12_T_I[j] + S11_T_I[k])/2.;
				//S1_T_dummy = (S12_T_I[j] + S11_T_I[k])/2.;
				//S1_T_dummy = S11_T_I[j];
				S1_T_I[j] = S1_T_dummy;
						//cout << S1_T_dummy  << endl;
			  }
		  }
		  }
		*/

		double S11_X_T_dummy;
		if (array_S11_x_cal->GetEntries() > 0)
		{
			S11_X_E_Counter = S11_X_E_Counter + 1;
			for (int k = 0; k < array_S11_x_cal->GetEntries() && k < 50; k++)
			{
				S11_X_Counter = S11_X_Counter + 1;
				p_S11_x_cal = (TTimingChargePositionData *)array_S11_x_cal->At(k);
				S11_X_T_dummy = p_S11_x_cal->GetTiming();

				for (int m = 0; m < array_S11_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_S11X_F3->Fill(S11_X_T_dummy - F3_T[m]);
					// if (S11_X_T_dummy - F3_T[m] > 1700 && S11_X_T_dummy - F3_T[m] < 1900) //Fast Beam.
					if (S11_X_T_dummy - F3_T[m] > 1900 && S11_X_T_dummy - F3_T[m] < 2200)
					{
						if (S11_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (S11_X_I[0][l - 1][m] != -1000000 && S11_X_I[0][l][m] == -1000000 && S11_X_I[1][l - 1][m] != p_S11_x_cal->GetTiming())
								{
									S11_XA_Counter = S11_XA_Counter + 1;
									S11_X_I[0][l][m] = p_S11_x_cal->GetID();
									S11_X_I[1][l][m] = p_S11_x_cal->GetTiming();
									S11_X_I[2][l][m] = p_S11_x_cal->GetCharge();

									S11_X_I_C[0][l][m] = S11_X_I[0][l][m];
									S11_X_I_C[1][l][m] = S11_X_I[1][l][m];
									S11_X_I_C[2][l][m] = S11_X_I[2][l][m] * (S11_X_factor / list_SRPPAC_gain[1][4][int(S11_X_I[0][l][m])]);
								}
							}
						}

						if (S11_X_I[0][0][m] == -1000000)
						{
							S11_XA_E_Counter = S11_XA_E_Counter + 1;
							S11_X_I[0][0][m] = p_S11_x_cal->GetID();
							S11_X_I[1][0][m] = p_S11_x_cal->GetTiming();
							S11_X_I[2][0][m] = p_S11_x_cal->GetCharge();

							S11_X_I_C[0][0][m] = S11_X_I[0][0][m];
							S11_X_I_C[1][0][m] = S11_X_I[1][0][m];
							S11_X_I_C[2][0][m] = S11_X_I[2][0][m] * (S11_X_factor / list_SRPPAC_gain[1][4][int(S11_X_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(S11_X_I_C);

		// We calculate the position at FE9 of the F3-FE9 ions.
		double S11_Y_T_dummy;
		if (array_S11_y_cal->GetEntries() > 0)
		{
			S11_Y_E_Counter = S11_Y_E_Counter + 1;
			for (int k = 0; k < array_S11_y_cal->GetEntries() && k < 50; k++)
			{
				S11_Y_Counter = S11_Y_Counter + 1;
				p_S11_y_cal = (TTimingChargePositionData *)array_S11_y_cal->At(k);
				S11_Y_T_dummy = p_S11_y_cal->GetTiming();

				for (int m = 0; m < array_S11_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_S11Y_F3->Fill(S11_Y_T_dummy - F3_T[m]);
					// if (S11_Y_T_dummy - F3_T[m] > 1700 && S11_Y_T_dummy - F3_T[m] < 1900) //Fast Beam.
					if (S11_Y_T_dummy - F3_T[m] > 1900 && S11_Y_T_dummy - F3_T[m] < 2200)
					{
						if (S11_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (S11_Y_I[0][l - 1][m] != -1000000 && S11_Y_I[0][l][m] == -1000000 && S11_Y_I[1][l - 1][m] != p_S11_y_cal->GetTiming())
								{
									S11_YA_Counter = S11_YA_Counter + 1;
									S11_Y_I[0][l][m] = p_S11_y_cal->GetID();
									S11_Y_I[1][l][m] = p_S11_y_cal->GetTiming();
									S11_Y_I[2][l][m] = p_S11_y_cal->GetCharge();

									S11_Y_I_C[0][l][m] = S11_Y_I[0][l][m];
									S11_Y_I_C[1][l][m] = S11_Y_I[1][l][m];
									S11_Y_I_C[2][l][m] = S11_Y_I[2][l][m] * (S11_Y_factor / list_SRPPAC_gain[0][4][int(S11_Y_I[0][l][m])]);
								}
							}
						}

						if (S11_Y_I[0][0][m] == -1000000)
						{
							S11_YA_E_Counter = S11_YA_E_Counter + 1;
							S11_Y_I[0][0][m] = p_S11_y_cal->GetID();
							S11_Y_I[1][0][m] = p_S11_y_cal->GetTiming();
							S11_Y_I[2][0][m] = p_S11_y_cal->GetCharge();

							S11_Y_I_C[0][0][m] = S11_Y_I[0][0][m];
							S11_Y_I_C[1][0][m] = S11_Y_I[1][0][m];
							S11_Y_I_C[2][0][m] = S11_Y_I[2][0][m] * (S11_Y_factor / list_SRPPAC_gain[0][4][int(S11_Y_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(S11_Y_I_C);

		for (int k = 0; k < array_S11_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_S11_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (S11_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_S11_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(S11_X_I_C[0][0][m] - S11_Y_I_C[0][0][l]) < 90)
						{
							S11_XY_Counter = S11_XY_Counter + 1;
							S11_X_I_C2[0][k][m] = S11_X_I_C[0][k][m];
							S11_X_I_C2[1][k][m] = S11_X_I_C[1][k][m];
							S11_X_I_C2[2][k][m] = S11_X_I_C[2][k][m] * (S11_X_factor / list_SRPPAC_gain2[1][int(S11_Y_I_C[0][0][l] / 4)][4][int(S11_X_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(S11_X_I_C2);

		for (int k = 0; k < array_S11_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_S11_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (S11_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_S11_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(S11_Y_I_C[0][0][m] - S11_X_I_C[0][0][l]) < 90)
						{
							S11_YX_Counter = S11_YX_Counter + 1;
							S11_Y_I_C2[0][k][m] = S11_Y_I_C[0][k][m];
							S11_Y_I_C2[1][k][m] = S11_Y_I_C[1][k][m];
							S11_Y_I_C2[2][k][m] = S11_Y_I_C[2][k][m] * (S11_Y_factor / list_SRPPAC_gain2[0][int(S11_X_I_C[0][0][l] / 6)][4][int(S11_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(S11_Y_I_C2);

		for (int m = 0; m < array_S11_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_X_I_C2[2][1][m] > 0 && abs(S11_X_I_C2[0][0][m] - S11_X_I_C2[0][1][m]) == 1)
			{
				h_S11_h_Q0_Q1->Fill(S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]);
				h_S11_h_Q0_Q1_S[int(S11_X_I_C2[0][0][m])][int(S11_X_I_C2[0][1][m])]->Fill(S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]);

				S11_X_Q_Counter = S11_X_Q_Counter + 1;
				double S11_X_up = 0.;
				double S11_X_down = 0.;
				double S11_X_up_C = 0.;
				double S11_X_down_C = 0.;
				double S11_X_up_C2 = 0.;
				double S11_X_down_C2 = 0.;
				for (int k = 0; k < array_S11_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_X_I[2][k][m]))
						continue;
					S11_X_up = S11_X_up + S11_X_I[0][k][m] * S11_X_I[2][k][m];
					S11_X_down = S11_X_down + S11_X_I[2][k][m];
				}
				for (int k = 0; k < array_S11_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_X_I_C[2][k][m]))
						continue;
					S11_X_up_C = S11_X_up_C + S11_X_I_C[0][k][m] * S11_X_I_C[2][k][m];
					S11_X_down_C = S11_X_down_C + S11_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_S11_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_X_I_C2[2][k][m]))
						continue;
					S11_X_up_C2 = S11_X_up_C2 + S11_X_I_C2[0][k][m] * S11_X_I_C2[2][k][m];
					S11_X_down_C2 = S11_X_down_C2 + S11_X_I_C2[2][k][m];
				}

				S11_X[m] = -((S11_X_up / S11_X_down) * (240. / 94.) + 2.55 / 2. - 120);
				S11_X_C[m] = -((S11_X_up_C / S11_X_down_C) * (240. / 94.) + 2.55 / 2. - 120);
				S11_X_C2[m] = -((S11_X_up_C2 / S11_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120);

				if (S11_X_I_C2[0][0][m] > S11_X_I_C2[0][1][m])
				{
					S11_X_M[m] = -((S11_X_I_C2[0][0][m] - (1 - h_S11_h_Q0_Q1_F->GetBinContent(int((S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S11_X_I_C2[0][0][m] < S11_X_I_C2[0][1][m])
				{
					S11_X_M[m] = -((S11_X_I_C2[0][0][m] + (1 - h_S11_h_Q0_Q1_F->GetBinContent(int((S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S11_X_I_C2[0][0][m] > S11_X_I_C2[0][1][m])
				{
					S11_X_M2[m] = -((S11_X_I_C2[0][0][m] - (1 - h_S11_h_Q0_Q1_S_F[int(S11_X_I_C2[0][0][m])][int(S11_X_I_C2[0][1][m])]->GetBinContent(int((S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S11_X_I_C2[0][0][m] < S11_X_I_C2[0][1][m])
				{
					S11_X_M2[m] = -((S11_X_I_C2[0][0][m] + (1 - h_S11_h_Q0_Q1_S_F[int(S11_X_I_C2[0][0][m])][int(S11_X_I_C2[0][1][m])]->GetBinContent(int((S11_X_I_C2[2][0][m] - S11_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}
			}
		}

		for (int m = 0; m < array_S11_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_Y_I_C2[2][1][m] > 0 && abs(S11_Y_I_C2[0][0][m] - S11_Y_I_C2[0][1][m]) == 1)
			{
				h_S11_v_Q0_Q1->Fill(S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]);
				h_S11_v_Q0_Q1_S[int(S11_Y_I_C2[0][0][m])][int(S11_Y_I_C2[0][1][m])]->Fill(S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]);

				S11_Y_Q_Counter = S11_Y_Q_Counter + 1;
				double S11_Y_up = 0.;
				double S11_Y_down = 0.;
				double S11_Y_up_C = 0.;
				double S11_Y_down_C = 0.;
				double S11_Y_up_C2 = 0.;
				double S11_Y_down_C2 = 0.;
				for (int k = 0; k < array_S11_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_Y_I[2][k][m]))
						continue;
					S11_Y_up = S11_Y_up + S11_Y_I[0][k][m] * S11_Y_I[2][k][m];
					S11_Y_down = S11_Y_down + S11_Y_I[2][k][m];
				}
				for (int k = 0; k < array_S11_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_Y_I_C[2][k][m]))
						continue;
					S11_Y_up_C = S11_Y_up_C + S11_Y_I_C[0][k][m] * S11_Y_I_C[2][k][m];
					S11_Y_down_C = S11_Y_down_C + S11_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_S11_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S11_Y_I_C2[2][k][m]))
						continue;
					S11_Y_up_C2 = S11_Y_up_C2 + S11_Y_I_C2[0][k][m] * S11_Y_I_C2[2][k][m];
					S11_Y_down_C2 = S11_Y_down_C2 + S11_Y_I_C2[2][k][m];
				}

				S11_Y[m] = -((S11_Y_up / S11_Y_down) * (150. / 58.) + 2.58 / 2. - 75);
				S11_Y_C[m] = -((S11_Y_up_C / S11_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75);
				S11_Y_C2[m] = -((S11_Y_up_C2 / S11_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75);

				if (S11_Y_I_C2[0][0][m] > S11_Y_I_C2[0][1][m])
				{
					S11_Y_M[m] = -((S11_Y_I_C2[0][0][m] - (1 - h_S11_v_Q0_Q1_F->GetBinContent(int((S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S11_Y_I_C2[0][0][m] < S11_Y_I_C2[0][1][m])
				{
					S11_Y_M[m] = -((S11_Y_I_C2[0][0][m] + (1 - h_S11_v_Q0_Q1_F->GetBinContent(int((S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S11_Y_I_C2[0][0][m] > S11_Y_I_C2[0][1][m])
				{
					S11_Y_M2[m] = -((S11_Y_I_C2[0][0][m] - (1 - h_S11_v_Q0_Q1_S_F[int(S11_Y_I_C2[0][0][m])][int(S11_Y_I_C2[0][1][m])]->GetBinContent(int((S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S11_Y_I_C2[0][0][m] < S11_Y_I_C2[0][1][m])
				{
					S11_Y_M2[m] = -((S11_Y_I_C2[0][0][m] + (1 - h_S11_v_Q0_Q1_S_F[int(S11_Y_I_C2[0][0][m])][int(S11_Y_I_C2[0][1][m])]->GetBinContent(int((S11_Y_I_C2[2][0][m] - S11_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}
			}
		}

		double S12_X_T_dummy;
		if (array_S12_x_cal->GetEntries() > 0)
		{
			S12_X_E_Counter = S12_X_E_Counter + 1;
			for (int k = 0; k < array_S12_x_cal->GetEntries() && k < 50; k++)
			{
				S12_X_Counter = S12_X_Counter + 1;
				p_S12_x_cal = (TTimingChargePositionData *)array_S12_x_cal->At(k);
				S12_X_T_dummy = p_S12_x_cal->GetTiming();

				for (int m = 0; m < array_S12_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_S12X_F3->Fill(S12_X_T_dummy - F3_T[m]);
					// if (S12_X_T_dummy - F3_T[m] > 1700 && S12_X_T_dummy - F3_T[m] < 1900) //Fast Beam.
					if (S12_X_T_dummy - F3_T[m] > 1900 && S12_X_T_dummy - F3_T[m] < 2200)
					{
						if (S12_X_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (S12_X_I[0][l - 1][m] != -1000000 && S12_X_I[0][l][m] == -1000000 && S12_X_I[1][l - 1][m] != p_S12_x_cal->GetTiming())
								{
									S12_XA_Counter = S12_XA_Counter + 1;
									S12_X_I[0][l][m] = p_S12_x_cal->GetID();
									S12_X_I[1][l][m] = p_S12_x_cal->GetTiming();
									S12_X_I[2][l][m] = p_S12_x_cal->GetCharge();

									S12_X_I_C[0][l][m] = S12_X_I[0][l][m];
									S12_X_I_C[1][l][m] = S12_X_I[1][l][m];
									S12_X_I_C[2][l][m] = S12_X_I[2][l][m] * (S12_X_factor / list_SRPPAC_gain[1][5][int(S12_X_I[0][l][m])]);
								}
							}
						}

						if (S12_X_I[0][0][m] == -1000000)
						{
							S12_XA_E_Counter = S12_XA_E_Counter + 1;
							S12_X_I[0][0][m] = p_S12_x_cal->GetID();
							S12_X_I[1][0][m] = p_S12_x_cal->GetTiming();
							S12_X_I[2][0][m] = p_S12_x_cal->GetCharge();

							S12_X_I_C[0][0][m] = S12_X_I[0][0][m];
							S12_X_I_C[1][0][m] = S12_X_I[1][0][m];
							S12_X_I_C[2][0][m] = S12_X_I[2][0][m] * (S12_X_factor / list_SRPPAC_gain[1][5][int(S12_X_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(S12_X_I_C);

		double S12_Y_T_dummy;
		if (array_S12_y_cal->GetEntries() > 0)
		{
			S12_Y_E_Counter = S12_Y_E_Counter + 1;
			for (int k = 0; k < array_S12_y_cal->GetEntries() && k < 50; k++)
			{
				S12_Y_Counter = S12_Y_Counter + 1;
				p_S12_y_cal = (TTimingChargePositionData *)array_S12_y_cal->At(k);
				S12_Y_T_dummy = p_S12_y_cal->GetTiming();

				for (int m = 0; m < array_S12_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
				{
					h_T_S12Y_F3->Fill(S12_Y_T_dummy - F3_T[m]);
					// if (S12_Y_T_dummy - F3_T[m] > 1700 && S12_Y_T_dummy - F3_T[m] < 1900) //Fast Beam.
					if (S12_Y_T_dummy - F3_T[m] > 1900 && S12_Y_T_dummy - F3_T[m] < 2200)
					{
						if (S12_Y_I[0][0][m] != -1000000)
						{
							for (int l = 1; l < SRPPAC_max_mult; l++)
							{
								if (S12_Y_I[0][l - 1][m] != -1000000 && S12_Y_I[0][l][m] == -1000000 && S12_Y_I[1][l - 1][m] != p_S12_y_cal->GetTiming())
								{
									S12_YA_Counter = S12_YA_Counter + 1;
									S12_Y_I[0][l][m] = p_S12_y_cal->GetID();
									S12_Y_I[1][l][m] = p_S12_y_cal->GetTiming();
									S12_Y_I[2][l][m] = p_S12_y_cal->GetCharge();

									S12_Y_I_C[0][l][m] = S12_Y_I[0][l][m];
									S12_Y_I_C[1][l][m] = S12_Y_I[1][l][m];
									S12_Y_I_C[2][l][m] = S12_Y_I[2][l][m] * (S12_Y_factor / list_SRPPAC_gain[0][5][int(S12_Y_I[0][l][m])]);
								}
							}
						}

						if (S12_Y_I[0][0][m] == -1000000)
						{
							S12_YA_E_Counter = S12_YA_E_Counter + 1;
							S12_Y_I[0][0][m] = p_S12_y_cal->GetID();
							S12_Y_I[1][0][m] = p_S12_y_cal->GetTiming();
							S12_Y_I[2][0][m] = p_S12_y_cal->GetCharge();

							S12_Y_I_C[0][0][m] = S12_Y_I[0][0][m];
							S12_Y_I_C[1][0][m] = S12_Y_I[1][0][m];
							S12_Y_I_C[2][0][m] = S12_Y_I[2][0][m] * (S12_Y_factor / list_SRPPAC_gain[0][5][int(S12_Y_I[0][0][m])]);
						}
					}
				}
			}
		}

		f_sort(S12_Y_I_C);

		for (int k = 0; k < array_S12_x_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_S12_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (S12_X_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_S12_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(S12_X_I_C[0][0][m] - S12_Y_I_C[0][0][l]) < 90)
						{
							S12_XY_Counter = S12_XY_Counter + 1;
							S12_X_I_C2[0][k][m] = S12_X_I_C[0][k][m];
							S12_X_I_C2[1][k][m] = S12_X_I_C[1][k][m];
							S12_X_I_C2[2][k][m] = S12_X_I_C[2][k][m] * (S12_X_factor / list_SRPPAC_gain2[1][int(S12_Y_I_C[0][0][l] / 4)][5][int(S12_X_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(S12_X_I_C2);

		for (int k = 0; k < array_S12_y_cal->GetEntries() && k < SRPPAC_max_ion; k++)
		{
			for (int m = 0; m < array_S12_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
			{
				if (S12_Y_I_C[0][k][m] != -1000000)
				{
					for (int l = 0; l < array_S12_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
					{
						if (abs(S12_Y_I_C[0][0][m] - S12_X_I_C[0][0][l]) < 90)
						{
							S12_YX_Counter = S12_YX_Counter + 1;
							S12_Y_I_C2[0][k][m] = S12_Y_I_C[0][k][m];
							S12_Y_I_C2[1][k][m] = S12_Y_I_C[1][k][m];
							S12_Y_I_C2[2][k][m] = S12_Y_I_C[2][k][m] * (S12_Y_factor / list_SRPPAC_gain2[0][int(S12_X_I_C[0][0][l] / 6)][5][int(S12_Y_I_C[0][k][m])]);
						}
					}
				}
			}
		}

		f_sort(S12_Y_I_C2);

		for (int m = 0; m < array_FE91_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE91_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE91_X_I_C[0][0][m] - FE91_Y_I_C[0][0][l]) < 50)
					{
						h_FE91_X_Q0_C[int(FE91_Y_I_C[0][0][l] / 4)]->Fill(FE91_X_I_C[0][0][m], FE91_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE91_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE91_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE91_Y_I_C[0][0][m] - FE91_X_I_C[0][0][l]) < 50)
					{
						h_FE91_Y_Q0_C[int(FE91_X_I_C[0][0][l] / 6)]->Fill(FE91_Y_I_C[0][0][m], FE91_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE92_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE92_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE92_X_I_C[0][0][m] - FE92_Y_I_C[0][0][l]) < 50)
					{
						h_FE92_X_Q0_C[int(FE92_Y_I_C[0][0][l] / 4)]->Fill(FE92_X_I_C[0][0][m], FE92_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE92_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE92_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE92_Y_I_C[0][0][m] - FE92_X_I_C[0][0][l]) < 50)
					{
						h_FE92_Y_Q0_C[int(FE92_X_I_C[0][0][l] / 6)]->Fill(FE92_Y_I_C[0][0][m], FE92_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE121_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE121_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE121_X_I_C[0][0][m] - FE121_Y_I_C[0][0][l]) < 90)
					{
						h_FE121_X_Q0_C[int(FE121_Y_I_C[0][0][l] / 4)]->Fill(FE121_X_I_C[0][0][m], FE121_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE121_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE121_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE121_Y_I_C[0][0][m] - FE121_X_I_C[0][0][l]) < 90)
					{
						h_FE121_Y_Q0_C[int(FE121_X_I_C[0][0][l] / 6)]->Fill(FE121_Y_I_C[0][0][m], FE121_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE122_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE122_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE122_X_I_C[0][0][m] - FE122_Y_I_C[0][0][l]) < 90)
					{
						h_FE122_X_Q0_C[int(FE122_Y_I_C[0][0][l] / 4)]->Fill(FE122_X_I_C[0][0][m], FE122_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE122_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE122_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE122_Y_I_C[0][0][m] - FE122_X_I_C[0][0][l]) < 90)
					{
						h_FE122_Y_Q0_C[int(FE122_X_I_C[0][0][l] / 6)]->Fill(FE122_Y_I_C[0][0][m], FE122_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S11_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S11_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S11_X_I_C[0][0][m] - S11_Y_I_C[0][0][l]) < 90)
					{
						h_S11_X_Q0_C[int(S11_Y_I_C[0][0][l] / 4)]->Fill(S11_X_I_C[0][0][m], S11_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S11_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S11_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S11_Y_I_C[0][0][m] - S11_X_I_C[0][0][l]) < 90)
					{
						h_S11_Y_Q0_C[int(S11_X_I_C[0][0][l] / 6)]->Fill(S11_Y_I_C[0][0][m], S11_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S12_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_X_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S12_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S12_X_I_C[0][0][m] - S12_Y_I_C[0][0][l]) < 90)
					{
						h_S12_X_Q0_C[int(S12_Y_I_C[0][0][l] / 4)]->Fill(S12_X_I_C[0][0][m], S12_X_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S12_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_Y_I_C[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S12_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S12_Y_I_C[0][0][m] - S12_X_I_C[0][0][l]) < 90)
					{
						h_S12_Y_Q0_C[int(S12_X_I_C[0][0][l] / 6)]->Fill(S12_Y_I_C[0][0][m], S12_Y_I_C[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE91_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE91_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE91_X_I_C2[0][0][m] - FE91_Y_I_C2[0][0][l]) < 50)
					{
						h_FE91_X_Q0_C2[int(FE91_Y_I_C2[0][0][l] / 4)]->Fill(FE91_X_I_C2[0][0][m], FE91_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE91_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE91_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE91_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE91_Y_I_C2[0][0][m] - FE91_X_I_C2[0][0][l]) < 50)
					{
						h_FE91_Y_Q0_C2[int(FE91_X_I_C2[0][0][l] / 6)]->Fill(FE91_Y_I_C2[0][0][m], FE91_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE92_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE92_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE92_X_I_C2[0][0][m] - FE92_Y_I_C2[0][0][l]) < 50)
					{
						h_FE92_X_Q0_C2[int(FE92_Y_I_C2[0][0][l] / 4)]->Fill(FE92_X_I_C2[0][0][m], FE92_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE92_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE92_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE92_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE92_Y_I_C2[0][0][m] - FE92_X_I_C2[0][0][l]) < 50)
					{
						h_FE92_Y_Q0_C2[int(FE92_X_I_C2[0][0][l] / 6)]->Fill(FE92_Y_I_C2[0][0][m], FE92_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE121_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE121_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE121_X_I_C2[0][0][m] - FE121_Y_I_C2[0][0][l]) < 90)
					{
						h_FE121_X_Q0_C2[int(FE121_Y_I_C2[0][0][l] / 4)]->Fill(FE121_X_I_C2[0][0][m], FE121_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE121_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE121_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE121_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE121_Y_I_C2[0][0][m] - FE121_X_I_C2[0][0][l]) < 90)
					{
						h_FE121_Y_Q0_C2[int(FE121_X_I_C2[0][0][l] / 6)]->Fill(FE121_Y_I_C2[0][0][m], FE121_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE122_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE122_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE122_X_I_C2[0][0][m] - FE122_Y_I_C2[0][0][l]) < 90)
					{
						h_FE122_X_Q0_C2[int(FE122_Y_I_C2[0][0][l] / 4)]->Fill(FE122_X_I_C2[0][0][m], FE122_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_FE122_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (FE122_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_FE122_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(FE122_Y_I_C2[0][0][m] - FE122_X_I_C2[0][0][l]) < 90)
					{
						h_FE122_Y_Q0_C2[int(FE122_X_I_C2[0][0][l] / 6)]->Fill(FE122_Y_I_C2[0][0][m], FE122_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S11_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S11_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S11_X_I_C2[0][0][m] - S11_Y_I_C2[0][0][l]) < 90)
					{
						h_S11_X_Q0_C2[int(S11_Y_I_C2[0][0][l] / 4)]->Fill(S11_X_I_C2[0][0][m], S11_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S11_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S11_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S11_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S11_Y_I_C2[0][0][m] - S11_X_I_C2[0][0][l]) < 90)
					{
						h_S11_Y_Q0_C2[int(S11_X_I_C2[0][0][l] / 6)]->Fill(S11_Y_I_C2[0][0][m], S11_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S12_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_X_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S12_y_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S12_X_I_C2[0][0][m] - S12_Y_I_C2[0][0][l]) < 90)
					{
						h_S12_X_Q0_C2[int(S12_Y_I_C2[0][0][l] / 4)]->Fill(S12_X_I_C2[0][0][m], S12_X_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int m = 0; m < array_S12_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_Y_I_C2[0][0][m] != -1000000)
			{
				for (int l = 0; l < array_S12_x_cal->GetEntries() && l < SRPPAC_max_ion; l++)
				{
					if (abs(S12_Y_I_C2[0][0][m] - S12_X_I_C2[0][0][l]) < 90)
					{
						h_S12_Y_Q0_C2[int(S12_X_I_C2[0][0][l] / 6)]->Fill(S12_Y_I_C2[0][0][m], S12_Y_I_C2[2][0][m]);
					}
				}
			}
		}

		for (int k = 0; k < SRPPAC_max_ion; k++)
		{
			S11_T_I[k] = S11_Y_I_C[1][0][k];
		}

		for (int k = 0; k < SRPPAC_max_ion; k++)
		{
			S12_T_I[k] = S12_X_I_C[1][0][k];
		}

		double S1_T_dummy;
		for (int j = 0; j < 50 && j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < 50 && k < SRPPAC_max_ion; k++)
			{
				// cout << S12_T_I[j] - S11_T_I[k] << endl;
				if (S12_T_I[j] - S11_T_I[k] > -5. && S12_T_I[j] - S11_T_I[k] < 30. && S12_T_I[j] != -1000000 && S11_T_I[k] != -1000000)
				{
					S1_A_Counter = S1_A_Counter + 1;
					S1_T_dummy = (S12_T_I[j] + S11_T_I[k]) / 2.;
					S1_T_I[j] = S1_T_dummy;
					// cout << S1_T_dummy  << endl;
				}
			}
		}

		double betaS1_dummy;
		double S1_E_dummy;
		double S1PID_T_dummy;
		for (int j = 0; j < 50 && j < SRPPAC_max_ion; j++)
		{
			for (int k = 0; k < 50 && k < SRPPAC_max_ion; k++)
			{
				// if (S1_T_I[j] - F3_T[k] > 1700. && S1_T_I[j] - F3_T[k] < 1900.) //Fast Beam.
				h_T_S1A_F3->Fill(S1_T_I[j] - F3_T[k]);
				if (S1_T_I[j] - F3_T[k] > 1875. && S1_T_I[j] - F3_T[k] < 2225.)
				{
					F3_S1_A_Counter = F3_S1_A_Counter + 1;
					S1PID_T_dummy = S1_T_I[j] - Beam_T[k] - PID_T[k] - F3_T[k];
					S1PID_T[k] = S1PID_T_dummy;
					// cout << Beam_T[k] << endl;

					S1_E_dummy = calculateBeamEnergy(S1PID_T[k] - 434.060, distance_FE12_S1); // -434.060 ns is the TOF offset for 2024 S1PID_T_0
					S1_E[k] = S1_E_dummy;

					betaS1_dummy = calculateBeta(S1PID_T[k] - 434.060, distance_FE12_S1); // -434.060 ns is the TOF offset for 2024 S1PID_T_0
					betaS1[k] = betaS1_dummy;
				}
			}
		}

		for (int m = 0; m < array_S12_x_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_X_I_C2[2][1][m] > 0 && abs(S12_X_I_C2[0][0][m] - S12_X_I_C2[0][1][m]) == 1)
			{
				h_S12_h_Q0_Q1->Fill(S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]);
				h_S12_h_Q0_Q1_S[int(S12_X_I_C2[0][0][m])][int(S12_X_I_C2[0][1][m])]->Fill(S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]);

				S12_X_Q_Counter = S12_X_Q_Counter + 1;
				double S12_X_up = 0.;
				double S12_X_down = 0.;
				double S12_X_up_C = 0.;
				double S12_X_down_C = 0.;
				double S12_X_up_C2 = 0.;
				double S12_X_down_C2 = 0.;
				for (int k = 0; k < array_S12_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_X_I[2][k][m]))
						continue;
					S12_X_up = S12_X_up + S12_X_I[0][k][m] * S12_X_I[2][k][m];
					S12_X_down = S12_X_down + S12_X_I[2][k][m];
				}
				for (int k = 0; k < array_S12_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_X_I_C[2][k][m]))
						continue;
					S12_X_up_C = S12_X_up_C + S12_X_I_C[0][k][m] * S12_X_I_C[2][k][m];
					S12_X_down_C = S12_X_down_C + S12_X_I_C[2][k][m];
				}
				for (int k = 0; k < array_S12_x_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_X_I_C2[2][k][m]))
						continue;
					S12_X_up_C2 = S12_X_up_C2 + S12_X_I_C2[0][k][m] * S12_X_I_C2[2][k][m];
					S12_X_down_C2 = S12_X_down_C2 + S12_X_I_C2[2][k][m];
				}

				S12_X[m] = -((S12_X_up / S12_X_down) * (240. / 94.) + 2.55 / 2. - 120);
				S12_X_C[m] = -((S12_X_up_C / S12_X_down_C) * (240. / 94.) + 2.55 / 2. - 120);
				S12_X_C2[m] = -((S12_X_up_C2 / S12_X_down_C2) * (240. / 94.) + 2.55 / 2. - 120);

				if (S12_X_I_C2[0][0][m] > S12_X_I_C2[0][1][m])
				{
					S12_X_M[m] = -((S12_X_I_C2[0][0][m] - (1 - h_S12_h_Q0_Q1_F->GetBinContent(int((S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S12_X_I_C2[0][0][m] < S12_X_I_C2[0][1][m])
				{
					S12_X_M[m] = -((S12_X_I_C2[0][0][m] + (1 - h_S12_h_Q0_Q1_F->GetBinContent(int((S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S12_X_I_C2[0][0][m] > S12_X_I_C2[0][1][m])
				{
					S12_X_M2[m] = -((S12_X_I_C2[0][0][m] - (1 - h_S12_h_Q0_Q1_S_F[int(S12_X_I_C2[0][0][m])][int(S12_X_I_C2[0][1][m])]->GetBinContent(int((S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}

				if (S12_X_I_C2[0][0][m] < S12_X_I_C2[0][1][m])
				{
					S12_X_M2[m] = -((S12_X_I_C2[0][0][m] + (1 - h_S12_h_Q0_Q1_S_F[int(S12_X_I_C2[0][0][m])][int(S12_X_I_C2[0][1][m])]->GetBinContent(int((S12_X_I_C2[2][0][m] - S12_X_I_C2[2][1][m]) * 100))) / 2) * (240. / 94.) + 2.55 / 2. - 120);
				}
			}
		}

		for (int m = 0; m < array_S12_y_cal->GetEntries() && m < SRPPAC_max_ion; m++)
		{
			if (S12_Y_I_C2[2][1][m] > 0 && abs(S12_Y_I_C2[0][0][m] - S12_Y_I_C2[0][1][m]) == 1)
			{
				h_S12_v_Q0_Q1->Fill(S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]);
				h_S12_v_Q0_Q1_S[int(S12_Y_I_C2[0][0][m])][int(S12_Y_I_C2[0][1][m])]->Fill(S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]);

				S12_Y_Q_Counter = S12_Y_Q_Counter + 1;
				double S12_Y_up = 0.;
				double S12_Y_down = 0.;
				double S12_Y_up_C = 0.;
				double S12_Y_down_C = 0.;
				double S12_Y_up_C2 = 0.;
				double S12_Y_down_C2 = 0.;
				for (int k = 0; k < array_S12_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_Y_I[2][k][m]))
						continue;
					S12_Y_up = S12_Y_up + S12_Y_I[0][k][m] * S12_Y_I[2][k][m];
					S12_Y_down = S12_Y_down + S12_Y_I[2][k][m];
				}
				for (int k = 0; k < array_S12_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_Y_I_C[2][k][m]))
						continue;
					S12_Y_up_C = S12_Y_up_C + S12_Y_I_C[0][k][m] * S12_Y_I_C[2][k][m];
					S12_Y_down_C = S12_Y_down_C + S12_Y_I_C[2][k][m];
				}
				for (int k = 0; k < array_S12_y_cal->GetEntries() && k < 50; k++)
				{
					if (isnan(S12_Y_I_C2[2][k][m]))
						continue;
					S12_Y_up_C2 = S12_Y_up_C2 + S12_Y_I_C2[0][k][m] * S12_Y_I_C2[2][k][m];
					S12_Y_down_C2 = S12_Y_down_C2 + S12_Y_I_C2[2][k][m];
				}

				S12_Y[m] = -((S12_Y_up / S12_Y_down) * (150. / 58.) + 2.58 / 2. - 75);
				S12_Y_C[m] = -((S12_Y_up_C / S12_Y_down_C) * (150. / 58.) + 2.58 / 2. - 75);
				S12_Y_C2[m] = -((S12_Y_up_C2 / S12_Y_down_C2) * (150. / 58.) + 2.58 / 2. - 75);

				if (S12_Y_I_C2[0][0][m] > S12_Y_I_C2[0][1][m])
				{
					S12_Y_M[m] = -((S12_Y_I_C2[0][0][m] - (1 - h_S12_v_Q0_Q1_F->GetBinContent(int((S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S12_Y_I_C2[0][0][m] < S12_Y_I_C2[0][1][m])
				{
					S12_Y_M[m] = -((S12_Y_I_C2[0][0][m] + (1 - h_S12_v_Q0_Q1_F->GetBinContent(int((S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S12_Y_I_C2[0][0][m] > S12_Y_I_C2[0][1][m])
				{
					S12_Y_M2[m] = -((S12_Y_I_C2[0][0][m] - (1 - h_S12_v_Q0_Q1_S_F[int(S12_Y_I_C2[0][0][m])][int(S12_Y_I_C2[0][1][m])]->GetBinContent(int((S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}

				if (S12_Y_I_C2[0][0][m] < S12_Y_I_C2[0][1][m])
				{
					S12_Y_M2[m] = -((S12_Y_I_C2[0][0][m] + (1 - h_S12_v_Q0_Q1_S_F[int(S12_Y_I_C2[0][0][m])][int(S12_Y_I_C2[0][1][m])]->GetBinContent(int((S12_Y_I_C2[2][0][m] - S12_Y_I_C2[2][1][m]) * 100))) / 2) * (150. / 58.) + 2.58 / 2. - 75);
				}
			}
		}

		for (int m = 0; m < SRPPAC_max_ion; m++)
		{
			if (S1PID_T[m] > 0)
			{
				S1_A[m] = atan((S12_X[m] - S11_X[m]) / S1_Z);
				S1_A_C[m] = atan((S12_X_C[m] - S11_X_C[m]) / S1_Z);
				S1_A_C2[m] = atan((S12_X_C2[m] - S11_X_C2[m]) / S1_Z);
				S1_A_M[m] = atan((S12_X_M[m] - S11_X_M[m]) / S1_Z);
				S1_A_M2[m] = atan((S12_X_M2[m] - S11_X_M2[m]) / S1_Z);

				S1_B[m] = atan((S12_Y[m] - S11_Y[m]) / S1_Z);
				S1_B_C[m] = atan((S12_Y_C[m] - S11_Y_C[m]) / S1_Z);
				S1_B_C2[m] = atan((S12_Y_C2[m] - S11_Y_C2[m]) / S1_Z);
				S1_B_M[m] = atan((S12_Y_M[m] - S11_Y_M[m]) / S1_Z);
				S1_B_M2[m] = atan((S12_Y_M2[m] - S11_Y_M2[m]) / S1_Z);

				S1_X[m] = S1_S0 * tan(S1_A[m]) + S11_X[m];
				S1_X_C[m] = S1_S0 * tan(S1_A_C[m]) + S11_X_C[m];
				S1_X_C2[m] = S1_S0 * tan(S1_A_C2[m]) + S11_X_C2[m];
				S1_X_M[m] = S1_S0 * tan(S1_A_M[m]) + S11_X_M[m];
				S1_X_M2[m] = S1_S0 * tan(S1_A_M2[m]) + S11_X_M2[m];

				S1_Y[m] = S1_S0 * tan(S1_B[m]) + S11_Y[m];
				S1_Y_C[m] = S1_S0 * tan(S1_B_C[m]) + S11_Y_C[m];
				S1_Y_C2[m] = S1_S0 * tan(S1_B_C2[m]) + S11_Y_C2[m];
				S1_Y_M[m] = S1_S0 * tan(S1_B_M[m]) + S11_Y_M[m];
				S1_Y_M2[m] = S1_S0 * tan(S1_B_M2[m]) + S11_Y_M2[m];
			}
		}

		// 3.2.- S1 Ionization Chamber.

		// Gate on events where the 50Ca beam hits the CD2 target (rho < 2.5 cm).
		//   if ( pow((S1_R-78)*cos(0.0187)-(S1_Theta*180/PI-1.8)*sin(0.0187),2)/1600 + pow((S1_R-78)*sin(0.0187)-(S1_Theta*180/PI-1.8)*cos(0.0187),2)/2.5 < 1 || pow(S1_X,2)/2500 + pow(S1_Y,2)/2500 > 1 || isnan(S1_R) || isnan(S1_Theta) )
		//	continue;

		IC_Charge = 0;
		IC_Z = 0;
		IC_E_max = 0;
		IC_Telescope_E = 0;
		IC_Telescope_deltaE = 0;

		// IC Charge Info Stored in IC_C_ branch
		for (int j = 0; j < 30; j++)
		{
			p_IC_RAW = (TCatPulseShape *)array_IC_RAW_Charge->At(j);
			IC_C_RAW[j] = p_IC_RAW->GetCharge();
		}

		// IC Energy Info Stored in IC_E_ branch
		for (int j = 0; j < 30; j++)
		{
			p_IC = (TCatPulseShape *)array_IC_RAW_Energy->At(j);
			IC_E[j] = p_IC->GetCharge();
		}

		// Calibrated IC Energy Info Stored in IC_E_Cal_ branch
		for (int j = 0; j < 30; j++)
		{
			// IC_E_Cal[j] = IC_E[j] * scalingFactor[j];   // Energy calibrated by Scaling factor
			// IC_E_Cal[j] = (IC_C_RAW[j] * IC_V_A[j] + IC_V_B[j]) * IC_E_A[j] + IC_E_B[j]; // Charge to Voltage >> Voltage to Energy
			// IC_E_Cal[j] = IC_E[j] * scalingFactor2024[j]; // Energy calibrated by Fast Beam Scaling factor
			IC_E_Cal[j] = IC_E[j] * scalingFactor2024[j] * slowBeamScalingFactor2024v2[j]; // Energy calibrated by Fast-Slow Beam Scaling factor
		}

		// cout << "S1 OK" << endl;

		// /**********************
		// 	  4.- TINA2.
		//  **********************/

		// // cout << endl;
		// // cout << "TINA" << endl;
		// // cout << endl;

		// // 4.- TINA2 Times.
		// for (int a = 0; a < 23; a++)
		// {
		// 	for (int b = 0; b < 5; b++)
		// 	{
		// 		TINA2_T_RAW[a][b] = -1000000;
		// 	}
		// }

		// if (array_TINA2_t_raw->GetEntries() > 0)
		// {
		// 	for (int a = 0; a < array_TINA2_t_raw->GetEntries(); a++)
		// 	{
		// 		p_TINA2_t_raw = (TTimingChargePositionData *)array_TINA2_t_raw->At(a);
		// 		for (int j = 0; j < 23; j++)
		// 		{
		// 			if (p_TINA2_t_raw->GetID() == j)
		// 			{
		// 				for (int k = 0; k < 5; k++)
		// 				{
		// 					if (TINA2_T_RAW[j][k] == -1000000)
		// 					{
		// 						TINA2_T_RAW[j][k] = p_TINA2_t_raw->GetTiming();
		// 					}
		// 				}
		// 			}
		// 		}
		// 	}
		// }

		// // cout << "TINAT OK" << endl;

		// // 4.1.- YY1 Analysis.

		// YY1_pulse_mult = array_YY1->GetEntries();

		// YY1_hit_mult = 0;

		// for (int a = 0; a < 50; a++)
		// {
		// 	YY1_hit_energies[a] = -100;
		// 	YY1_hit_strips[a] = -100;
		// }

		// if (YY1_pulse_mult > 0)
		// {
		// 	for (int a = 0; a < YY1_pulse_mult && a < 50; a++)
		// 	{
		// 		p_YY1 = (TCatPulseShape *)array_YY1->At(a);
		// 		YY1_hit_energies[a] = p_YY1->GetCharge();
		// 		YY1_hit_strips[a] = p_YY1->GetID();
		// 	}
		// 	for (int a = 0; a < 50 - 1; a++)
		// 	{
		// 		for (int b = a + 1; b < 50 - 1; b++)
		// 		{
		// 			if (YY1_hit_energies[b] > YY1_hit_energies[a])
		// 			{
		// 				double temp_E = YY1_hit_energies[a];
		// 				YY1_hit_energies[a] = YY1_hit_energies[b];
		// 				YY1_hit_energies[b] = temp_E;
		// 				double temp_ID = YY1_hit_strips[a];
		// 				YY1_hit_strips[a] = YY1_hit_strips[b];
		// 				YY1_hit_strips[b] = temp_ID;
		// 			}
		// 		}
		// 	}
		// }

		// // cout << "YY1 OK" << endl;

		// // 4.2- TTT and CsI Analysis.
		// TTT_pulse_mult_front = array_TTT_front->GetEntries();
		// TTT_pulse_mult_back = array_TTT_back->GetEntries();

		// for (int a = 0; a < 50; a++)
		// {
		// 	TTT_hit_front_energies[a] = -100;
		// 	TTT_hit_front_strips[a] = -100;
		// }

		// for (int a = 0; a < 50; a++)
		// {
		// 	TTT_hit_back_energies[a] = -100;
		// 	TTT_hit_back_strips[a] = -100;
		// }

		// for (int a = 0; a < 50; a++)
		// {
		// 	CsI_E[a] = -100;
		// 	CsI_ID[a] = -100;
		// }

		// // cout << endl;
		// // cout << "EVENT = " << i  << endl;
		// // cout << "Front Mult = " << TTT_pulse_mult_front  << endl;
		// // cout << "Back Mult = " << TTT_pulse_mult_back  << endl;

		// if (TTT_pulse_mult_front > 0 && TTT_pulse_mult_back > 0)
		// {
		// 	for (int a = 0; a < TTT_pulse_mult_front && a < 50; a++)
		// 	{
		// 		p_TTT_front = (TCatPulseShape *)array_TTT_front->At(a);
		// 		TTT_hit_front_energies[a] = p_TTT_front->GetCharge();
		// 		TTT_hit_front_strips[a] = p_TTT_front->GetID();
		// 	}

		// 	for (int a = 0; a < 50 - 1; a++)
		// 	{
		// 		for (int b = a + 1; b < 50 - 1; b++)
		// 		{
		// 			if (TTT_hit_front_energies[b] > TTT_hit_front_energies[a])
		// 			{
		// 				double temp_E = TTT_hit_front_energies[a];
		// 				TTT_hit_front_energies[a] = TTT_hit_front_energies[b];
		// 				TTT_hit_front_energies[b] = temp_E;
		// 				double temp_ID = TTT_hit_front_strips[a];
		// 				TTT_hit_front_strips[a] = TTT_hit_front_strips[b];
		// 				TTT_hit_front_strips[b] = temp_ID;
		// 			}
		// 		}
		// 	}

		// 	for (int a = 0; a < TTT_pulse_mult_back && a < 50; a++)
		// 	{
		// 		p_TTT_back = (TCatPulseShape *)array_TTT_back->At(a);
		// 		TTT_hit_back_energies[a] = p_TTT_back->GetCharge();
		// 		TTT_hit_back_strips[a] = p_TTT_back->GetID();
		// 	}

		// 	for (int a = 0; a < 50 - 1; a++)
		// 	{
		// 		for (int b = a + 1; b < 50 - 1; b++)
		// 		{
		// 			if (TTT_hit_back_energies[b] > TTT_hit_back_energies[a])
		// 			{
		// 				double temp_E = TTT_hit_back_energies[a];
		// 				TTT_hit_back_energies[a] = TTT_hit_back_energies[b];
		// 				TTT_hit_back_energies[b] = temp_E;
		// 				double temp_ID = TTT_hit_back_strips[a];
		// 				TTT_hit_back_strips[a] = TTT_hit_back_strips[b];
		// 				TTT_hit_back_strips[b] = temp_ID;
		// 			}
		// 		}
		// 	}
		// }

		// for (int j = 0; j < array_CsI->GetEntries() && j < 50; j++)
		// {
		// 	p_CsI = (TCatPulseShape *)array_CsI->At(j);
		// 	for (int k = 0; k < 16; k++)
		// 	{
		// 		if (p_CsI->GetID() == k)
		// 		{
		// 			if (CsI_ID[k] != -100)
		// 			{
		// 				cout << endl;
		// 				cout << "Event = " << i << endl;
		// 				cout << "Old ID = " << CsI_ID[k] << " Charge = " << CsI_E[k] << endl;
		// 				cout << "New ID = " << p_CsI->GetID() << " Charge = " << p_CsI->GetCharge() << endl;
		// 			}
		// 			CsI_E[k] = p_CsI->GetCharge();
		// 			CsI_ID[k] = p_CsI->GetID();
		// 			CsI_E[k] = CsI_E[k] - CsI_Shift[k];
		// 		}
		// 	}
		// }

		// // for (int j = 0; j < 16; j++)
		// //         {
		// //   if (CsI_E[j] > -20)
		// //     {
		// //       cout << "Event Number = " << i << " Event Mult = " << j << " ID = " << CsI_ID[j] << " Charge = " << CsI_E[j] << endl;
		// //     }
		// // }

		// // cout << "CsI OK" << endl;

		// Histogram filling.
		for (int j = 0; j < 7; j++)
		{
			if (FE91_X_I[2][0][j] > 0.)
			{
				h_FE91_X_Q0->Fill(FE91_X_I[0][0][j], FE91_X_I[2][0][j]);
			}
			if (FE91_X_I_C[2][0][j] > 0.)
			{
				h_FE91_X_C_Q0->Fill(FE91_X_I_C[0][0][j], FE91_X_I_C[2][0][j]);
			}
			if (FE91_X_I_C2[2][0][j] > 0.)
			{
				h_FE91_X_C2_Q0->Fill(FE91_X_I_C2[0][0][j], FE91_X_I_C2[2][0][j]);
			}
			if (FE91_Y_I[2][0][j] > 0.)
			{
				h_FE91_Y_Q0->Fill(FE91_Y_I[0][0][j], FE91_Y_I[2][0][j]);
			}
			if (FE91_Y_I_C[2][0][j] > 0.)
			{
				h_FE91_Y_C_Q0->Fill(FE91_Y_I_C[0][0][j], FE91_Y_I_C[2][0][j]);
			}
			if (FE91_Y_I_C2[2][0][j] > 0.)
			{
				h_FE91_Y_C2_Q0->Fill(FE91_Y_I_C2[0][0][j], FE91_Y_I_C2[2][0][j]);
			}
			if (FE91_X_I[2][1][j] > 0.)
			{
				h_FE91_X_Q1->Fill(FE91_X_I[0][1][j], FE91_X_I[2][1][j]);
			}
			if (FE91_X_I_C[2][1][j] > 0.)
			{
				h_FE91_X_C_Q1->Fill(FE91_X_I_C[0][1][j], FE91_X_I_C[2][1][j]);
			}
			if (FE91_X_I_C2[2][1][j] > 0.)
			{
				h_FE91_X_C2_Q1->Fill(FE91_X_I_C2[0][0][j], FE91_X_I_C2[2][1][j]);
			}
			if (FE91_Y_I[2][1][j] > 0.)
			{
				h_FE91_Y_Q1->Fill(FE91_Y_I[0][1][j], FE91_Y_I[2][1][j]);
			}
			if (FE91_Y_I_C[2][1][j] > 0.)
			{
				h_FE91_Y_C_Q1->Fill(FE91_Y_I_C[0][1][j], FE91_Y_I_C[2][1][j]);
			}
			if (FE91_Y_I_C2[2][1][j] > 0.)
			{
				h_FE91_Y_C2_Q1->Fill(FE91_Y_I_C2[0][1][j], FE91_Y_I_C2[2][1][j]);
			}
			if (FE91_X_I[2][2][j] > 0.)
			{
				h_FE91_X_Q2->Fill(FE91_X_I[0][2][j], FE91_X_I[2][2][j]);
			}
			if (FE91_X_I_C[2][2][j] > 0.)
			{
				h_FE91_X_C_Q2->Fill(FE91_X_I_C[0][2][j], FE91_X_I_C[2][2][j]);
			}
			if (FE91_X_I_C2[2][2][j] > 0.)
			{
				h_FE91_X_C2_Q2->Fill(FE91_X_I_C2[0][2][j], FE91_X_I_C2[2][2][j]);
			}
			if (FE91_Y_I[2][2][j] > 0.)
			{
				h_FE91_Y_Q2->Fill(FE91_Y_I[0][2][j], FE91_Y_I[2][2][j]);
			}
			if (FE91_Y_I_C[2][2][j] > 0.)
			{
				h_FE91_Y_C_Q2->Fill(FE91_Y_I_C[0][2][j], FE91_Y_I_C[2][2][j]);
			}
			if (FE91_Y_I_C2[2][2][j] > 0.)
			{
				h_FE91_Y_C2_Q2->Fill(FE91_Y_I_C2[0][2][j], FE91_Y_I_C2[2][2][j]);
			}
			if (FE91_X_I[2][3][j] > 0.)
			{
				h_FE91_X_Q3->Fill(FE91_X_I[0][3][j], FE91_X_I[2][3][j]);
			}
			if (FE91_X_I_C[2][3][j] > 0.)
			{
				h_FE91_X_C_Q3->Fill(FE91_X_I_C[0][3][j], FE91_X_I_C[2][3][j]);
			}
			if (FE91_X_I_C2[2][3][j] > 0.)
			{
				h_FE91_X_C2_Q3->Fill(FE91_X_I_C2[0][3][j], FE91_X_I_C2[2][3][j]);
			}
			if (FE91_Y_I[2][3][j] > 0.)
			{
				h_FE91_Y_Q3->Fill(FE91_Y_I[0][3][j], FE91_Y_I[2][3][j]);
			}
			if (FE91_Y_I_C[2][3][j] > 0.)
			{
				h_FE91_Y_C_Q3->Fill(FE91_Y_I_C[0][3][j], FE91_Y_I_C[2][3][j]);
			}
			if (FE91_Y_I_C2[2][3][j] > 0.)
			{
				h_FE91_Y_C2_Q3->Fill(FE91_Y_I_C2[0][3][j], FE91_Y_I_C2[2][3][j]);
			}
			if (FE91_X_I[2][4][j] > 0.)
			{
				h_FE91_X_Q4->Fill(FE91_X_I[0][4][j], FE91_X_I[2][4][j]);
			}
			if (FE91_X_I_C[2][4][j] > 0.)
			{
				h_FE91_X_C_Q4->Fill(FE91_X_I_C[0][4][j], FE91_X_I_C[2][4][j]);
			}
			if (FE91_X_I_C2[2][4][j] > 0.)
			{
				h_FE91_X_C2_Q4->Fill(FE91_X_I_C2[0][0][j], FE91_X_I_C2[2][4][j]);
			}
			if (FE91_Y_I[2][4][j] > 0.)
			{
				h_FE91_Y_Q4->Fill(FE91_Y_I[0][4][j], FE91_Y_I[2][4][j]);
			}
			if (FE91_Y_I_C[2][4][j] > 0.)
			{
				h_FE91_Y_C_Q4->Fill(FE91_Y_I_C[0][4][j], FE91_Y_I_C[2][4][j]);
			}
			if (FE91_Y_I_C2[2][4][j] > 0.)
			{
				h_FE91_Y_C2_Q4->Fill(FE91_Y_I_C2[0][4][j], FE91_Y_I_C2[2][4][j]);
			}
			if (FE91_X_I[2][5][j] > 0.)
			{
				h_FE91_X_Q5->Fill(FE91_X_I[0][5][j], FE91_X_I[2][5][j]);
			}
			if (FE91_X_I_C[2][5][j] > 0.)
			{
				h_FE91_X_C_Q5->Fill(FE91_X_I_C[0][5][j], FE91_X_I_C[2][5][j]);
			}
			if (FE91_X_I_C2[2][5][j] > 0.)
			{
				h_FE91_X_C2_Q5->Fill(FE91_X_I_C2[0][0][j], FE91_X_I_C2[2][5][j]);
			}
			if (FE91_Y_I[2][5][j] > 0.)
			{
				h_FE91_Y_Q5->Fill(FE91_Y_I[0][5][j], FE91_Y_I[2][5][j]);
			}
			if (FE91_Y_I_C[2][5][j] > 0.)
			{
				h_FE91_Y_C_Q5->Fill(FE91_Y_I_C[0][5][j], FE91_Y_I_C[2][5][j]);
			}
			if (FE91_Y_I_C2[2][5][j] > 0.)
			{
				h_FE91_Y_C2_Q5->Fill(FE91_Y_I_C2[0][5][j], FE91_Y_I_C2[2][5][j]);
			}
			if (FE92_X_I[2][0][j] > 0.)
			{
				h_FE92_X_Q0->Fill(FE92_X_I[0][0][j], FE92_X_I[2][0][j]);
			}
			if (FE92_X_I_C[2][0][j] > 0.)
			{
				h_FE92_X_C_Q0->Fill(FE92_X_I_C[0][0][j], FE92_X_I_C[2][0][j]);
			}
			if (FE92_X_I_C2[2][0][j] > 0.)
			{
				h_FE92_X_C2_Q0->Fill(FE92_X_I_C2[0][0][j], FE92_X_I_C2[2][0][j]);
			}
			if (FE92_Y_I[2][0][j] > 0.)
			{
				h_FE92_Y_Q0->Fill(FE92_Y_I[0][0][j], FE92_Y_I[2][0][j]);
			}
			if (FE92_Y_I_C[2][0][j] > 0.)
			{
				h_FE92_Y_C_Q0->Fill(FE92_Y_I_C[0][0][j], FE92_Y_I_C[2][0][j]);
			}
			if (FE92_Y_I_C2[2][0][j] > 0.)
			{
				h_FE92_Y_C2_Q0->Fill(FE92_Y_I_C2[0][0][j], FE92_Y_I_C2[2][0][j]);
			}
			if (FE92_X_I[2][1][j] > 0.)
			{
				h_FE92_X_Q1->Fill(FE92_X_I[0][1][j], FE92_X_I[2][1][j]);
			}
			if (FE92_X_I_C[2][1][j] > 0.)
			{
				h_FE92_X_C_Q1->Fill(FE92_X_I_C[0][1][j], FE92_X_I_C[2][1][j]);
			}
			if (FE92_X_I_C2[2][1][j] > 0.)
			{
				h_FE92_X_C2_Q1->Fill(FE92_X_I_C2[0][0][j], FE92_X_I_C2[2][1][j]);
			}
			if (FE92_Y_I[2][1][j] > 0.)
			{
				h_FE92_Y_Q1->Fill(FE92_Y_I[0][1][j], FE92_Y_I[2][1][j]);
			}
			if (FE92_Y_I_C[2][1][j] > 0.)
			{
				h_FE92_Y_C_Q1->Fill(FE92_Y_I_C[0][1][j], FE92_Y_I_C[2][1][j]);
			}
			if (FE92_Y_I_C2[2][1][j] > 0.)
			{
				h_FE92_Y_C2_Q1->Fill(FE92_Y_I_C2[0][1][j], FE92_Y_I_C2[2][1][j]);
			}
			if (FE92_X_I[2][2][j] > 0.)
			{
				h_FE92_X_Q2->Fill(FE92_X_I[0][2][j], FE92_X_I[2][2][j]);
			}
			if (FE92_X_I_C[2][2][j] > 0.)
			{
				h_FE92_X_C_Q2->Fill(FE92_X_I_C[0][2][j], FE92_X_I_C[2][2][j]);
			}
			if (FE92_X_I_C2[2][2][j] > 0.)
			{
				h_FE92_X_C2_Q2->Fill(FE92_X_I_C2[0][2][j], FE92_X_I_C2[2][2][j]);
			}
			if (FE92_Y_I[2][2][j] > 0.)
			{
				h_FE92_Y_Q2->Fill(FE92_Y_I[0][2][j], FE92_Y_I[2][2][j]);
			}
			if (FE92_Y_I_C[2][2][j] > 0.)
			{
				h_FE92_Y_C_Q2->Fill(FE92_Y_I_C[0][2][j], FE92_Y_I_C[2][2][j]);
			}
			if (FE92_Y_I_C2[2][2][j] > 0.)
			{
				h_FE92_Y_C2_Q2->Fill(FE92_Y_I_C2[0][2][j], FE92_Y_I_C2[2][2][j]);
			}
			if (FE92_X_I[2][3][j] > 0.)
			{
				h_FE92_X_Q3->Fill(FE92_X_I[0][3][j], FE92_X_I[2][3][j]);
			}
			if (FE92_X_I_C[2][3][j] > 0.)
			{
				h_FE92_X_C_Q3->Fill(FE92_X_I_C[0][3][j], FE92_X_I_C[2][3][j]);
			}
			if (FE92_X_I_C2[2][3][j] > 0.)
			{
				h_FE92_X_C2_Q3->Fill(FE92_X_I_C2[0][3][j], FE92_X_I_C2[2][3][j]);
			}
			if (FE92_Y_I[2][3][j] > 0.)
			{
				h_FE92_Y_Q3->Fill(FE92_Y_I[0][3][j], FE92_Y_I[2][3][j]);
			}
			if (FE92_Y_I_C[2][3][j] > 0.)
			{
				h_FE92_Y_C_Q3->Fill(FE92_Y_I_C[0][3][j], FE92_Y_I_C[2][3][j]);
			}
			if (FE92_Y_I_C2[2][3][j] > 0.)
			{
				h_FE92_Y_C2_Q3->Fill(FE92_Y_I_C2[0][3][j], FE92_Y_I_C2[2][3][j]);
			}
			if (FE92_X_I[2][4][j] > 0.)
			{
				h_FE92_X_Q4->Fill(FE92_X_I[0][4][j], FE92_X_I[2][4][j]);
			}
			if (FE92_X_I_C[2][4][j] > 0.)
			{
				h_FE92_X_C_Q4->Fill(FE92_X_I_C[0][4][j], FE92_X_I_C[2][4][j]);
			}
			if (FE92_X_I_C2[2][4][j] > 0.)
			{
				h_FE92_X_C2_Q4->Fill(FE92_X_I_C2[0][0][j], FE92_X_I_C2[2][4][j]);
			}
			if (FE92_Y_I[2][4][j] > 0.)
			{
				h_FE92_Y_Q4->Fill(FE92_Y_I[0][4][j], FE92_Y_I[2][4][j]);
			}
			if (FE92_Y_I_C[2][4][j] > 0.)
			{
				h_FE92_Y_C_Q4->Fill(FE92_Y_I_C[0][4][j], FE92_Y_I_C[2][4][j]);
			}
			if (FE92_Y_I_C2[2][4][j] > 0.)
			{
				h_FE92_Y_C2_Q4->Fill(FE92_Y_I_C2[0][4][j], FE92_Y_I_C2[2][4][j]);
			}
			if (FE92_X_I[2][5][j] > 0.)
			{
				h_FE92_X_Q5->Fill(FE92_X_I[0][5][j], FE92_X_I[2][5][j]);
			}
			if (FE92_X_I_C[2][5][j] > 0.)
			{
				h_FE92_X_C_Q5->Fill(FE92_X_I_C[0][5][j], FE92_X_I_C[2][5][j]);
			}
			if (FE92_X_I_C2[2][5][j] > 0.)
			{
				h_FE92_X_C2_Q5->Fill(FE92_X_I_C2[0][0][j], FE92_X_I_C2[2][5][j]);
			}
			if (FE92_Y_I[2][5][j] > 0.)
			{
				h_FE92_Y_Q5->Fill(FE92_Y_I[0][5][j], FE92_Y_I[2][5][j]);
			}
			if (FE92_Y_I_C[2][5][j] > 0.)
			{
				h_FE92_Y_C_Q5->Fill(FE92_Y_I_C[0][5][j], FE92_Y_I_C[2][5][j]);
			}
			if (FE92_Y_I_C2[2][5][j] > 0.)
			{
				h_FE92_Y_C2_Q5->Fill(FE92_Y_I_C2[0][5][j], FE92_Y_I_C2[2][5][j]);
			}

			if (FE121_X_I[2][0][j] > 0.)
			{
				h_FE121_X_Q0->Fill(FE121_X_I[0][0][j], FE121_X_I[2][0][j]);
			}
			if (FE121_X_I_C[2][0][j] > 0.)
			{
				h_FE121_X_C_Q0->Fill(FE121_X_I_C[0][0][j], FE121_X_I_C[2][0][j]);
			}
			if (FE121_X_I_C2[2][0][j] > 0.)
			{
				h_FE121_X_C2_Q0->Fill(FE121_X_I_C2[0][0][j], FE121_X_I_C2[2][0][j]);
			}
			if (FE121_Y_I[2][0][j] > 0.)
			{
				h_FE121_Y_Q0->Fill(FE121_Y_I[0][0][j], FE121_Y_I[2][0][j]);
			}
			if (FE121_Y_I_C[2][0][j] > 0.)
			{
				h_FE121_Y_C_Q0->Fill(FE121_Y_I_C[0][0][j], FE121_Y_I_C[2][0][j]);
			}
			if (FE121_Y_I_C2[2][0][j] > 0.)
			{
				h_FE121_Y_C2_Q0->Fill(FE121_Y_I_C2[0][0][j], FE121_Y_I_C2[2][0][j]);
			}
			if (FE121_X_I[2][1][j] > 0.)
			{
				h_FE121_X_Q1->Fill(FE121_X_I[0][1][j], FE121_X_I[2][1][j]);
			}
			if (FE121_X_I_C[2][1][j] > 0.)
			{
				h_FE121_X_C_Q1->Fill(FE121_X_I_C[0][1][j], FE121_X_I_C[2][1][j]);
			}
			if (FE121_X_I_C2[2][1][j] > 0.)
			{
				h_FE121_X_C2_Q1->Fill(FE121_X_I_C2[0][0][j], FE121_X_I_C2[2][1][j]);
			}
			if (FE121_Y_I[2][1][j] > 0.)
			{
				h_FE121_Y_Q1->Fill(FE121_Y_I[0][1][j], FE121_Y_I[2][1][j]);
			}
			if (FE121_Y_I_C[2][1][j] > 0.)
			{
				h_FE121_Y_C_Q1->Fill(FE121_Y_I_C[0][1][j], FE121_Y_I_C[2][1][j]);
			}
			if (FE121_Y_I_C2[2][1][j] > 0.)
			{
				h_FE121_Y_C2_Q1->Fill(FE121_Y_I_C2[0][1][j], FE121_Y_I_C2[2][1][j]);
			}
			if (FE121_X_I[2][2][j] > 0.)
			{
				h_FE121_X_Q2->Fill(FE121_X_I[0][2][j], FE121_X_I[2][2][j]);
			}
			if (FE121_X_I_C[2][2][j] > 0.)
			{
				h_FE121_X_C_Q2->Fill(FE121_X_I_C[0][2][j], FE121_X_I_C[2][2][j]);
			}
			if (FE121_X_I_C2[2][2][j] > 0.)
			{
				h_FE121_X_C2_Q2->Fill(FE121_X_I_C2[0][2][j], FE121_X_I_C2[2][2][j]);
			}
			if (FE121_Y_I[2][2][j] > 0.)
			{
				h_FE121_Y_Q2->Fill(FE121_Y_I[0][2][j], FE121_Y_I[2][2][j]);
			}
			if (FE121_Y_I_C[2][2][j] > 0.)
			{
				h_FE121_Y_C_Q2->Fill(FE121_Y_I_C[0][2][j], FE121_Y_I_C[2][2][j]);
			}
			if (FE121_Y_I_C2[2][2][j] > 0.)
			{
				h_FE121_Y_C2_Q2->Fill(FE121_Y_I_C2[0][2][j], FE121_Y_I_C2[2][2][j]);
			}
			if (FE121_X_I[2][3][j] > 0.)
			{
				h_FE121_X_Q3->Fill(FE121_X_I[0][3][j], FE121_X_I[2][3][j]);
			}
			if (FE121_X_I_C[2][3][j] > 0.)
			{
				h_FE121_X_C_Q3->Fill(FE121_X_I_C[0][3][j], FE121_X_I_C[2][3][j]);
			}
			if (FE121_X_I_C2[2][3][j] > 0.)
			{
				h_FE121_X_C2_Q3->Fill(FE121_X_I_C2[0][3][j], FE121_X_I_C2[2][3][j]);
			}
			if (FE121_Y_I[2][3][j] > 0.)
			{
				h_FE121_Y_Q3->Fill(FE121_Y_I[0][3][j], FE121_Y_I[2][3][j]);
			}
			if (FE121_Y_I_C[2][3][j] > 0.)
			{
				h_FE121_Y_C_Q3->Fill(FE121_Y_I_C[0][3][j], FE121_Y_I_C[2][3][j]);
			}
			if (FE121_Y_I_C2[2][3][j] > 0.)
			{
				h_FE121_Y_C2_Q3->Fill(FE121_Y_I_C2[0][3][j], FE121_Y_I_C2[2][3][j]);
			}
			if (FE121_X_I[2][4][j] > 0.)
			{
				h_FE121_X_Q4->Fill(FE121_X_I[0][4][j], FE121_X_I[2][4][j]);
			}
			if (FE121_X_I_C[2][4][j] > 0.)
			{
				h_FE121_X_C_Q4->Fill(FE121_X_I_C[0][4][j], FE121_X_I_C[2][4][j]);
			}
			if (FE121_X_I_C2[2][4][j] > 0.)
			{
				h_FE121_X_C2_Q4->Fill(FE121_X_I_C2[0][0][j], FE121_X_I_C2[2][4][j]);
			}
			if (FE121_Y_I[2][4][j] > 0.)
			{
				h_FE121_Y_Q4->Fill(FE121_Y_I[0][4][j], FE121_Y_I[2][4][j]);
			}
			if (FE121_Y_I_C[2][4][j] > 0.)
			{
				h_FE121_Y_C_Q4->Fill(FE121_Y_I_C[0][4][j], FE121_Y_I_C[2][4][j]);
			}
			if (FE121_Y_I_C2[2][4][j] > 0.)
			{
				h_FE121_Y_C2_Q4->Fill(FE121_Y_I_C2[0][4][j], FE121_Y_I_C2[2][4][j]);
			}
			if (FE121_X_I[2][5][j] > 0.)
			{
				h_FE121_X_Q5->Fill(FE121_X_I[0][5][j], FE121_X_I[2][5][j]);
			}
			if (FE121_X_I_C[2][5][j] > 0.)
			{
				h_FE121_X_C_Q5->Fill(FE121_X_I_C[0][5][j], FE121_X_I_C[2][5][j]);
			}
			if (FE121_X_I_C2[2][5][j] > 0.)
			{
				h_FE121_X_C2_Q5->Fill(FE121_X_I_C2[0][0][j], FE121_X_I_C2[2][5][j]);
			}
			if (FE121_Y_I[2][5][j] > 0.)
			{
				h_FE121_Y_Q5->Fill(FE121_Y_I[0][5][j], FE121_Y_I[2][5][j]);
			}
			if (FE121_Y_I_C[2][5][j] > 0.)
			{
				h_FE121_Y_C_Q5->Fill(FE121_Y_I_C[0][5][j], FE121_Y_I_C[2][5][j]);
			}
			if (FE121_Y_I_C2[2][5][j] > 0.)
			{
				h_FE121_Y_C2_Q5->Fill(FE121_Y_I_C2[0][5][j], FE121_Y_I_C2[2][5][j]);
			}
			if (FE122_X_I[2][0][j] > 0.)
			{
				h_FE122_X_Q0->Fill(FE122_X_I[0][0][j], FE122_X_I[2][0][j]);
			}
			if (FE122_X_I_C[2][0][j] > 0.)
			{
				h_FE122_X_C_Q0->Fill(FE122_X_I_C[0][0][j], FE122_X_I_C[2][0][j]);
			}
			if (FE122_X_I_C2[2][0][j] > 0.)
			{
				h_FE122_X_C2_Q0->Fill(FE122_X_I_C2[0][0][j], FE122_X_I_C2[2][0][j]);
			}
			if (FE122_Y_I[2][0][j] > 0.)
			{
				h_FE122_Y_Q0->Fill(FE122_Y_I[0][0][j], FE122_Y_I[2][0][j]);
			}
			if (FE122_Y_I_C[2][0][j] > 0.)
			{
				h_FE122_Y_C_Q0->Fill(FE122_Y_I_C[0][0][j], FE122_Y_I_C[2][0][j]);
			}
			if (FE122_Y_I_C2[2][0][j] > 0.)
			{
				h_FE122_Y_C2_Q0->Fill(FE122_Y_I_C2[0][0][j], FE122_Y_I_C2[2][0][j]);
			}
			if (FE122_X_I[2][1][j] > 0.)
			{
				h_FE122_X_Q1->Fill(FE122_X_I[0][1][j], FE122_X_I[2][1][j]);
			}
			if (FE122_X_I_C[2][1][j] > 0.)
			{
				h_FE122_X_C_Q1->Fill(FE122_X_I_C[0][1][j], FE122_X_I_C[2][1][j]);
			}
			if (FE122_X_I_C2[2][1][j] > 0.)
			{
				h_FE122_X_C2_Q1->Fill(FE122_X_I_C2[0][0][j], FE122_X_I_C2[2][1][j]);
			}
			if (FE122_Y_I[2][1][j] > 0.)
			{
				h_FE122_Y_Q1->Fill(FE122_Y_I[0][1][j], FE122_Y_I[2][1][j]);
			}
			if (FE122_Y_I_C[2][1][j] > 0.)
			{
				h_FE122_Y_C_Q1->Fill(FE122_Y_I_C[0][1][j], FE122_Y_I_C[2][1][j]);
			}
			if (FE122_Y_I_C2[2][1][j] > 0.)
			{
				h_FE122_Y_C2_Q1->Fill(FE122_Y_I_C2[0][1][j], FE122_Y_I_C2[2][1][j]);
			}
			if (FE122_X_I[2][2][j] > 0.)
			{
				h_FE122_X_Q2->Fill(FE122_X_I[0][2][j], FE122_X_I[2][2][j]);
			}
			if (FE122_X_I_C[2][2][j] > 0.)
			{
				h_FE122_X_C_Q2->Fill(FE122_X_I_C[0][2][j], FE122_X_I_C[2][2][j]);
			}
			if (FE122_X_I_C2[2][2][j] > 0.)
			{
				h_FE122_X_C2_Q2->Fill(FE122_X_I_C2[0][2][j], FE122_X_I_C2[2][2][j]);
			}
			if (FE122_Y_I[2][2][j] > 0.)
			{
				h_FE122_Y_Q2->Fill(FE122_Y_I[0][2][j], FE122_Y_I[2][2][j]);
			}
			if (FE122_Y_I_C[2][2][j] > 0.)
			{
				h_FE122_Y_C_Q2->Fill(FE122_Y_I_C[0][2][j], FE122_Y_I_C[2][2][j]);
			}
			if (FE122_Y_I_C2[2][2][j] > 0.)
			{
				h_FE122_Y_C2_Q2->Fill(FE122_Y_I_C2[0][2][j], FE122_Y_I_C2[2][2][j]);
			}
			if (FE122_X_I[2][3][j] > 0.)
			{
				h_FE122_X_Q3->Fill(FE122_X_I[0][3][j], FE122_X_I[2][3][j]);
			}
			if (FE122_X_I_C[2][3][j] > 0.)
			{
				h_FE122_X_C_Q3->Fill(FE122_X_I_C[0][3][j], FE122_X_I_C[2][3][j]);
			}
			if (FE122_X_I_C2[2][3][j] > 0.)
			{
				h_FE122_X_C2_Q3->Fill(FE122_X_I_C2[0][3][j], FE122_X_I_C2[2][3][j]);
			}
			if (FE122_Y_I[2][3][j] > 0.)
			{
				h_FE122_Y_Q3->Fill(FE122_Y_I[0][3][j], FE122_Y_I[2][3][j]);
			}
			if (FE122_Y_I_C[2][3][j] > 0.)
			{
				h_FE122_Y_C_Q3->Fill(FE122_Y_I_C[0][3][j], FE122_Y_I_C[2][3][j]);
			}
			if (FE122_Y_I_C2[2][3][j] > 0.)
			{
				h_FE122_Y_C2_Q3->Fill(FE122_Y_I_C2[0][3][j], FE122_Y_I_C2[2][3][j]);
			}
			if (FE122_X_I[2][4][j] > 0.)
			{
				h_FE122_X_Q4->Fill(FE122_X_I[0][4][j], FE122_X_I[2][4][j]);
			}
			if (FE122_X_I_C[2][4][j] > 0.)
			{
				h_FE122_X_C_Q4->Fill(FE122_X_I_C[0][4][j], FE122_X_I_C[2][4][j]);
			}
			if (FE122_X_I_C2[2][4][j] > 0.)
			{
				h_FE122_X_C2_Q4->Fill(FE122_X_I_C2[0][0][j], FE122_X_I_C2[2][4][j]);
			}
			if (FE122_Y_I[2][4][j] > 0.)
			{
				h_FE122_Y_Q4->Fill(FE122_Y_I[0][4][j], FE122_Y_I[2][4][j]);
			}
			if (FE122_Y_I_C[2][4][j] > 0.)
			{
				h_FE122_Y_C_Q4->Fill(FE122_Y_I_C[0][4][j], FE122_Y_I_C[2][4][j]);
			}
			if (FE122_Y_I_C2[2][4][j] > 0.)
			{
				h_FE122_Y_C2_Q4->Fill(FE122_Y_I_C2[0][4][j], FE122_Y_I_C2[2][4][j]);
			}
			if (FE122_X_I[2][5][j] > 0.)
			{
				h_FE122_X_Q5->Fill(FE122_X_I[0][5][j], FE122_X_I[2][5][j]);
			}
			if (FE122_X_I_C[2][5][j] > 0.)
			{
				h_FE122_X_C_Q5->Fill(FE122_X_I_C[0][5][j], FE122_X_I_C[2][5][j]);
			}
			if (FE122_X_I_C2[2][5][j] > 0.)
			{
				h_FE122_X_C2_Q5->Fill(FE122_X_I_C2[0][0][j], FE122_X_I_C2[2][5][j]);
			}
			if (FE122_Y_I[2][5][j] > 0.)
			{
				h_FE122_Y_Q5->Fill(FE122_Y_I[0][5][j], FE122_Y_I[2][5][j]);
			}
			if (FE122_Y_I_C[2][5][j] > 0.)
			{
				h_FE122_Y_C_Q5->Fill(FE122_Y_I_C[0][5][j], FE122_Y_I_C[2][5][j]);
			}
			if (FE122_Y_I_C2[2][5][j] > 0.)
			{
				h_FE122_Y_C2_Q5->Fill(FE122_Y_I_C2[0][5][j], FE122_Y_I_C2[2][5][j]);
			}

			if (S11_X_I[2][0][j] > 0.)
			{
				h_S11_X_Q0->Fill(S11_X_I[0][0][j], S11_X_I[2][0][j]);
			}
			if (S11_X_I_C[2][0][j] > 0.)
			{
				h_S11_X_C_Q0->Fill(S11_X_I_C[0][0][j], S11_X_I_C[2][0][j]);
			}
			if (S11_X_I_C2[2][0][j] > 0.)
			{
				h_S11_X_C2_Q0->Fill(S11_X_I_C2[0][0][j], S11_X_I_C2[2][0][j]);
			}
			if (S11_Y_I[2][0][j] > 0.)
			{
				h_S11_Y_Q0->Fill(S11_Y_I[0][0][j], S11_Y_I[2][0][j]);
			}
			if (S11_Y_I_C[2][0][j] > 0.)
			{
				h_S11_Y_C_Q0->Fill(S11_Y_I_C[0][0][j], S11_Y_I_C[2][0][j]);
			}
			if (S11_Y_I_C2[2][0][j] > 0.)
			{
				h_S11_Y_C2_Q0->Fill(S11_Y_I_C2[0][0][j], S11_Y_I_C2[2][0][j]);
			}
			if (S11_X_I[2][1][j] > 0.)
			{
				h_S11_X_Q1->Fill(S11_X_I[0][1][j], S11_X_I[2][1][j]);
			}
			if (S11_X_I_C[2][1][j] > 0.)
			{
				h_S11_X_C_Q1->Fill(S11_X_I_C[0][1][j], S11_X_I_C[2][1][j]);
			}
			if (S11_X_I_C2[2][1][j] > 0.)
			{
				h_S11_X_C2_Q1->Fill(S11_X_I_C2[0][0][j], S11_X_I_C2[2][1][j]);
			}
			if (S11_Y_I[2][1][j] > 0.)
			{
				h_S11_Y_Q1->Fill(S11_Y_I[0][1][j], S11_Y_I[2][1][j]);
			}
			if (S11_Y_I_C[2][1][j] > 0.)
			{
				h_S11_Y_C_Q1->Fill(S11_Y_I_C[0][1][j], S11_Y_I_C[2][1][j]);
			}
			if (S11_Y_I_C2[2][1][j] > 0.)
			{
				h_S11_Y_C2_Q1->Fill(S11_Y_I_C2[0][1][j], S11_Y_I_C2[2][1][j]);
			}
			if (S11_X_I[2][2][j] > 0.)
			{
				h_S11_X_Q2->Fill(S11_X_I[0][2][j], S11_X_I[2][2][j]);
			}
			if (S11_X_I_C[2][2][j] > 0.)
			{
				h_S11_X_C_Q2->Fill(S11_X_I_C[0][2][j], S11_X_I_C[2][2][j]);
			}
			if (S11_X_I_C2[2][2][j] > 0.)
			{
				h_S11_X_C2_Q2->Fill(S11_X_I_C2[0][2][j], S11_X_I_C2[2][2][j]);
			}
			if (S11_Y_I[2][2][j] > 0.)
			{
				h_S11_Y_Q2->Fill(S11_Y_I[0][2][j], S11_Y_I[2][2][j]);
			}
			if (S11_Y_I_C[2][2][j] > 0.)
			{
				h_S11_Y_C_Q2->Fill(S11_Y_I_C[0][2][j], S11_Y_I_C[2][2][j]);
			}
			if (S11_Y_I_C2[2][2][j] > 0.)
			{
				h_S11_Y_C2_Q2->Fill(S11_Y_I_C2[0][2][j], S11_Y_I_C2[2][2][j]);
			}
			if (S11_X_I[2][3][j] > 0.)
			{
				h_S11_X_Q3->Fill(S11_X_I[0][3][j], S11_X_I[2][3][j]);
			}
			if (S11_X_I_C[2][3][j] > 0.)
			{
				h_S11_X_C_Q3->Fill(S11_X_I_C[0][3][j], S11_X_I_C[2][3][j]);
			}
			if (S11_X_I_C2[2][3][j] > 0.)
			{
				h_S11_X_C2_Q3->Fill(S11_X_I_C2[0][3][j], S11_X_I_C2[2][3][j]);
			}
			if (S11_Y_I[2][3][j] > 0.)
			{
				h_S11_Y_Q3->Fill(S11_Y_I[0][3][j], S11_Y_I[2][3][j]);
			}
			if (S11_Y_I_C[2][3][j] > 0.)
			{
				h_S11_Y_C_Q3->Fill(S11_Y_I_C[0][3][j], S11_Y_I_C[2][3][j]);
			}
			if (S11_Y_I_C2[2][3][j] > 0.)
			{
				h_S11_Y_C2_Q3->Fill(S11_Y_I_C2[0][3][j], S11_Y_I_C2[2][3][j]);
			}
			if (S11_X_I[2][4][j] > 0.)
			{
				h_S11_X_Q4->Fill(S11_X_I[0][4][j], S11_X_I[2][4][j]);
			}
			if (S11_X_I_C[2][4][j] > 0.)
			{
				h_S11_X_C_Q4->Fill(S11_X_I_C[0][4][j], S11_X_I_C[2][4][j]);
			}
			if (S11_X_I_C2[2][4][j] > 0.)
			{
				h_S11_X_C2_Q4->Fill(S11_X_I_C2[0][0][j], S11_X_I_C2[2][4][j]);
			}
			if (S11_Y_I[2][4][j] > 0.)
			{
				h_S11_Y_Q4->Fill(S11_Y_I[0][4][j], S11_Y_I[2][4][j]);
			}
			if (S11_Y_I_C[2][4][j] > 0.)
			{
				h_S11_Y_C_Q4->Fill(S11_Y_I_C[0][4][j], S11_Y_I_C[2][4][j]);
			}
			if (S11_Y_I_C2[2][4][j] > 0.)
			{
				h_S11_Y_C2_Q4->Fill(S11_Y_I_C2[0][4][j], S11_Y_I_C2[2][4][j]);
			}
			if (S11_X_I[2][5][j] > 0.)
			{
				h_S11_X_Q5->Fill(S11_X_I[0][5][j], S11_X_I[2][5][j]);
			}
			if (S11_X_I_C[2][5][j] > 0.)
			{
				h_S11_X_C_Q5->Fill(S11_X_I_C[0][5][j], S11_X_I_C[2][5][j]);
			}
			if (S11_X_I_C2[2][5][j] > 0.)
			{
				h_S11_X_C2_Q5->Fill(S11_X_I_C2[0][0][j], S11_X_I_C2[2][5][j]);
			}
			if (S11_Y_I[2][5][j] > 0.)
			{
				h_S11_Y_Q5->Fill(S11_Y_I[0][5][j], S11_Y_I[2][5][j]);
			}
			if (S11_Y_I_C[2][5][j] > 0.)
			{
				h_S11_Y_C_Q5->Fill(S11_Y_I_C[0][5][j], S11_Y_I_C[2][5][j]);
			}
			if (S11_Y_I_C2[2][5][j] > 0.)
			{
				h_S11_Y_C2_Q5->Fill(S11_Y_I_C2[0][5][j], S11_Y_I_C2[2][5][j]);
			}
			if (S12_X_I[2][0][j] > 0.)
			{
				h_S12_X_Q0->Fill(S12_X_I[0][0][j], S12_X_I[2][0][j]);
			}
			if (S12_X_I_C[2][0][j] > 0.)
			{
				h_S12_X_C_Q0->Fill(S12_X_I_C[0][0][j], S12_X_I_C[2][0][j]);
			}
			if (S12_X_I_C2[2][0][j] > 0.)
			{
				h_S12_X_C2_Q0->Fill(S12_X_I_C2[0][0][j], S12_X_I_C2[2][0][j]);
			}
			if (S12_Y_I[2][0][j] > 0.)
			{
				h_S12_Y_Q0->Fill(S12_Y_I[0][0][j], S12_Y_I[2][0][j]);
			}
			if (S12_Y_I_C[2][0][j] > 0.)
			{
				h_S12_Y_C_Q0->Fill(S12_Y_I_C[0][0][j], S12_Y_I_C[2][0][j]);
			}
			if (S12_Y_I_C2[2][0][j] > 0.)
			{
				h_S12_Y_C2_Q0->Fill(S12_Y_I_C2[0][0][j], S12_Y_I_C2[2][0][j]);
			}
			if (S12_X_I[2][1][j] > 0.)
			{
				h_S12_X_Q1->Fill(S12_X_I[0][1][j], S12_X_I[2][1][j]);
			}
			if (S12_X_I_C[2][1][j] > 0.)
			{
				h_S12_X_C_Q1->Fill(S12_X_I_C[0][1][j], S12_X_I_C[2][1][j]);
			}
			if (S12_X_I_C2[2][1][j] > 0.)
			{
				h_S12_X_C2_Q1->Fill(S12_X_I_C2[0][0][j], S12_X_I_C2[2][1][j]);
			}
			if (S12_Y_I[2][1][j] > 0.)
			{
				h_S12_Y_Q1->Fill(S12_Y_I[0][1][j], S12_Y_I[2][1][j]);
			}
			if (S12_Y_I_C[2][1][j] > 0.)
			{
				h_S12_Y_C_Q1->Fill(S12_Y_I_C[0][1][j], S12_Y_I_C[2][1][j]);
			}
			if (S12_Y_I_C2[2][1][j] > 0.)
			{
				h_S12_Y_C2_Q1->Fill(S12_Y_I_C2[0][1][j], S12_Y_I_C2[2][1][j]);
			}
			if (S12_X_I[2][2][j] > 0.)
			{
				h_S12_X_Q2->Fill(S12_X_I[0][2][j], S12_X_I[2][2][j]);
			}
			if (S12_X_I_C[2][2][j] > 0.)
			{
				h_S12_X_C_Q2->Fill(S12_X_I_C[0][2][j], S12_X_I_C[2][2][j]);
			}
			if (S12_X_I_C2[2][2][j] > 0.)
			{
				h_S12_X_C2_Q2->Fill(S12_X_I_C2[0][2][j], S12_X_I_C2[2][2][j]);
			}
			if (S12_Y_I[2][2][j] > 0.)
			{
				h_S12_Y_Q2->Fill(S12_Y_I[0][2][j], S12_Y_I[2][2][j]);
			}
			if (S12_Y_I_C[2][2][j] > 0.)
			{
				h_S12_Y_C_Q2->Fill(S12_Y_I_C[0][2][j], S12_Y_I_C[2][2][j]);
			}
			if (S12_Y_I_C2[2][2][j] > 0.)
			{
				h_S12_Y_C2_Q2->Fill(S12_Y_I_C2[0][2][j], S12_Y_I_C2[2][2][j]);
			}
			if (S12_X_I[2][3][j] > 0.)
			{
				h_S12_X_Q3->Fill(S12_X_I[0][3][j], S12_X_I[2][3][j]);
			}
			if (S12_X_I_C[2][3][j] > 0.)
			{
				h_S12_X_C_Q3->Fill(S12_X_I_C[0][3][j], S12_X_I_C[2][3][j]);
			}
			if (S12_X_I_C2[2][3][j] > 0.)
			{
				h_S12_X_C2_Q3->Fill(S12_X_I_C2[0][3][j], S12_X_I_C2[2][3][j]);
			}
			if (S12_Y_I[2][3][j] > 0.)
			{
				h_S12_Y_Q3->Fill(S12_Y_I[0][3][j], S12_Y_I[2][3][j]);
			}
			if (S12_Y_I_C[2][3][j] > 0.)
			{
				h_S12_Y_C_Q3->Fill(S12_Y_I_C[0][3][j], S12_Y_I_C[2][3][j]);
			}
			if (S12_Y_I_C2[2][3][j] > 0.)
			{
				h_S12_Y_C2_Q3->Fill(S12_Y_I_C2[0][3][j], S12_Y_I_C2[2][3][j]);
			}
			if (S12_X_I[2][4][j] > 0.)
			{
				h_S12_X_Q4->Fill(S12_X_I[0][4][j], S12_X_I[2][4][j]);
			}
			if (S12_X_I_C[2][4][j] > 0.)
			{
				h_S12_X_C_Q4->Fill(S12_X_I_C[0][4][j], S12_X_I_C[2][4][j]);
			}
			if (S12_X_I_C2[2][4][j] > 0.)
			{
				h_S12_X_C2_Q4->Fill(S12_X_I_C2[0][0][j], S12_X_I_C2[2][4][j]);
			}
			if (S12_Y_I[2][4][j] > 0.)
			{
				h_S12_Y_Q4->Fill(S12_Y_I[0][4][j], S12_Y_I[2][4][j]);
			}
			if (S12_Y_I_C[2][4][j] > 0.)
			{
				h_S12_Y_C_Q4->Fill(S12_Y_I_C[0][4][j], S12_Y_I_C[2][4][j]);
			}
			if (S12_Y_I_C2[2][4][j] > 0.)
			{
				h_S12_Y_C2_Q4->Fill(S12_Y_I_C2[0][4][j], S12_Y_I_C2[2][4][j]);
			}
			if (S12_X_I[2][5][j] > 0.)
			{
				h_S12_X_Q5->Fill(S12_X_I[0][5][j], S12_X_I[2][5][j]);
			}
			if (S12_X_I_C[2][5][j] > 0.)
			{
				h_S12_X_C_Q5->Fill(S12_X_I_C[0][5][j], S12_X_I_C[2][5][j]);
			}
			if (S12_X_I_C2[2][5][j] > 0.)
			{
				h_S12_X_C2_Q5->Fill(S12_X_I_C2[0][0][j], S12_X_I_C2[2][5][j]);
			}
			if (S12_Y_I[2][5][j] > 0.)
			{
				h_S12_Y_Q5->Fill(S12_Y_I[0][5][j], S12_Y_I[2][5][j]);
			}
			if (S12_Y_I_C[2][5][j] > 0.)
			{
				h_S12_Y_C_Q5->Fill(S12_Y_I_C[0][5][j], S12_Y_I_C[2][5][j]);
			}
			if (S12_Y_I_C2[2][5][j] > 0.)
			{
				h_S12_Y_C2_Q5->Fill(S12_Y_I_C2[0][5][j], S12_Y_I_C2[2][5][j]);
			}

			h_FE91_X->Fill(FE91_X[j]);
			h_FE91_X_C->Fill(FE91_X_C[j]);
			h_FE91_X_C2->Fill(FE91_X_C2[j]);
			h_FE91_X_M->Fill(FE91_X_M[j]);
			h_FE91_X_M2->Fill(FE91_X_M2[j]);
			h_FE91_Y->Fill(FE91_Y[j]);
			h_FE91_Y_C->Fill(FE91_Y_C[j]);
			h_FE91_Y_C2->Fill(FE91_Y_C2[j]);
			h_FE91_Y_M->Fill(FE91_Y_M[j]);
			h_FE91_Y_M2->Fill(FE91_Y_M2[j]);
			h_FE121_X->Fill(FE121_X[j]);
			h_FE121_X_C->Fill(FE121_X_C[j]);
			h_FE121_X_C2->Fill(FE121_X_C2[j]);
			h_FE121_X_M->Fill(FE121_X_M[j]);
			h_FE121_X_M2->Fill(FE121_X_M2[j]);
			h_FE121_Y->Fill(FE121_Y[j]);
			h_FE121_Y_C->Fill(FE121_Y_C[j]);
			h_FE121_Y_C2->Fill(FE121_Y_C2[j]);
			h_FE121_Y_M->Fill(FE121_Y_M[j]);
			h_FE121_Y_M2->Fill(FE121_Y_M2[j]);
			h_S11_X->Fill(S11_X[j]);
			h_S11_X_C->Fill(S11_X_C[j]);
			h_S11_X_C2->Fill(S11_X_C2[j]);
			h_S11_X_M->Fill(S11_X_M[j]);
			h_S11_X_M2->Fill(S11_X_M2[j]);
			h_S11_Y->Fill(S11_Y[j]);
			h_S11_Y_C->Fill(S11_Y_C[j]);
			h_S11_Y_C2->Fill(S11_Y_C2[j]);
			h_S11_Y_M->Fill(S11_Y_M[j]);
			h_S11_Y_M2->Fill(S11_Y_M2[j]);

			h_FE92_X->Fill(FE92_X[j]);
			h_FE92_X_C->Fill(FE92_X_C[j]);
			h_FE92_X_C2->Fill(FE92_X_C2[j]);
			h_FE92_X_M->Fill(FE92_X_M[j]);
			h_FE92_X_M2->Fill(FE92_X_M2[j]);
			h_FE92_Y->Fill(FE92_Y[j]);
			h_FE92_Y_C->Fill(FE92_Y_C[j]);
			h_FE92_Y_C2->Fill(FE92_Y_C2[j]);
			h_FE92_Y_M->Fill(FE92_Y_M[j]);
			h_FE92_Y_M2->Fill(FE92_Y_M2[j]);
			h_FE122_X->Fill(FE122_X[j]);
			h_FE122_X_C->Fill(FE122_X_C[j]);
			h_FE122_X_C2->Fill(FE122_X_C2[j]);
			h_FE122_X_M->Fill(FE122_X_M[j]);
			h_FE122_X_M2->Fill(FE122_X_M2[j]);
			h_FE122_Y->Fill(FE122_Y[j]);
			h_FE122_Y_C->Fill(FE122_Y_C[j]);
			h_FE122_Y_C2->Fill(FE122_Y_C2[j]);
			h_FE122_Y_M->Fill(FE122_Y_M[j]);
			h_FE122_Y_M2->Fill(FE122_Y_M2[j]);
			h_S12_X->Fill(S12_X[j]);
			h_S12_X_C->Fill(S12_X_C[j]);
			h_S12_X_C2->Fill(S12_X_C2[j]);
			h_S12_X_M->Fill(S12_X_M[j]);
			h_S12_X_M2->Fill(S12_X_M2[j]);
			h_S12_Y->Fill(S12_Y[j]);
			h_S12_Y_C->Fill(S12_Y_C[j]);
			h_S12_Y_C2->Fill(S12_Y_C2[j]);
			h_S12_Y_M->Fill(S12_Y_M[j]);
			h_S12_Y_M2->Fill(S12_Y_M2[j]);

			h_FE9_X->Fill(FE9_X[j]);
			h_FE9_X_C->Fill(FE9_X_C[j]);
			h_FE9_X_C2->Fill(FE9_X_C2[j]);
			h_FE9_X_M->Fill(FE9_X_M[j]);
			h_FE9_X_M2->Fill(FE9_X_M2[j]);
			h_FE9_Y->Fill(FE9_Y[j]);
			h_FE9_Y_C->Fill(FE9_Y_C[j]);
			h_FE9_Y_C2->Fill(FE9_Y_C2[j]);
			h_FE9_Y_M->Fill(FE9_Y_M[j]);
			h_FE9_Y_M2->Fill(FE9_Y_M2[j]);
			h_FE12_X->Fill(FE12_X[j]);
			h_FE12_X_C->Fill(FE12_X_C[j]);
			h_FE12_X_C2->Fill(FE12_X_C2[j]);
			h_FE12_X_M->Fill(FE12_X_M[j]);
			h_FE12_X_M2->Fill(FE12_X_M2[j]);
			h_FE12_Y->Fill(FE12_Y[j]);
			h_FE12_Y_C->Fill(FE12_Y_C[j]);
			h_FE12_Y_C2->Fill(FE12_Y_C2[j]);
			h_FE12_Y_M->Fill(FE12_Y_M[j]);
			h_FE12_Y_M2->Fill(FE12_Y_M2[j]);
			h_S1_X->Fill(S1_X[j]);
			h_S1_X_C->Fill(S1_X_C[j]);
			h_S1_X_C2->Fill(S1_X_C2[j]);
			h_S1_X_M->Fill(S1_X_M[j]);
			h_S1_X_M2->Fill(S1_X_M2[j]);
			h_S1_Y->Fill(S1_Y[j]);
			h_S1_Y_C->Fill(S1_Y_C[j]);
			h_S1_Y_C2->Fill(S1_Y_C2[j]);
			h_S1_Y_M->Fill(S1_Y_M[j]);
			h_S1_Y_M2->Fill(S1_Y_M2[j]);

			if (FE9_X[j] > -500)
			{
				h_FE9_A->Fill(FE9_A[j] * 1000.);
			}
			if (FE9_X_C[j] > -500)
			{
				h_FE9_A_C->Fill(FE9_A_C[j] * 1000.);
			}
			if (FE9_X_C2[j] > -500)
			{
				h_FE9_A_C2->Fill(FE9_A_C2[j] * 1000.);
			}
			if (FE9_X_M[j] > -500)
			{
				h_FE9_A_M->Fill(FE9_A_M[j] * 1000.);
			}
			if (FE9_X_M2[j] > -500)
			{
				h_FE9_A_M2->Fill(FE9_A_M2[j] * 1000.);
			}

			if (FE9_Y[j] > -500)
			{
				h_FE9_B->Fill(FE9_B[j] * 1000.);
			}
			if (FE9_Y_C[j] > -500)
			{
				h_FE9_B_C->Fill(FE9_B_C[j] * 1000.);
			}
			if (FE9_Y_C2[j] > -500)
			{
				h_FE9_B_C2->Fill(FE9_B_C2[j] * 1000.);
			}
			if (FE9_Y_M[j] > -500)
			{
				h_FE9_B_M->Fill(FE9_B_M[j] * 1000.);
			}
			if (FE9_Y_M2[j] > -500)
			{
				h_FE9_B_M2->Fill(FE9_B_M2[j] * 1000.);
			}

			if (FE12_X[j] > -500)
			{
				h_FE12_A->Fill(FE12_A[j] * 1000.);
			}
			if (FE12_X_C[j] > -500)
			{
				h_FE12_A_C->Fill(FE12_A_C[j] * 1000.);
			}
			if (FE12_X_C2[j] > -500)
			{
				h_FE12_A_C2->Fill(FE12_A_C2[j] * 1000.);
			}
			if (FE12_X_M[j] > -500)
			{
				h_FE12_A_M->Fill(FE12_A_M[j] * 1000.);
			}
			if (FE12_X_M2[j] > -500)
			{
				h_FE12_A_M2->Fill(FE12_A_M2[j] * 1000.);
			}

			if (FE12_Y[j] > -500)
			{
				h_FE12_B->Fill(FE12_B[j] * 1000.);
			}
			if (FE12_Y_C[j] > -500)
			{
				h_FE12_B_C->Fill(FE12_B_C[j] * 1000.);
			}
			if (FE12_Y_C2[j] > -500)
			{
				h_FE12_B_C2->Fill(FE12_B_C2[j] * 1000.);
			}
			if (FE12_Y_M[j] > -500)
			{
				h_FE12_B_M->Fill(FE12_B_M[j] * 1000.);
			}
			if (FE12_Y_M2[j] > -500)
			{
				h_FE12_B_M2->Fill(FE12_B_M2[j] * 1000.);
			}

			if (S1_X[j] > -500)
			{
				h_S1_A->Fill(S1_A[j] * 1000.);
			}
			if (S1_X_C[j] > -500)
			{
				h_S1_A_C->Fill(S1_A_C[j] * 1000.);
			}
			if (S1_X_C2[j] > -500)
			{
				h_S1_A_C2->Fill(S1_A_C2[j] * 1000.);
			}
			if (S1_X_M[j] > -500)
			{
				h_S1_A_M->Fill(S1_A_M[j] * 1000.);
			}
			if (S1_X_M2[j] > -500)
			{
				h_S1_A_M2->Fill(S1_A_M2[j] * 1000.);
			}

			if (S1_Y[j] > -500)
			{
				h_S1_B->Fill(S1_B[j] * 1000.);
			}
			if (S1_Y_C[j] > -500)
			{
				h_S1_B_C->Fill(S1_B_C[j] * 1000.);
			}
			if (S1_Y_C2[j] > -500)
			{
				h_S1_B_C2->Fill(S1_B_C2[j] * 1000.);
			}
			if (S1_Y_M[j] > -500)
			{
				h_S1_B_M->Fill(S1_B_M[j] * 1000.);
			}
			if (S1_Y_M2[j] > -500)
			{
				h_S1_B_M2->Fill(S1_B_M2[j] * 1000.);
			}
		}

		tree_new->Fill();

		// if (TTT_hit_front_energies[0] > 1.)
		//	{
		//	  tree_new->Fill();
		// }

		// for (int j = 0; j < SRPPAC_max_ion; j++)
		// {
		// 	if (F3_T[j] > -3700 && F3_T[j] < -3000 && (F3_T[j] + PID_T[j] + Beam_T[j]) > -2300 && (F3_T[j] + PID_T[j] + Beam_T[j]) < -1800 && (F3_T[j] + PID_T[j]) > -2550 && (F3_T[j] + PID_T[j]) < -2050 && TTT_hit_front_energies[0] > 1.)
		// 	{
		// 		TTT_Counter = 1;
		// 	}
		// }

		// for (int j = 0; j < SRPPAC_max_ion; j++)
		// {
		// 	if (F3_T[j] > -2560 && F3_T[j] < -2420 && (F3_T[j] + PID_T[j] + Beam_T[j]) > -1160 && (F3_T[j] + PID_T[j] + Beam_T[j]) < -1090 && (F3_T[j] + PID_T[j]) > -1460 && (F3_T[j] + PID_T[j]) < -1320 && YY1_hit_energies[0] > 0.65)
		// 	{
		// 		YY1_Counter = 1;
		// 	}
		// }

		// if (TTT_Counter == 1 || YY1_Counter == 1)
		//{
		//	  tree_new->Fill();
		// }
	}

	// cout << endl;
	// cout << "Events with F3 diamond info = " << F3_E_Counter << " (" << F3_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the F3 diamond is fired = " << F3_Counter << " ,Times per event = " << F3_Counter*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE91 anode info = " << FE91_A_E_Counter << " (" << FE91_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE91 anode is fired = " << FE91_A_Counter << " ,Times per event = " << FE91_A_Counter*1./b  << endl;
	// cout << "Events with SRPPAC FE92 anode info = " << FE92_A_E_Counter << " (" << FE92_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE92 anode is fired = " << FE92_A_Counter << " ,Times per event = " << FE92_A_Counter*1./b  << endl;
	// cout << "Ions identified at FE9 through anode information = " << FE9_A_Counter << " ,Times per event = " << FE9_A_Counter*1./b  << endl;
	// cout << "Ions identified at F3-FE9 through anode information = " << F3_FE9_A_Counter << " ,Times per event = " << F3_FE9_A_Counter*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE91 X catode info = " << FE91_X_E_Counter << " (" << FE91_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE91 X catode is fired = " << FE91_X_Counter << " ,Times per event = " << FE91_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE91 X catode info = " << FE91_XA_E_Counter << " ,Times per event = " << (FE91_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE91 X catode is fired = " << FE91_XA_Counter + FE91_XA_E_Counter << " ,Times per event = " << (FE91_XA_Counter + FE91_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC FE91 Y catode info = " << FE91_Y_E_Counter << " (" << FE91_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE91 Y catode is fired = " << FE91_Y_Counter << " ,Times per event = " << FE91_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE91 Y catode info = " << FE91_YA_E_Counter << " ,Times per event = " << (FE91_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE91 Y catode is fired = " << FE91_YA_Counter + FE91_YA_E_Counter << " ,Times per event = " << (FE91_YA_Counter + FE91_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE92 X catode info = " << FE92_X_E_Counter << " (" << FE92_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE92 X catode is fired = " << FE92_X_Counter << " ,Times per event = " << FE92_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE92 X catode info = " << FE92_XA_E_Counter << " ,Times per event = " << (FE92_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE92 X catode is fired = " << FE92_XA_Counter + FE92_XA_E_Counter << " ,Times per event = " << (FE92_XA_Counter + FE92_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC FE92 Y catode info = " << FE92_Y_E_Counter << " (" << FE92_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE92 Y catode is fired = " << FE92_Y_Counter << " ,Times per event = " << FE92_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE92 Y catode info = " << FE92_YA_E_Counter << " ,Times per event = " << (FE92_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE92 Y catode is fired = " << FE92_YA_Counter + FE92_YA_E_Counter << " ,Times per event = " << (FE92_YA_Counter + FE92_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Strips identified with SRPPAC FE91 X catode which match strips in FE91 Y catode  = " << FE91_XY_Counter << " ,Times per event = " << (FE91_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE91 Y catode which match strips in FE91 X catode  = " << FE91_YX_Counter << " ,Times per event = " << (FE91_YX_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE92 X catode which match strips in FE92 Y catode  = " << FE92_XY_Counter << " ,Times per event = " << (FE92_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE92 Y catode which match strips in FE92 X catode  = " << FE92_YX_Counter << " ,Times per event = " << (FE92_YX_Counter)*1./b << endl;

	// cout << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE91 X catode = " << FE91_X_Q_Counter << " ,Times per event = " << (FE91_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE91 Y catode = " << FE91_Y_Q_Counter << " ,Times per event = " << (FE91_Y_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE92 X catode = " << FE92_X_Q_Counter << " ,Times per event = " << (FE92_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE92 Y catode = " << FE92_Y_Q_Counter << " ,Times per event = " << (FE92_Y_Q_Counter)*1./b << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE121 anode info = " << FE121_A_E_Counter << " (" << FE121_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE121 anode is fired = " << FE121_A_Counter << " ,Times per event = " << FE121_A_Counter*1./b  << endl;
	// cout << "Events with SRPPAC FE122 anode info = " << FE122_A_E_Counter << " (" << FE122_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE122 anode is fired = " << FE122_A_Counter << " ,Times per event = " << FE122_A_Counter*1./b  << endl;
	// cout << "Ions identified at FE12 through anode information = " << FE12_A_Counter << " ,Times per event = " << FE12_A_Counter*1./b  << endl;
	// cout << "Ions identified at F3-FE12 through anode information = " << F3_FE12_A_Counter << " ,Times per event = " << F3_FE12_A_Counter*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE121 X catode info = " << FE121_X_E_Counter << " (" << FE121_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE121 X catode is fired = " << FE121_X_Counter << " ,Times per event = " << FE121_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE121 X catode info = " << FE121_XA_E_Counter << " ,Times per event = " << (FE121_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE121 X catode is fired = " << FE121_XA_Counter + FE121_XA_E_Counter << " ,Times per event = " << (FE121_XA_Counter + FE121_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC FE121 Y catode info = " << FE121_Y_E_Counter << " (" << FE121_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE121 Y catode is fired = " << FE121_Y_Counter << " ,Times per event = " << FE121_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE121 Y catode info = " << FE121_YA_E_Counter << " ,Times per event = " << (FE121_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE121 Y catode is fired = " << FE121_YA_Counter + FE121_YA_E_Counter << " ,Times per event = " << (FE121_YA_Counter + FE121_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC FE122 X catode info = " << FE122_X_E_Counter << " (" << FE122_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE122 X catode is fired = " << FE122_X_Counter << " ,Times per event = " << FE122_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE122 X catode info = " << FE122_XA_E_Counter << " ,Times per event = " << (FE122_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE122 X catode is fired = " << FE122_XA_Counter + FE122_XA_E_Counter << " ,Times per event = " << (FE122_XA_Counter + FE122_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC FE122 Y catode info = " << FE122_Y_E_Counter << " (" << FE122_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC FE122 Y catode is fired = " << FE122_Y_Counter << " ,Times per event = " << FE122_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC FE122 Y catode info = " << FE122_YA_E_Counter << " ,Times per event = " << (FE122_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC FE122 Y catode is fired = " << FE122_YA_Counter + FE122_YA_E_Counter << " ,Times per event = " << (FE122_YA_Counter + FE122_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Strips identified with SRPPAC FE121 X catode which match strips in FE121 Y catode  = " << FE121_XY_Counter << " ,Times per event = " << (FE121_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE121 Y catode which match strips in FE121 X catode  = " << FE121_YX_Counter << " ,Times per event = " << (FE121_YX_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE122 X catode which match strips in FE122 Y catode  = " << FE122_XY_Counter << " ,Times per event = " << (FE122_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC FE122 Y catode which match strips in FE122 X catode  = " << FE122_YX_Counter << " ,Times per event = " << (FE122_YX_Counter)*1./b << endl;

	// cout << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE121 X catode = " << FE121_X_Q_Counter << " ,Times per event = " << (FE121_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE121 Y catode = " << FE121_Y_Q_Counter << " ,Times per event = " << (FE121_Y_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE122 X catode = " << FE122_X_Q_Counter << " ,Times per event = " << (FE122_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC FE122 Y catode = " << FE122_Y_Q_Counter << " ,Times per event = " << (FE122_Y_Q_Counter)*1./b << endl;

	// cout << endl;
	// cout << "Events with SRPPAC S11 anode info = " << S11_A_E_Counter << " (" << S11_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S11 anode is fired = " << S11_A_Counter << " ,Times per event = " << S11_A_Counter*1./b  << endl;
	// cout << "Events with SRPPAC S12 anode info = " << S12_A_E_Counter << " (" << S12_A_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S12 anode is fired = " << S12_A_Counter << " ,Times per event = " << S12_A_Counter*1./b  << endl;
	// cout << "Ions identified at S1 through anode information = " << S1_A_Counter << " ,Times per event = " << S1_A_Counter*1./b  << endl;
	// cout << "Ions identified at F3-S1 through anode information = " << F3_S1_A_Counter << " ,Times per event = " << F3_S1_A_Counter*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC S11 X catode info = " << S11_X_E_Counter << " (" << S11_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S11 X catode is fired = " << S11_X_Counter << " ,Times per event = " << S11_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC S11 X catode info = " << S11_XA_E_Counter << " ,Times per event = " << (S11_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC S11 X catode is fired = " << S11_XA_Counter + S11_XA_E_Counter << " ,Times per event = " << (S11_XA_Counter + S11_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC S11 Y catode info = " << S11_Y_E_Counter << " (" << S11_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S11 Y catode is fired = " << S11_Y_Counter << " ,Times per event = " << S11_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC S11 Y catode info = " << S11_YA_E_Counter << " ,Times per event = " << (S11_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC S11 Y catode is fired = " << S11_YA_Counter + S11_YA_E_Counter << " ,Times per event = " << (S11_YA_Counter + S11_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Events with SRPPAC S12 X catode info = " << S12_X_E_Counter << " (" << S12_X_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S12 X catode is fired = " << S12_X_Counter << " ,Times per event = " << S12_X_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC S12 X catode info = " << S12_XA_E_Counter << " ,Times per event = " << (S12_XA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC S12 X catode is fired = " << S12_XA_Counter + S12_XA_E_Counter << " ,Times per event = " << (S12_XA_Counter + S12_XA_E_Counter)*1./b  << endl;
	// cout << "Events with SRPPAC S12 Y catode info = " << S12_Y_E_Counter << " (" << S12_Y_E_Counter*1./b*100. << " %)" << endl;
	// cout << "Times the SRPPAC S12 Y catode is fired = " << S12_Y_Counter << " ,Times per event = " << S12_Y_Counter*1./b  << endl;
	// cout << "Individual ions identified with SRPPAC S12 Y catode info = " << S12_YA_E_Counter << " ,Times per event = " << (S12_YA_E_Counter)*1./b << endl;
	// cout << "Times for anode-identified ions the SRPPAC S12 Y catode is fired = " << S12_YA_Counter + S12_YA_E_Counter << " ,Times per event = " << (S12_YA_Counter + S12_YA_E_Counter)*1./b  << endl;

	// cout << endl;
	// cout << "Strips identified with SRPPAC S11 X catode which match strips in S11 Y catode  = " << S11_XY_Counter << " ,Times per event = " << (S11_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC S11 Y catode which match strips in S11 X catode  = " << S11_YX_Counter << " ,Times per event = " << (S11_YX_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC S12 X catode which match strips in S12 Y catode  = " << S12_XY_Counter << " ,Times per event = " << (S12_XY_Counter)*1./b << endl;
	// cout << "Strips identified with SRPPAC S12 Y catode which match strips in S12 X catode  = " << S12_YX_Counter << " ,Times per event = " << (S12_YX_Counter)*1./b << endl;

	// cout << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC S11 X catode   = " << S11_X_Q_Counter << " ,Times per event = " << (S11_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC S11 Y catode   = " << S11_Y_Q_Counter << " ,Times per event = " << (S11_Y_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC S12 X catode   = " << S12_X_Q_Counter << " ,Times per event = " << (S12_X_Q_Counter)*1./b << endl;
	// cout << "Ions where Q0 and Q1 are neightbours for SRPPAC S12 Y catode   = " << S12_Y_Q_Counter << " ,Times per event = " << (S12_Y_Q_Counter)*1./b << endl;

	// cout << endl;
	// cout << "FE9-FE12 transmission (anode info) = " << F3_FE12_A_Counter*1./F3_FE9_A_Counter*100. << "%" << endl;
	// cout << "FE9-S1 transmission (anode info) = " << F3_S1_A_Counter*1./F3_FE9_A_Counter*100. << "%" << endl;
	// cout << "FE12-S1 transmission (anode info) = " << F3_S1_A_Counter*1./F3_FE12_A_Counter*100. << "%" << endl;

	// cout << "Excitation Energy = " << f_Excitation_Energy(6,129.46125*PI/180,16,0) << endl;
	// cout << "Excitation Energy = " << f_Excitation_Energy(3.5017982137749,119.84339756068*PI/180,14,0) << endl;
	// cout << "Excitation Energy = " << f_Excitation_Energy(2.2688689527617,137.12902711708 *PI/180,14,0) << endl;
	// cout << "Excitation Energy = " << f_Excitation_Energy(1.6804706980418,163.24086256524*PI/180,14,0) << endl;

	// FE121_X = 0;
	// FE121_Y = 0;

	// cout << f_Theta(-55.71, -31.75, -229.22, 1.03 - FE121_X, 0.18 - FE121_Y, FE12_S0) << endl;

	// cout << "i = " << i << endl;
	// cout << "b = " << b*0.99 << endl;

	// We create a new output root file for our analisis with output histograms.
	// TFile* ofile = new TFile("/home/sh12s24/art_analysis/user/carlos/output/Analysis/pencil.root","recreate");
	// TFile *ofile = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/physOutput/24sharaq12physhistos_1053.root", "recreate"); // for lxpool artemis installation    // for 2024 run
	TFile *ofile = new TFile("/u/ddas/software/work/artemis-oedo/output/Analysis/physOutput/24sharaq12physhistos_1056.root", "recreate");
	// string output = "/home/jupiter/test/work/artemis-oedo/output/Analysis/sharaq12histos_" + to_string(frun) + "new.root";
	// TFile *ofile = new TFile(output.c_str(), "recreate");
	hlist->Write();
	ofile->Close();
	ofile_new->cd();
	tree_new->Write("", TObject::kOverwrite);
	ofile_new->Close();

	cout << endl;
	cout << "END" << endl;
	cout << endl;
}

// Definition of the functions used in the analysis.

double f_Excitation_Energy(double Proton_Energy, double Scattering_Angle, double Beam_Energy, double Incident_Angle)
{

	// Masses of the nuclei.
	double M_50Ca = 46535.0915;
	double M_51Ca = 47469.8421;
	double M_2H = 1875.61689;
	double M_1H = 938.273993;

	double Qvalue = M_50Ca + M_2H - M_51Ca - M_1H; // Qvalue of the 50Ca(d,p)51Ca neutron transfer reaction.

	// Total energies of the nuclei.
	double E_50Ca = 0;
	double E_51Ca = 0;
	double E_1H = 0;
	double E_2H = 0;

	// Kinetic energies of the nuclei.
	double T_50Ca = 0;
	double T_51Ca = 0;
	double T_2H = 0;
	double T_1H = 0;

	// Momenta of the nuclei.
	double P_50Ca = 0;
	double Px_50Ca = 0;
	double Py_50Ca = 0;

	double P_51Ca = 0;
	double Px_51Ca = 0;
	double Py_51Ca = 0;

	double P_1H = 0;
	double Px_1H = 0;
	double Py_1H = 0;

	double P_2H = 0;
	double Px_2H = 0;
	double Py_2H = 0;

	double Invariant = 0;
	double Excitation = 0;

	double PI = 3.14159265358979323846;

	T_50Ca = Beam_Energy * 50;
	E_50Ca = T_50Ca + M_50Ca;
	P_50Ca = sqrt(pow(E_50Ca, 2) - pow(M_50Ca, 2));
	// Px_50Ca = P_50Ca*cos(Incident_Angle);
	// Py_50Ca = P_50Ca*sin(Incident_Angle);

	Px_50Ca = P_50Ca;

	// Proton.
	T_1H = Proton_Energy;
	E_1H = T_1H + M_1H;
	P_1H = sqrt(pow(E_1H, 2) - pow(M_1H, 2));
	Px_1H = P_1H * cos(Scattering_Angle);
	Py_1H = P_1H * sin(Scattering_Angle);

	// Excitation energy.
	E_51Ca = E_50Ca + M_2H - E_1H;
	T_51Ca = E_51Ca - M_51Ca;
	Px_51Ca = Px_50Ca - Px_1H;
	Py_51Ca = Py_50Ca - Py_1H;

	Invariant = sqrt(pow(E_51Ca, 2) - pow(Px_51Ca, 2) - pow(Py_51Ca, 2));

	Excitation = Invariant - M_51Ca;
	// cout << T_51Ca << endl;
	return Excitation;
}

vector<double> f_Coordinates(int ID_Front, int ID_Back)
{

	double TTT_X;
	double TTT_Y;
	double TTT_Z;

	// Some constants of TINA extracted from NPTool simulations.
	double TTT_length = 100.42;								   // Length of a TTT side.
	double TTT_active_length = 97.22;						   // Length of the active region of a TTT side.
	double TTT_strip_width = TTT_active_length / 128.;		   // Width of each strip.
	double TTT_target_to_strip = -14.14 - TTT_strip_width / 2; // Distance from target to center of first back strip.

	// Output.
	vector<double> Position;

	// From the front strip we get the X and Y coordinates of the proton.
	if (ID_Front < 128)
	{ // If the pixel is in the first TTT.
		TTT_X = -55;
		TTT_Y = -(TTT_active_length - TTT_strip_width) / 2 + (TTT_strip_width * ID_Front);
	}
	if (ID_Front > 127 && ID_Front < 256)
	{ // If the pixel is in the second TTT.
		TTT_Y = -55;
		TTT_X = (TTT_active_length - TTT_strip_width) / 2 - (TTT_strip_width * (ID_Front - 128));
	}
	if (ID_Front > 255 && ID_Front < 384)
	{ // If the pixel is in the third TTT.
		TTT_Y = 55;
		TTT_X = -(TTT_active_length - TTT_strip_width) / 2 + (TTT_strip_width * (ID_Front - 256));
	}
	if (ID_Front > 383)
	{ // If the pixel is in the fourth TTT.
		TTT_X = 55;
		TTT_Y = (TTT_active_length - TTT_strip_width) / 2 - (TTT_strip_width * (ID_Front - 384));
	}
	// From the back strip we get the Z coordinate.
	if (ID_Back < 128)
	{ // If the pixel is in the first TTT.
		TTT_Z = TTT_target_to_strip - (TTT_strip_width * ID_Back);
	}
	if (ID_Back > 127 && ID_Back < 256)
	{ // If the pixel is in the second TTT.
		TTT_Z = TTT_target_to_strip - (TTT_strip_width * (ID_Back - 128));
	}
	if (ID_Back > 255 && ID_Back < 384)
	{ // If the pixel is in the third TTT.
		TTT_Z = TTT_target_to_strip - (TTT_strip_width * (ID_Back - 256));
	}
	if (ID_Back > 383)
	{ // If the pixel is in the fourth TTT.
		TTT_Z = TTT_target_to_strip - (TTT_strip_width * (ID_Back - 384));
	}

	Position.push_back(TTT_X);
	Position.push_back(TTT_Y);
	Position.push_back(TTT_Z);

	return Position;
}

double f_Theta(double X, double Y, double Z, double X_0, double Y_0, double Z_0)
{
	double Theta;
	double PI = 3.14159265358979323846;

	Theta = (180 / PI) * acos((X_0 * X + Y_0 * Y + Z_0 * Z) / ((sqrt(pow(X_0, 2) + pow(Y_0, 2) + pow(Z_0, 2)) * sqrt(pow(X, 2) + pow(Y, 2) + pow(Z, 2)))));

	return Theta;
}

double f_Phi(double X, double Y)
{
	double Phi;
	double PI = 3.14159265358979323846;

	if (X < 0)
	{
		Phi = (PI + atan(Y / X)) * 180 / PI;
	}
	if (X > 0)
	{
		if (Y > 0)
		{
			Phi = (atan(Y / X)) * 180 / PI;
		}
		if (Y < 0)
		{
			Phi = (2 * PI + atan(Y / X)) * 180 / PI;
		}
	}
	if (X == 0)
	{
		if (Y > 0)
		{
			Phi = 90.;
		}
		if (Y < 0)
		{
			Phi = -270.;
		}
	}
	return Phi;
}

int f_CsI_ID(int ID_Front, int ID_Back)
{
	int CsI_ID = -1;
	if (ID_Back > -1 && ID_Back < 64)
	{
		if (ID_Front > -1 && ID_Front < 64)
		{
			CsI_ID = 15 - 1;
		}
		if (ID_Front > 63 && ID_Front < 128)
		{
			CsI_ID = 13 - 1;
		}
	}
	if (ID_Back > 63 && ID_Back < 128)
	{
		if (ID_Front > -1 && ID_Front < 64)
		{
			CsI_ID = 14 - 1;
		}
		if (ID_Front > 63 && ID_Front < 128)
		{
			CsI_ID = 16 - 1;
		}
	}
	if (ID_Back > 127 && ID_Back < 192)
	{
		if (ID_Front > 127 && ID_Front < 192)
		{
			CsI_ID = 8 - 1;
		}
		if (ID_Front > 191 && ID_Front < 256)
		{
			CsI_ID = 7 - 1;
		}
	}
	if (ID_Back > 191 && ID_Back < 256)
	{
		if (ID_Front > 127 && ID_Front < 192)
		{
			CsI_ID = 6 - 1;
		}
		if (ID_Front > 191 && ID_Front < 256)
		{
			CsI_ID = 5 - 1;
		}
	}
	if (ID_Back > 255 && ID_Back < 320)
	{
		if (ID_Front > 255 && ID_Front < 320)
		{
			CsI_ID = 12 - 1;
		}
		if (ID_Front > 319 && ID_Front < 384)
		{
			CsI_ID = 10 - 1;
		}
	}
	if (ID_Back > 319 && ID_Back < 384)
	{
		if (ID_Front > 255 && ID_Front < 320)
		{
			CsI_ID = 11 - 1;
		}
		if (ID_Front > 319 && ID_Front < 384)
		{
			CsI_ID = 9 - 1;
		}
	}
	if (ID_Back > 383 && ID_Back < 448)
	{
		if (ID_Front > 383 && ID_Front < 448)
		{
			CsI_ID = 1 - 1;
		}
		if (ID_Front > 447 && ID_Front < 512)
		{
			CsI_ID = 4 - 1;
		}
	}
	if (ID_Back > 447 && ID_Back < 512)
	{
		if (ID_Front > 383 && ID_Front < 448)
		{
			CsI_ID = 2 - 1;
		}
		if (ID_Front > 447 && ID_Front < 512)
		{
			CsI_ID = 3 - 1;
		}
	}
	return CsI_ID;
}

double f_SRPPAC_gain(int a, int b, int c)
{
	FILE *myfile;
	double myvariable;
	string SRPPAC;
	string sector;
	double output;
	int j;
	int k;

	if (b == 0)
	{
		SRPPAC = "FE91";
	}
	if (b == 1)
	{
		SRPPAC = "FE92";
	}
	if (b == 2)
	{
		SRPPAC = "FE121";
	}
	if (b == 3)
	{
		SRPPAC = "FE122";
	}
	if (b == 4)
	{
		SRPPAC = "S11";
	}
	if (b == 5)
	{
		SRPPAC = "S12";
	}
	if (a == 0)
	{
		// string input = "/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_param/" + SRPPAC + "_v.txt";
		string input = "/u/ddas/software/work/artemis-oedo/macro/Analysis/SRPPAC_param_2024/" + SRPPAC + "_v.txt"; // for lxpool artemis installation
		myfile = fopen(input.c_str(), "r");
		for (j = 0; j < HEIGHT_V; j++)
		{
			for (k = 0; k < WIDTH; k++)
			{
				fscanf(myfile, "%lf", &myvariable);
				if (k == 2 && j == c)
				{
					output = myvariable;
				}
			}
		}
	}
	if (a == 1)
	{
		// string input = "/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_param/" + SRPPAC + "_h.txt";
		string input = "/u/ddas/software/work/artemis-oedo/macro/Analysis/SRPPAC_param_2024/" + SRPPAC + "_h.txt"; // for lxpool artemis installation
		myfile = fopen(input.c_str(), "r");
		for (j = 0; j < HEIGHT_H; j++)
		{
			for (k = 0; k < WIDTH; k++)
			{
				fscanf(myfile, "%lf", &myvariable);
				if (k == 2 && j == c)
				{
					output = myvariable;
				}
			}
		}
	}
	fclose(myfile);
	return output;
}

double f_SRPPAC_gain2(int o, int a, int b, int c)
{

	// cout << "o = " << o << ", a = " << a << ", b = "<< b << ", c = "<< c << endl;

	FILE *myfile;
	double myvariable;
	string SRPPAC;
	double output;
	int j;
	int k;

	if (b == 0)
	{
		SRPPAC = "FE91";
	}
	if (b == 1)
	{
		SRPPAC = "FE92";
	}
	if (b == 2)
	{
		SRPPAC = "FE121";
	}
	if (b == 3)
	{
		SRPPAC = "FE122";
	}
	if (b == 4)
	{
		SRPPAC = "S11";
	}
	if (b == 5)
	{
		SRPPAC = "S12";
	}

	// cout << SRPPAC << endl;
	if (o == 1 && a == 15)
		return 0;

	if (o == 1)
	{
		// string input = "/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_param2/" + SRPPAC + "_h_" + Form("%d", a) + ".txt";
		string input = "/u/ddas/software/work/artemis-oedo/macro/Analysis/SRPPAC_param2_2024/" + SRPPAC + "_h_" + Form("%d", a) + ".txt"; // for lxpool artemis installation
		myfile = fopen(input.c_str(), "r");
		for (j = 0; j < HEIGHT_H; j++)
		{
			for (k = 0; k < WIDTH; k++)
			{
				fscanf(myfile, "%lf", &myvariable);
				if (k == 2 && j == c)
				{
					output = myvariable;
				}
			}
		}
	}

	if (o == 0)
	{
		// string input = "/home/jupiter/test/work/artemis-oedo/macro/Analysis/SRPPAC_param2/" + SRPPAC + "_v_" + Form("%d", a) + ".txt";
		string input = "/u/ddas/software/work/artemis-oedo/macro/Analysis/SRPPAC_param2_2024/" + SRPPAC + "_v_" + Form("%d", a) + ".txt"; // for lxpool artemis installation
		// cout << input << endl;
		myfile = fopen(input.c_str(), "r");
		for (j = 0; j < HEIGHT_V; j++)
		{
			for (k = 0; k < WIDTH; k++)
			{
				fscanf(myfile, "%lf", &myvariable);
				if (k == 2 && j == c)
				{
					output = myvariable;
				}
			}
		}
	}

	fclose(myfile);
	return output;
}

// void f_sort (double array[3][SRPPAC_max_mult][SRPPAC_max_ion])
void f_sort(double array[3][7][7])
{
	// int n = SRPPAC_max_mult; //mult
	int n = 7;
	int i, j, k;
	// for (k = 0; k < SRPPAC_max_ion; k++){
	for (k = 0; k < 7; k++)
	{
		for (i = 0; i < n - 1; i++)
		{
			for (j = i + 1; j < n; j++)
			{
				if (array[2][j][k] > array[2][i][k])
				{
					double temp0 = array[0][i][k];
					array[0][i][k] = array[0][j][k];
					array[0][j][k] = temp0;
					double temp1 = array[1][i][k];
					array[1][i][k] = array[1][j][k];
					array[1][j][k] = temp1;
					double temp2 = array[2][i][k];
					array[2][i][k] = array[2][j][k];
					array[2][j][k] = temp2;
				}
			}
		}
	}
}
